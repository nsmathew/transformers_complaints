2023-08-18 00:54:30,217 - INFO - Training Params - NO_OF_EPOCHS: 4 OUTER_CV_NO: 6 INNER_CV_NO: 4 MAX_LENGTH: 50 LR_SPACE: [1e-05, 5e-06, 5e-05, 3e-05] SEED: 2023

2023-08-18 00:54:30,217 - INFO - Total no. of tweets: 3449
2023-08-18 00:54:30,218 - INFO - ----------------------------------------------------------------------
2023-08-18 00:54:30,218 - INFO - ----------------------------------------------------------------------
2023-08-18 00:54:30,218 - INFO - **TRACE** Outer Fold:0
2023-08-18 00:54:30,219 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-18 00:54:35,897 - INFO - -----------------------------------
2023-08-18 00:54:35,897 - INFO - -----------------------------------
2023-08-18 00:54:35,897 - INFO - **TRACE** Inner Fold: 0 for outer fold: 0
2023-08-18 00:54:35,897 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-18 00:54:35,897 - INFO - **TRACE** Create dataset...
2023-08-18 00:54:35,898 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:54:35,901 - INFO - **TRACE** Tokenise data...
2023-08-18 00:54:36,778 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:54:36,778 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 1e-05
2023-08-18 00:54:36,778 - INFO - Setting up training args and starting training...
2023-08-18 00:54:50,413 - INFO - Training complete...
2023-08-18 00:54:50,413 - INFO - TrainOutput(global_step=1080, training_loss=0.6336171291492604, metrics={'train_runtime': 13.491, 'train_samples_per_second': 638.946, 'train_steps_per_second': 80.054, 'total_flos': 1069492020000.0, 'train_loss': 0.6336171291492604, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:54:50,413 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:54:50,442 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:54:50,442 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	0	1e-05	0.6490792632102966	0.6119610570236439	1.0	0.017605633802816902	0.03460207612456747	0.5088028169014085	0.10356699008124784	0.3519	2043.38	255.778	7.500000000000001e-06	1.0	270
prajjwal1/bert-tiny	0	0	1e-05	0.6227596998214722	0.6564673157162726	0.7605633802816901	0.19014084507042253	0.3042253521126761	0.5755301926501537	0.2475356241113373	0.3516	2044.817	255.958	5e-06	2.0	540
prajjwal1/bert-tiny	0	0	1e-05	0.6080458164215088	0.6842837273991655	0.728	0.3204225352112676	0.4449877750611247	0.6211308078355188	0.31249291753145336	0.3492	2058.908	257.721	2.5e-06	3.0	810
prajjwal1/bert-tiny	0	0	1e-05	0.6039578914642334	0.6828929068150209	0.71875	0.323943661971831	0.44660194174757284	0.6205925206410879	0.3082161858884087	0.3562	2018.364	252.646	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	0	1e-05	13.491	638.946	80.054	1069492020000.0	0.6336171291492604	0.0	4.0	1080

2023-08-18 00:54:50,442 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:54:50,442 - INFO - **TRACE** Appending...0.6490792632102966
2023-08-18 00:54:50,442 - INFO - **TRACE** Appending...0.6227596998214722
2023-08-18 00:54:50,442 - INFO - **TRACE** Appending...0.6080458164215088
2023-08-18 00:54:50,442 - INFO - **TRACE** Appending...0.6039578914642334
2023-08-18 00:54:50,443 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.6039578914642334 < 1000 LR: 1e-05
2023-08-18 00:54:50,472 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-18 00:54:50,472 - INFO - -----------------------------------
2023-08-18 00:54:50,472 - INFO - -----------------------------------
2023-08-18 00:54:50,472 - INFO - **TRACE** Inner Fold: 1 for outer fold: 0
2023-08-18 00:54:50,472 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-18 00:54:50,472 - INFO - **TRACE** Create dataset...
2023-08-18 00:54:50,473 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:54:50,477 - INFO - **TRACE** Tokenise data...
2023-08-18 00:54:51,150 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:54:51,150 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-06
2023-08-18 00:54:51,150 - INFO - Setting up training args and starting training...
2023-08-18 00:55:04,827 - INFO - Training complete...
2023-08-18 00:55:04,827 - INFO - TrainOutput(global_step=1080, training_loss=0.6755747759783709, metrics={'train_runtime': 13.5346, 'train_samples_per_second': 636.888, 'train_steps_per_second': 79.796, 'total_flos': 1069492020000.0, 'train_loss': 0.6755747759783709, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:55:04,827 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:55:04,860 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:55:04,860 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	1	5e-06	0.6737193465232849	0.6286509040333796	0.38636363636363635	0.06614785992217899	0.11295681063122924	0.5038531507403102	0.015408321087853491	0.343	2096.258	262.397	3.7500000000000005e-06	1.0	270
prajjwal1/bert-tiny	0	1	5e-06	0.6541640162467957	0.6383866481223922	0.2857142857142857	0.007782101167315175	0.015151515151515154	0.49847979517240215	-0.014839888423707762	0.3404	2112.372	264.414	2.5e-06	2.0	540
prajjwal1/bert-tiny	0	1	5e-06	0.6450374722480774	0.6425591098748261	0.5	0.0038910505836575876	0.007722007722007722	0.5008632742095778	0.015710562542514975	0.3651	1969.096	246.479	1.25e-06	3.0	810
prajjwal1/bert-tiny	0	1	5e-06	0.6420723795890808	0.6467315716272601	0.8	0.01556420233463035	0.03053435114503817	0.5066998500850641	0.07727669187168507	0.334	2152.855	269.481	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	1	5e-06	13.5346	636.888	79.796	1069492020000.0	0.6755747759783709	0.0	4.0	1080

2023-08-18 00:55:04,860 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:55:04,860 - INFO - **TRACE** Appending...0.6737193465232849
2023-08-18 00:55:04,860 - INFO - **TRACE** Appending...0.6541640162467957
2023-08-18 00:55:04,860 - INFO - **TRACE** Appending...0.6450374722480774
2023-08-18 00:55:04,860 - INFO - **TRACE** Appending...0.6420723795890808
2023-08-18 00:55:04,860 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.6420723795890808 >= 0.6039578914642334 LR: 5e-06
2023-08-18 00:55:04,860 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-18 00:55:04,860 - INFO - -----------------------------------
2023-08-18 00:55:04,860 - INFO - -----------------------------------
2023-08-18 00:55:04,860 - INFO - **TRACE** Inner Fold: 2 for outer fold: 0
2023-08-18 00:55:04,860 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-18 00:55:04,860 - INFO - **TRACE** Create dataset...
2023-08-18 00:55:04,861 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:55:04,865 - INFO - **TRACE** Tokenise data...
2023-08-18 00:55:05,546 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:55:05,546 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-05
2023-08-18 00:55:05,546 - INFO - Setting up training args and starting training...
2023-08-18 00:55:19,159 - INFO - Training complete...
2023-08-18 00:55:19,159 - INFO - TrainOutput(global_step=1080, training_loss=0.5270174167774342, metrics={'train_runtime': 13.4763, 'train_samples_per_second': 639.937, 'train_steps_per_second': 80.141, 'total_flos': 1069988304000.0, 'train_loss': 0.5270174167774342, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:55:19,159 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:55:19,191 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:55:19,191 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	2	5e-05	0.5644707083702087	0.7381615598885793	0.6623931623931624	0.5871212121212122	0.6224899598393574	0.7065562007742625	0.4249790417599089	0.344	2087.269	261.635	3.7500000000000003e-05	1.0	270
prajjwal1/bert-tiny	0	2	5e-05	0.5154977440834045	0.7632311977715878	0.7640449438202247	0.5151515151515151	0.6153846153846153	0.711320250967828	0.47194796985145077	0.3525	2036.63	255.288	2.5e-05	2.0	540
prajjwal1/bert-tiny	0	2	5e-05	0.49030211567878723	0.7604456824512534	0.676923076923077	0.6666666666666666	0.6717557251908397	0.7408223201174743	0.4832114411639164	0.3327	2158.122	270.517	1.25e-05	3.0	810
prajjwal1/bert-tiny	0	2	5e-05	0.4802336096763611	0.7771587743732591	0.7222222222222222	0.6401515151515151	0.6787148594377509	0.7484898544920572	0.5112554348562172	0.3299	2176.145	272.776	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	2	5e-05	13.4763	639.937	80.141	1069988304000.0	0.5270174167774342	0.0	4.0	1080

2023-08-18 00:55:19,191 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:55:19,191 - INFO - **TRACE** Appending...0.5644707083702087
2023-08-18 00:55:19,191 - INFO - **TRACE** Appending...0.5154977440834045
2023-08-18 00:55:19,191 - INFO - **TRACE** Appending...0.49030211567878723
2023-08-18 00:55:19,191 - INFO - **TRACE** Appending...0.4802336096763611
2023-08-18 00:55:19,192 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.4802336096763611 < 0.6420723795890808 LR: 5e-05
2023-08-18 00:55:19,231 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-18 00:55:19,231 - INFO - -----------------------------------
2023-08-18 00:55:19,231 - INFO - -----------------------------------
2023-08-18 00:55:19,231 - INFO - **TRACE** Inner Fold: 3 for outer fold: 0
2023-08-18 00:55:19,231 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-18 00:55:19,231 - INFO - **TRACE** Create dataset...
2023-08-18 00:55:19,232 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:55:19,236 - INFO - **TRACE** Tokenise data...
2023-08-18 00:55:19,909 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:55:19,909 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 3e-05
2023-08-18 00:55:19,909 - INFO - Setting up training args and starting training...
2023-08-18 00:55:33,194 - INFO - Training complete...
2023-08-18 00:55:33,195 - INFO - TrainOutput(global_step=1080, training_loss=0.562406207897045, metrics={'train_runtime': 13.1505, 'train_samples_per_second': 655.794, 'train_steps_per_second': 82.126, 'total_flos': 1069988304000.0, 'train_loss': 0.562406207897045, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:55:33,195 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:55:33,232 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:55:33,232 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	3	3e-05	0.6140099167823792	0.6629526462395543	0.659217877094972	0.39464882943143814	0.49372384937238495	0.6245320519472226	0.28381336793228457	0.4398	1632.605	204.644	2.25e-05	1.0	270
prajjwal1/bert-tiny	0	3	3e-05	0.5771063566207886	0.7214484679665738	0.7619047619047619	0.4816053511705686	0.5901639344262295	0.6871033915757379	0.41888568894284206	0.3492	2056.399	257.766	1.5e-05	2.0	540
prajjwal1/bert-tiny	0	3	3e-05	0.5525237321853638	0.7409470752089137	0.7344398340248963	0.5919732441471572	0.6555555555555556	0.7196143070377791	0.4585276398039774	0.3317	2164.53	271.32	7.5e-06	3.0	810
prajjwal1/bert-tiny	0	3	3e-05	0.5473405718803406	0.7520891364902507	0.7510373443983402	0.6053511705685619	0.6703703703703704	0.7310765399382189	0.48245937116343773	0.3413	2103.517	263.672	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	0	3	3e-05	13.1505	655.794	82.126	1069988304000.0	0.562406207897045	0.0	4.0	1080

2023-08-18 00:55:33,232 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:55:33,232 - INFO - **TRACE** Appending...0.6140099167823792
2023-08-18 00:55:33,232 - INFO - **TRACE** Appending...0.5771063566207886
2023-08-18 00:55:33,232 - INFO - **TRACE** Appending...0.5525237321853638
2023-08-18 00:55:33,233 - INFO - **TRACE** Appending...0.5473405718803406
2023-08-18 00:55:33,233 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.5473405718803406 >= 0.4802336096763611 LR: 3e-05
2023-08-18 00:55:33,233 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-18 00:55:33,233 - INFO - -----------------------------------
2023-08-18 00:55:33,233 - INFO - -----------------------------------
2023-08-18 00:55:33,233 - INFO - **TRACE** All inner CVs complete for outer CV 0
2023-08-18 00:55:33,233 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.4802336096763611 with learning rate: 3e-05
2023-08-18 00:55:33,233 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-18 00:55:33,233 - INFO - **TRACE** Loading the best model from inner CV
2023-08-18 00:55:33,270 - INFO - **TRACE** Running predictions with test data
2023-08-18 00:55:33,743 - INFO - Metrics from the Predictions...
2023-08-18 00:55:33,743 - INFO - {'test_loss': 0.49180227518081665, 'test_accuracy': 0.7895652173913044, 'test_precision': 0.7359550561797753, 'test_recall': 0.6390243902439025, 'test_f1': 0.6840731070496083, 'test_roc_auc': 0.7559986816084378, 'test_matthews_correlation': 0.5304448806796693, 'test_runtime': 0.2953, 'test_samples_per_second': 1947.408, 'test_steps_per_second': 243.849}
2023-08-18 00:55:33,743 - INFO - {'confusion_matrix': array([[323,  47],
       [ 74, 131]])}
2023-08-18 00:55:33,743 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
prajjwal1/bert-tiny	0	0.49180227518081665	0.7895652173913044	0.7359550561797753	0.6390243902439025	0.6840731070496083	0.7559986816084378	0.5304448806796693	0.2953	1947.408	243.849
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
prajjwal1/bert-tiny	0	[[323  47]
 [ 74 131]]

2023-08-18 00:55:33,743 - INFO - ----------------------------------------------------------------------
2023-08-18 00:55:33,743 - INFO - ----------------------------------------------------------------------
2023-08-18 00:55:33,743 - INFO - **TRACE** Outer Fold:1
2023-08-18 00:55:33,744 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-18 00:55:34,385 - INFO - -----------------------------------
2023-08-18 00:55:34,385 - INFO - -----------------------------------
2023-08-18 00:55:34,385 - INFO - **TRACE** Inner Fold: 0 for outer fold: 1
2023-08-18 00:55:34,385 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-18 00:55:34,385 - INFO - **TRACE** Create dataset...
2023-08-18 00:55:34,386 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:55:34,390 - INFO - **TRACE** Tokenise data...
2023-08-18 00:55:35,021 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:55:35,021 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 1e-05
2023-08-18 00:55:35,021 - INFO - Setting up training args and starting training...
2023-08-18 00:55:48,235 - INFO - Training complete...
2023-08-18 00:55:48,236 - INFO - TrainOutput(global_step=1080, training_loss=0.6296223251907914, metrics={'train_runtime': 12.9771, 'train_samples_per_second': 664.248, 'train_steps_per_second': 83.224, 'total_flos': 1069492020000.0, 'train_loss': 0.6296223251907914, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:55:48,236 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:55:48,269 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:55:48,269 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	0	1e-05	0.6480627059936523	0.6161335187760779	1.0	0.014285714285714285	0.028169014084507043	0.5071428571428571	0.09365483848274349	0.3356	2142.42	268.175	7.500000000000001e-06	1.0	270
prajjwal1/bert-tiny	1	0	1e-05	0.6246546506881714	0.6662030598052852	0.7380952380952381	0.22142857142857142	0.34065934065934067	0.5856573381060853	0.2600634621460307	0.327	2198.975	275.254	5e-06	2.0	540
prajjwal1/bert-tiny	1	0	1e-05	0.6122996807098389	0.6801112656467315	0.6865671641791045	0.32857142857142857	0.4444444444444445	0.6164497233973315	0.29164155187563084	0.3639	1975.748	247.312	2.5e-06	3.0	810
prajjwal1/bert-tiny	1	0	1e-05	0.6087576746940613	0.6842837273991655	0.6934306569343066	0.3392857142857143	0.4556354916067147	0.6218068662544745	0.3024762399537856	0.3648	1970.837	246.697	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	0	1e-05	12.9771	664.248	83.224	1069492020000.0	0.6296223251907914	0.0	4.0	1080

2023-08-18 00:55:48,269 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:55:48,269 - INFO - **TRACE** Appending...0.6480627059936523
2023-08-18 00:55:48,269 - INFO - **TRACE** Appending...0.6246546506881714
2023-08-18 00:55:48,269 - INFO - **TRACE** Appending...0.6122996807098389
2023-08-18 00:55:48,269 - INFO - **TRACE** Appending...0.6087576746940613
2023-08-18 00:55:48,269 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.6087576746940613 < 1000 LR: 1e-05
2023-08-18 00:55:48,312 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-18 00:55:48,313 - INFO - -----------------------------------
2023-08-18 00:55:48,313 - INFO - -----------------------------------
2023-08-18 00:55:48,313 - INFO - **TRACE** Inner Fold: 1 for outer fold: 1
2023-08-18 00:55:48,313 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-18 00:55:48,313 - INFO - **TRACE** Create dataset...
2023-08-18 00:55:48,314 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:55:48,318 - INFO - **TRACE** Tokenise data...
2023-08-18 00:55:48,984 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:55:48,985 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-06
2023-08-18 00:55:48,985 - INFO - Setting up training args and starting training...
2023-08-18 00:56:07,209 - INFO - Training complete...
2023-08-18 00:56:07,209 - INFO - TrainOutput(global_step=1080, training_loss=0.6685637580023871, metrics={'train_runtime': 13.0471, 'train_samples_per_second': 660.684, 'train_steps_per_second': 82.777, 'total_flos': 1069492020000.0, 'train_loss': 0.6685637580023871, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:56:07,209 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:56:07,242 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:56:07,243 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	1	5e-06	0.6785644888877869	0.588317107093185	0.375	0.01020408163265306	0.01986754966887417	0.49921968787515003	-0.007314534409220953	0.3382	2125.863	266.102	3.7500000000000005e-06	1.0	270
prajjwal1/bert-tiny	1	1	5e-06	0.6664376854896545	0.5910987482614742	0.0	0.0	0.0	0.5	0.0	0.333	2159.068	270.259	2.5e-06	2.0	540
prajjwal1/bert-tiny	1	1	5e-06	0.6603625416755676	0.5910987482614742	0.0	0.0	0.0	0.5	0.0	0.3514	2046.174	256.127	1.25e-06	3.0	810
prajjwal1/bert-tiny	1	1	5e-06	0.6581004858016968	0.5910987482614742	0.0	0.0	0.0	0.5	0.0	0.3416	2104.838	263.471	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	1	5e-06	13.0471	660.684	82.777	1069492020000.0	0.6685637580023871	0.0	4.0	1080

2023-08-18 00:56:07,243 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:56:07,243 - INFO - **TRACE** Appending...0.6785644888877869
2023-08-18 00:56:07,243 - INFO - **TRACE** Appending...0.6664376854896545
2023-08-18 00:56:07,243 - INFO - **TRACE** Appending...0.6603625416755676
2023-08-18 00:56:07,243 - INFO - **TRACE** Appending...0.6581004858016968
2023-08-18 00:56:07,243 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.6581004858016968 >= 0.6087576746940613 LR: 5e-06
2023-08-18 00:56:07,243 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-18 00:56:07,243 - INFO - -----------------------------------
2023-08-18 00:56:07,243 - INFO - -----------------------------------
2023-08-18 00:56:07,243 - INFO - **TRACE** Inner Fold: 2 for outer fold: 1
2023-08-18 00:56:07,243 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-18 00:56:07,243 - INFO - **TRACE** Create dataset...
2023-08-18 00:56:07,244 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:56:07,248 - INFO - **TRACE** Tokenise data...
2023-08-18 00:56:07,962 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:56:07,962 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-05
2023-08-18 00:56:07,962 - INFO - Setting up training args and starting training...
2023-08-18 00:56:22,281 - INFO - Training complete...
2023-08-18 00:56:22,282 - INFO - TrainOutput(global_step=1080, training_loss=0.5250763327987106, metrics={'train_runtime': 13.127, 'train_samples_per_second': 656.966, 'train_steps_per_second': 82.273, 'total_flos': 1069988304000.0, 'train_loss': 0.5250763327987106, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:56:22,282 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:56:22,318 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:56:22,319 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	2	5e-05	0.5588923692703247	0.7367688022284122	0.6455696202531646	0.5930232558139535	0.6181818181818183	0.7052072800808898	0.418759639588103	0.358	2005.462	251.381	3.7500000000000003e-05	1.0	270
prajjwal1/bert-tiny	1	2	5e-05	0.4963645339012146	0.7715877437325905	0.7043478260869566	0.627906976744186	0.6639344262295082	0.7400404448938321	0.49366161367329553	0.3434	2090.98	262.1	2.5e-05	2.0	540
prajjwal1/bert-tiny	1	2	5e-05	0.49240991473197937	0.7688022284122563	0.6597222222222222	0.7364341085271318	0.6959706959706959	0.761695315133131	0.5123706459749072	0.3415	2102.222	263.51	1.25e-05	3.0	810
prajjwal1/bert-tiny	1	2	5e-05	0.4800509810447693	0.7841225626740947	0.6928838951310862	0.7170542635658915	0.7047619047619048	0.7693966970003371	0.5348932649009079	0.3281	2188.472	274.321	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	2	5e-05	13.127	656.966	82.273	1069988304000.0	0.5250763327987106	0.0	4.0	1080

2023-08-18 00:56:22,319 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:56:22,319 - INFO - **TRACE** Appending...0.5588923692703247
2023-08-18 00:56:22,319 - INFO - **TRACE** Appending...0.4963645339012146
2023-08-18 00:56:22,319 - INFO - **TRACE** Appending...0.49240991473197937
2023-08-18 00:56:22,319 - INFO - **TRACE** Appending...0.4800509810447693
2023-08-18 00:56:22,319 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.4800509810447693 < 0.6581004858016968 LR: 5e-05
2023-08-18 00:56:22,354 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-18 00:56:22,354 - INFO - -----------------------------------
2023-08-18 00:56:22,354 - INFO - -----------------------------------
2023-08-18 00:56:22,354 - INFO - **TRACE** Inner Fold: 3 for outer fold: 1
2023-08-18 00:56:22,354 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-18 00:56:22,354 - INFO - **TRACE** Create dataset...
2023-08-18 00:56:22,355 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:56:22,359 - INFO - **TRACE** Tokenise data...
2023-08-18 00:56:22,972 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:56:22,972 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 3e-05
2023-08-18 00:56:22,972 - INFO - Setting up training args and starting training...
2023-08-18 00:56:35,844 - INFO - Training complete...
2023-08-18 00:56:35,845 - INFO - TrainOutput(global_step=1080, training_loss=0.5683086006729691, metrics={'train_runtime': 12.7388, 'train_samples_per_second': 676.985, 'train_steps_per_second': 84.78, 'total_flos': 1069988304000.0, 'train_loss': 0.5683086006729691, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:56:35,845 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:56:35,879 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:56:35,879 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	3	3e-05	0.5832561254501343	0.7367688022284122	0.6860986547085202	0.5625	0.6181818181818182	0.70277466367713	0.4251483870798502	0.3494	2054.714	257.555	2.25e-05	1.0	270
prajjwal1/bert-tiny	1	3	3e-05	0.5276615619659424	0.7604456824512534	0.7358490566037735	0.5735294117647058	0.6446280991735537	0.7239844368240569	0.47638330306065446	0.331	2169.057	271.887	1.5e-05	2.0	540
prajjwal1/bert-tiny	1	3	3e-05	0.5063923001289368	0.7701949860724234	0.720164609053498	0.6433823529411765	0.6796116504854369	0.7454579926140861	0.5032793527055127	0.3458	2076.609	260.299	7.5e-06	3.0	810
prajjwal1/bert-tiny	1	3	3e-05	0.5011686682701111	0.7743732590529248	0.7182539682539683	0.6654411764705882	0.6908396946564885	0.7531241756792404	0.5145437111553334	0.3433	2091.726	262.194	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	1	3	3e-05	12.7388	676.985	84.78	1069988304000.0	0.5683086006729691	0.0	4.0	1080

2023-08-18 00:56:35,879 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:56:35,879 - INFO - **TRACE** Appending...0.5832561254501343
2023-08-18 00:56:35,880 - INFO - **TRACE** Appending...0.5276615619659424
2023-08-18 00:56:35,880 - INFO - **TRACE** Appending...0.5063923001289368
2023-08-18 00:56:35,880 - INFO - **TRACE** Appending...0.5011686682701111
2023-08-18 00:56:35,880 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.5011686682701111 >= 0.4800509810447693 LR: 3e-05
2023-08-18 00:56:35,880 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-18 00:56:35,880 - INFO - -----------------------------------
2023-08-18 00:56:35,880 - INFO - -----------------------------------
2023-08-18 00:56:35,880 - INFO - **TRACE** All inner CVs complete for outer CV 1
2023-08-18 00:56:35,880 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.4800509810447693 with learning rate: 3e-05
2023-08-18 00:56:35,880 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-18 00:56:35,880 - INFO - **TRACE** Loading the best model from inner CV
2023-08-18 00:56:35,920 - INFO - **TRACE** Running predictions with test data
2023-08-18 00:56:36,388 - INFO - Metrics from the Predictions...
2023-08-18 00:56:36,388 - INFO - {'test_loss': 0.5011778473854065, 'test_accuracy': 0.7565217391304347, 'test_precision': 0.6836158192090396, 'test_recall': 0.5902439024390244, 'test_f1': 0.6335078534031414, 'test_roc_auc': 0.7194462755438364, 'test_matthews_correlation': 0.45541552694739634, 'test_runtime': 0.2917, 'test_samples_per_second': 1971.136, 'test_steps_per_second': 246.821}
2023-08-18 00:56:36,388 - INFO - {'confusion_matrix': array([[314,  56],
       [ 84, 121]])}
2023-08-18 00:56:36,388 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
prajjwal1/bert-tiny	1	0.5011778473854065	0.7565217391304347	0.6836158192090396	0.5902439024390244	0.6335078534031414	0.7194462755438364	0.45541552694739634	0.2917	1971.136	246.821
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
prajjwal1/bert-tiny	1	[[314  56]
 [ 84 121]]

2023-08-18 00:56:36,389 - INFO - ----------------------------------------------------------------------
2023-08-18 00:56:36,389 - INFO - ----------------------------------------------------------------------
2023-08-18 00:56:36,389 - INFO - **TRACE** Outer Fold:2
2023-08-18 00:56:36,389 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-18 00:56:37,013 - INFO - -----------------------------------
2023-08-18 00:56:37,013 - INFO - -----------------------------------
2023-08-18 00:56:37,013 - INFO - **TRACE** Inner Fold: 0 for outer fold: 2
2023-08-18 00:56:37,013 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-18 00:56:37,013 - INFO - **TRACE** Create dataset...
2023-08-18 00:56:37,014 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:56:37,018 - INFO - **TRACE** Tokenise data...
2023-08-18 00:56:37,658 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:56:37,658 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 1e-05
2023-08-18 00:56:37,658 - INFO - Setting up training args and starting training...
2023-08-18 00:56:50,733 - INFO - Training complete...
2023-08-18 00:56:50,734 - INFO - TrainOutput(global_step=1080, training_loss=0.6314765011822736, metrics={'train_runtime': 12.9405, 'train_samples_per_second': 666.126, 'train_steps_per_second': 83.459, 'total_flos': 1069492020000.0, 'train_loss': 0.6314765011822736, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:56:50,734 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:56:50,774 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:56:50,774 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	0	1e-05	0.6516326069831848	0.6008344923504868	1.0	0.003472222222222222	0.006920415224913494	0.5017361111111112	0.04565414029584714	0.3371	2133.105	267.009	7.500000000000001e-06	1.0	270
prajjwal1/bert-tiny	2	0	1e-05	0.6248172521591187	0.6634214186369958	0.8484848484848485	0.19444444444444445	0.3163841807909604	0.5856212941479763	0.2906150518756629	0.3423	2100.449	262.921	5e-06	2.0	540
prajjwal1/bert-tiny	2	0	1e-05	0.6127942204475403	0.6898470097357441	0.8217821782178217	0.2881944444444444	0.4267352185089973	0.6232155516885794	0.3475165371876433	0.3291	2184.693	273.466	2.5e-06	3.0	810
prajjwal1/bert-tiny	2	0	1e-05	0.6082788109779358	0.6995827538247567	0.8	0.3333333333333333	0.47058823529411764	0.6388244392884763	0.3648604323628531	0.3397	2116.55	264.937	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	0	1e-05	12.9405	666.126	83.459	1069492020000.0	0.6314765011822736	0.0	4.0	1080

2023-08-18 00:56:50,774 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:56:50,774 - INFO - **TRACE** Appending...0.6516326069831848
2023-08-18 00:56:50,774 - INFO - **TRACE** Appending...0.6248172521591187
2023-08-18 00:56:50,774 - INFO - **TRACE** Appending...0.6127942204475403
2023-08-18 00:56:50,774 - INFO - **TRACE** Appending...0.6082788109779358
2023-08-18 00:56:50,774 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.6082788109779358 < 1000 LR: 1e-05
2023-08-18 00:56:50,820 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-18 00:56:50,820 - INFO - -----------------------------------
2023-08-18 00:56:50,820 - INFO - -----------------------------------
2023-08-18 00:56:50,820 - INFO - **TRACE** Inner Fold: 1 for outer fold: 2
2023-08-18 00:56:50,820 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-18 00:56:50,820 - INFO - **TRACE** Create dataset...
2023-08-18 00:56:50,821 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:56:50,825 - INFO - **TRACE** Tokenise data...
2023-08-18 00:56:51,753 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:56:51,753 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-06
2023-08-18 00:56:51,753 - INFO - Setting up training args and starting training...
2023-08-18 00:57:04,694 - INFO - Training complete...
2023-08-18 00:57:04,694 - INFO - TrainOutput(global_step=1080, training_loss=0.6703917997854727, metrics={'train_runtime': 12.8, 'train_samples_per_second': 673.439, 'train_steps_per_second': 84.375, 'total_flos': 1069492020000.0, 'train_loss': 0.6703917997854727, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:57:04,694 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:57:04,726 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:57:04,726 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	1	5e-06	0.6724239587783813	0.6022253129346314	0.4	0.02120141342756184	0.04026845637583893	0.5002796057963497	0.0019115280233665786	0.331	2172.421	271.93	3.7500000000000005e-06	1.0	270
prajjwal1/bert-tiny	2	1	5e-06	0.6573832631111145	0.6063977746870653	0.0	0.0	0.0	0.5	0.0	0.3383	2125.43	266.048	2.5e-06	2.0	540
prajjwal1/bert-tiny	2	1	5e-06	0.6492090821266174	0.6063977746870653	0.0	0.0	0.0	0.5	0.0	0.3449	2084.778	260.96	1.25e-06	3.0	810
prajjwal1/bert-tiny	2	1	5e-06	0.6465511918067932	0.6063977746870653	0.0	0.0	0.0	0.5	0.0	0.3353	2144.641	268.453	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	1	5e-06	12.8	673.439	84.375	1069492020000.0	0.6703917997854727	0.0	4.0	1080

2023-08-18 00:57:04,726 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:57:04,726 - INFO - **TRACE** Appending...0.6724239587783813
2023-08-18 00:57:04,726 - INFO - **TRACE** Appending...0.6573832631111145
2023-08-18 00:57:04,726 - INFO - **TRACE** Appending...0.6492090821266174
2023-08-18 00:57:04,726 - INFO - **TRACE** Appending...0.6465511918067932
2023-08-18 00:57:04,726 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.6465511918067932 >= 0.6082788109779358 LR: 5e-06
2023-08-18 00:57:04,726 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-18 00:57:04,726 - INFO - -----------------------------------
2023-08-18 00:57:04,726 - INFO - -----------------------------------
2023-08-18 00:57:04,726 - INFO - **TRACE** Inner Fold: 2 for outer fold: 2
2023-08-18 00:57:04,726 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-18 00:57:04,726 - INFO - **TRACE** Create dataset...
2023-08-18 00:57:04,727 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:57:04,731 - INFO - **TRACE** Tokenise data...
2023-08-18 00:57:10,385 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:57:10,385 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-05
2023-08-18 00:57:10,385 - INFO - Setting up training args and starting training...
2023-08-18 00:57:23,840 - INFO - Training complete...
2023-08-18 00:57:23,840 - INFO - TrainOutput(global_step=1080, training_loss=0.5293767222651728, metrics={'train_runtime': 13.3168, 'train_samples_per_second': 647.605, 'train_steps_per_second': 81.101, 'total_flos': 1069988304000.0, 'train_loss': 0.5293767222651728, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:57:23,840 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:57:23,876 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:57:23,876 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	2	5e-05	0.5654398202896118	0.724233983286908	0.6040955631399317	0.6833976833976834	0.6413043478260869	0.7153371859254212	0.42080120866335197	0.3376	2126.872	266.6	3.7500000000000003e-05	1.0	270
prajjwal1/bert-tiny	2	2	5e-05	0.4981796145439148	0.786908077994429	0.7172131147540983	0.6756756756756757	0.6958250497017893	0.7626744391450274	0.5326230412918904	0.3503	2049.461	256.896	2.5e-05	2.0	540
prajjwal1/bert-tiny	2	2	5e-05	0.4760347902774811	0.786908077994429	0.7226890756302521	0.6640926640926641	0.69215291750503	0.7601509072097308	0.5307652338350886	0.3545	2025.43	253.884	1.25e-05	3.0	810
prajjwal1/bert-tiny	2	2	5e-05	0.46936067938804626	0.7799442896935933	0.6980392156862745	0.6872586872586872	0.6926070038910506	0.759751347986642	0.5212948623862335	0.3652	1966.285	246.47	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	2	5e-05	13.3168	647.605	81.101	1069988304000.0	0.5293767222651728	0.0	4.0	1080

2023-08-18 00:57:23,876 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:57:23,876 - INFO - **TRACE** Appending...0.5654398202896118
2023-08-18 00:57:23,876 - INFO - **TRACE** Appending...0.4981796145439148
2023-08-18 00:57:23,876 - INFO - **TRACE** Appending...0.4760347902774811
2023-08-18 00:57:23,876 - INFO - **TRACE** Appending...0.46936067938804626
2023-08-18 00:57:23,876 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.46936067938804626 < 0.6465511918067932 LR: 5e-05
2023-08-18 00:57:23,916 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-18 00:57:23,916 - INFO - -----------------------------------
2023-08-18 00:57:23,916 - INFO - -----------------------------------
2023-08-18 00:57:23,916 - INFO - **TRACE** Inner Fold: 3 for outer fold: 2
2023-08-18 00:57:23,916 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-18 00:57:23,916 - INFO - **TRACE** Create dataset...
2023-08-18 00:57:23,917 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:57:23,921 - INFO - **TRACE** Tokenise data...
2023-08-18 00:57:24,889 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:57:24,889 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 3e-05
2023-08-18 00:57:24,889 - INFO - Setting up training args and starting training...
2023-08-18 00:57:38,133 - INFO - Training complete...
2023-08-18 00:57:38,133 - INFO - TrainOutput(global_step=1080, training_loss=0.5620874228300872, metrics={'train_runtime': 13.0807, 'train_samples_per_second': 659.291, 'train_steps_per_second': 82.564, 'total_flos': 1069988304000.0, 'train_loss': 0.5620874228300872, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:57:38,133 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:57:38,165 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:57:38,165 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	3	3e-05	0.6031652092933655	0.6880222841225627	0.6984126984126984	0.32116788321167883	0.43999999999999995	0.6177911488130466	0.3008591981389878	0.3228	2223.999	278.774	2.25e-05	1.0	270
prajjwal1/bert-tiny	2	3	3e-05	0.5640434622764587	0.7298050139275766	0.702020202020202	0.5072992700729927	0.5889830508474576	0.6872081935950549	0.40699338251157346	0.3296	2178.166	273.029	1.5e-05	2.0	540
prajjwal1/bert-tiny	2	3	3e-05	0.554401695728302	0.7437325905292479	0.7008928571428571	0.572992700729927	0.6305220883534137	0.7110458999145132	0.4425743068377502	0.3181	2257.125	282.927	7.5e-06	3.0	810
prajjwal1/bert-tiny	2	3	3e-05	0.5511202216148376	0.733983286908078	0.6680161943319838	0.6021897810218978	0.6333973128598849	0.7087525481686066	0.4269427247257387	0.3388	2119.276	265.647	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	2	3	3e-05	13.0807	659.291	82.564	1069988304000.0	0.5620874228300872	0.0	4.0	1080

2023-08-18 00:57:38,165 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:57:38,165 - INFO - **TRACE** Appending...0.6031652092933655
2023-08-18 00:57:38,165 - INFO - **TRACE** Appending...0.5640434622764587
2023-08-18 00:57:38,165 - INFO - **TRACE** Appending...0.554401695728302
2023-08-18 00:57:38,165 - INFO - **TRACE** Appending...0.5511202216148376
2023-08-18 00:57:38,165 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.5511202216148376 >= 0.46936067938804626 LR: 3e-05
2023-08-18 00:57:38,165 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-18 00:57:38,165 - INFO - -----------------------------------
2023-08-18 00:57:38,165 - INFO - -----------------------------------
2023-08-18 00:57:38,166 - INFO - **TRACE** All inner CVs complete for outer CV 2
2023-08-18 00:57:38,166 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.46936067938804626 with learning rate: 3e-05
2023-08-18 00:57:38,166 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-18 00:57:38,166 - INFO - **TRACE** Loading the best model from inner CV
2023-08-18 00:57:38,211 - INFO - **TRACE** Running predictions with test data
2023-08-18 00:57:38,678 - INFO - Metrics from the Predictions...
2023-08-18 00:57:38,678 - INFO - {'test_loss': 0.4880668818950653, 'test_accuracy': 0.7547826086956522, 'test_precision': 0.6777777777777778, 'test_recall': 0.5951219512195122, 'test_f1': 0.6337662337662339, 'test_roc_auc': 0.7191825972313778, 'test_matthews_correlation': 0.4527714735446452, 'test_runtime': 0.2867, 'test_samples_per_second': 2005.761, 'test_steps_per_second': 251.156}
2023-08-18 00:57:38,678 - INFO - {'confusion_matrix': array([[312,  58],
       [ 83, 122]])}
2023-08-18 00:57:38,678 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
prajjwal1/bert-tiny	2	0.4880668818950653	0.7547826086956522	0.6777777777777778	0.5951219512195122	0.6337662337662339	0.7191825972313778	0.4527714735446452	0.2867	2005.761	251.156
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
prajjwal1/bert-tiny	2	[[312  58]
 [ 83 122]]

2023-08-18 00:57:38,679 - INFO - ----------------------------------------------------------------------
2023-08-18 00:57:38,679 - INFO - ----------------------------------------------------------------------
2023-08-18 00:57:38,679 - INFO - **TRACE** Outer Fold:3
2023-08-18 00:57:38,679 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-18 00:57:39,319 - INFO - -----------------------------------
2023-08-18 00:57:39,319 - INFO - -----------------------------------
2023-08-18 00:57:39,319 - INFO - **TRACE** Inner Fold: 0 for outer fold: 3
2023-08-18 00:57:39,319 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-18 00:57:39,319 - INFO - **TRACE** Create dataset...
2023-08-18 00:57:39,320 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:57:39,324 - INFO - **TRACE** Tokenise data...
2023-08-18 00:57:45,001 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:57:45,001 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 1e-05
2023-08-18 00:57:45,001 - INFO - Setting up training args and starting training...
2023-08-18 00:57:59,163 - INFO - Training complete...
2023-08-18 00:57:59,163 - INFO - TrainOutput(global_step=1080, training_loss=0.6362831151043927, metrics={'train_runtime': 14.0156, 'train_samples_per_second': 615.028, 'train_steps_per_second': 77.057, 'total_flos': 1069492020000.0, 'train_loss': 0.6362831151043927, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:57:59,163 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:57:59,194 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:57:59,194 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	0	1e-05	0.6396650075912476	0.6342141863699583	1.0	0.011278195488721804	0.022304832713754646	0.5056390977443609	0.0844719264825572	0.3443	2088.114	261.377	7.500000000000001e-06	1.0	270
prajjwal1/bert-tiny	3	0	1e-05	0.6120293140411377	0.6898470097357441	0.7128712871287128	0.2706766917293233	0.39237057220708443	0.6033295158425865	0.2871371497226997	0.3468	2072.963	259.481	5e-06	2.0	540
prajjwal1/bert-tiny	3	0	1e-05	0.5987996459007263	0.7009735744089013	0.6834532374100719	0.35714285714285715	0.4691358024691358	0.630006307158625	0.31787980678250294	0.3361	2139.552	267.816	2.5e-06	3.0	810
prajjwal1/bert-tiny	3	0	1e-05	0.5943859219551086	0.7023643949930459	0.6756756756756757	0.37593984962406013	0.48309178743961356	0.634989792361699	0.3223828516112293	0.3633	1978.94	247.712	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	0	1e-05	14.0156	615.028	77.057	1069492020000.0	0.6362831151043927	0.0	4.0	1080

2023-08-18 00:57:59,194 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:57:59,194 - INFO - **TRACE** Appending...0.6396650075912476
2023-08-18 00:57:59,194 - INFO - **TRACE** Appending...0.6120293140411377
2023-08-18 00:57:59,194 - INFO - **TRACE** Appending...0.5987996459007263
2023-08-18 00:57:59,194 - INFO - **TRACE** Appending...0.5943859219551086
2023-08-18 00:57:59,194 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.5943859219551086 < 1000 LR: 1e-05
2023-08-18 00:57:59,227 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-18 00:57:59,227 - INFO - -----------------------------------
2023-08-18 00:57:59,227 - INFO - -----------------------------------
2023-08-18 00:57:59,227 - INFO - **TRACE** Inner Fold: 1 for outer fold: 3
2023-08-18 00:57:59,227 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-18 00:57:59,227 - INFO - **TRACE** Create dataset...
2023-08-18 00:57:59,228 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:57:59,232 - INFO - **TRACE** Tokenise data...
2023-08-18 00:57:59,897 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:57:59,897 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-06
2023-08-18 00:57:59,897 - INFO - Setting up training args and starting training...
2023-08-18 00:58:12,929 - INFO - Training complete...
2023-08-18 00:58:12,929 - INFO - TrainOutput(global_step=1080, training_loss=0.667999087439643, metrics={'train_runtime': 12.8873, 'train_samples_per_second': 668.877, 'train_steps_per_second': 83.804, 'total_flos': 1069492020000.0, 'train_loss': 0.667999087439643, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:58:12,929 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:58:12,968 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:58:12,968 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	1	5e-06	0.6763345003128052	0.5980528511821975	0.5217391304347826	0.041379310344827586	0.07667731629392971	0.5078691423519011	0.04387493687271778	0.3488	2061.604	258.059	3.7500000000000005e-06	1.0	270
prajjwal1/bert-tiny	3	1	5e-06	0.6628678441047668	0.5966620305980529	0.5	0.0034482758620689655	0.00684931506849315	0.5005586367655332	0.01040668908431173	0.3572	2012.634	251.929	2.5e-06	2.0	540
prajjwal1/bert-tiny	3	1	5e-06	0.6557167172431946	0.6008344923504868	1.0	0.010344827586206896	0.020477815699658706	0.5051724137931034	0.07872882383086617	0.327	2198.535	275.199	1.25e-06	3.0	810
prajjwal1/bert-tiny	3	1	5e-06	0.6532054543495178	0.6008344923504868	0.6666666666666666	0.020689655172413793	0.04013377926421405	0.5068483240897035	0.060435416061349986	0.3285	2188.786	273.979	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	1	5e-06	12.8873	668.877	83.804	1069492020000.0	0.667999087439643	0.0	4.0	1080

2023-08-18 00:58:12,968 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:58:12,968 - INFO - **TRACE** Appending...0.6763345003128052
2023-08-18 00:58:12,968 - INFO - **TRACE** Appending...0.6628678441047668
2023-08-18 00:58:12,968 - INFO - **TRACE** Appending...0.6557167172431946
2023-08-18 00:58:12,968 - INFO - **TRACE** Appending...0.6532054543495178
2023-08-18 00:58:12,968 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.6532054543495178 >= 0.5943859219551086 LR: 5e-06
2023-08-18 00:58:12,968 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-18 00:58:12,968 - INFO - -----------------------------------
2023-08-18 00:58:12,968 - INFO - -----------------------------------
2023-08-18 00:58:12,968 - INFO - **TRACE** Inner Fold: 2 for outer fold: 3
2023-08-18 00:58:12,968 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-18 00:58:12,968 - INFO - **TRACE** Create dataset...
2023-08-18 00:58:12,969 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:58:12,973 - INFO - **TRACE** Tokenise data...
2023-08-18 00:58:18,862 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:58:18,862 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-05
2023-08-18 00:58:18,862 - INFO - Setting up training args and starting training...
2023-08-18 00:58:33,152 - INFO - Training complete...
2023-08-18 00:58:33,153 - INFO - TrainOutput(global_step=1080, training_loss=0.5136308281509965, metrics={'train_runtime': 14.1245, 'train_samples_per_second': 610.571, 'train_steps_per_second': 76.463, 'total_flos': 1069988304000.0, 'train_loss': 0.5136308281509965, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:58:33,153 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:58:33,347 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:58:33,347 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	2	5e-05	0.5538787245750427	0.7437325905292479	0.697560975609756	0.539622641509434	0.6085106382978723	0.7013786496730392	0.43030842079205295	0.3601	1994.079	249.954	3.7500000000000003e-05	1.0	270
prajjwal1/bert-tiny	3	2	5e-05	0.5345700979232788	0.724233983286908	0.6105610561056105	0.6981132075471698	0.6514084507042253	0.7188137781665208	0.42759373756568825	0.3416	2101.934	263.474	2.5e-05	2.0	540
prajjwal1/bert-tiny	3	2	5e-05	0.5086168646812439	0.7618384401114207	0.6942148760330579	0.6339622641509434	0.6627218934911242	0.7353034278812112	0.4804178422205486	0.3719	1930.76	242.017	1.25e-05	3.0	810
prajjwal1/bert-tiny	3	2	5e-05	0.5034552216529846	0.7604456824512534	0.6837944664031621	0.6528301886792452	0.6679536679536678	0.7381148735890708	0.4810628507952919	0.3832	1873.559	234.847	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	2	5e-05	14.1245	610.571	76.463	1069988304000.0	0.5136308281509965	0.0	4.0	1080

2023-08-18 00:58:33,347 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:58:33,347 - INFO - **TRACE** Appending...0.5538787245750427
2023-08-18 00:58:33,347 - INFO - **TRACE** Appending...0.5345700979232788
2023-08-18 00:58:33,347 - INFO - **TRACE** Appending...0.5086168646812439
2023-08-18 00:58:33,347 - INFO - **TRACE** Appending...0.5034552216529846
2023-08-18 00:58:33,347 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.5034552216529846 < 0.6532054543495178 LR: 5e-05
2023-08-18 00:58:33,382 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-18 00:58:33,382 - INFO - -----------------------------------
2023-08-18 00:58:33,382 - INFO - -----------------------------------
2023-08-18 00:58:33,382 - INFO - **TRACE** Inner Fold: 3 for outer fold: 3
2023-08-18 00:58:33,382 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-18 00:58:33,382 - INFO - **TRACE** Create dataset...
2023-08-18 00:58:33,383 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:58:33,388 - INFO - **TRACE** Tokenise data...
2023-08-18 00:58:34,052 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:58:34,052 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 3e-05
2023-08-18 00:58:34,052 - INFO - Setting up training args and starting training...
2023-08-18 00:58:47,836 - INFO - Training complete...
2023-08-18 00:58:47,836 - INFO - TrainOutput(global_step=1080, training_loss=0.5689580846715856, metrics={'train_runtime': 13.6066, 'train_samples_per_second': 633.808, 'train_steps_per_second': 79.373, 'total_flos': 1069988304000.0, 'train_loss': 0.5689580846715856, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:58:47,836 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:58:47,868 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:58:47,869 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	3	3e-05	0.5951743125915527	0.7103064066852368	0.7737226277372263	0.3745583038869258	0.5047619047619047	0.651646968035417	0.3771839669225217	0.3793	1892.936	237.276	2.25e-05	1.0	270
prajjwal1/bert-tiny	3	3	3e-05	0.5470704436302185	0.7506963788300836	0.7476190476190476	0.5547703180212014	0.6369168356997972	0.7164656187807157	0.4650667231327656	0.337	2130.664	267.075	1.5e-05	2.0	540
prajjwal1/bert-tiny	3	3	3e-05	0.5222726464271545	0.7618384401114207	0.724	0.6395759717314488	0.6791744840525329	0.7404776410381383	0.4933437311895588	0.3518	2041.118	255.85	7.5e-06	3.0	810
prajjwal1/bert-tiny	3	3	3e-05	0.5173441171646118	0.766016713091922	0.722007722007722	0.6607773851590106	0.6900369003690038	0.7476300718898502	0.50398197119575	0.3451	2080.32	260.764	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	3	3	3e-05	13.6066	633.808	79.373	1069988304000.0	0.5689580846715856	0.0	4.0	1080

2023-08-18 00:58:47,869 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:58:47,869 - INFO - **TRACE** Appending...0.5951743125915527
2023-08-18 00:58:47,869 - INFO - **TRACE** Appending...0.5470704436302185
2023-08-18 00:58:47,869 - INFO - **TRACE** Appending...0.5222726464271545
2023-08-18 00:58:47,869 - INFO - **TRACE** Appending...0.5173441171646118
2023-08-18 00:58:47,869 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.5173441171646118 >= 0.5034552216529846 LR: 3e-05
2023-08-18 00:58:47,869 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-18 00:58:47,869 - INFO - -----------------------------------
2023-08-18 00:58:47,869 - INFO - -----------------------------------
2023-08-18 00:58:47,869 - INFO - **TRACE** All inner CVs complete for outer CV 3
2023-08-18 00:58:47,869 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.5034552216529846 with learning rate: 3e-05
2023-08-18 00:58:47,869 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-18 00:58:47,869 - INFO - **TRACE** Loading the best model from inner CV
2023-08-18 00:58:47,915 - INFO - **TRACE** Running predictions with test data
2023-08-18 00:58:48,411 - INFO - Metrics from the Predictions...
2023-08-18 00:58:48,411 - INFO - {'test_loss': 0.48178020119667053, 'test_accuracy': 0.7895652173913044, 'test_precision': 0.7202072538860104, 'test_recall': 0.6747572815533981, 'test_f1': 0.6967418546365916, 'test_roc_auc': 0.7642079090693819, 'test_matthews_correlation': 0.5365525547372402, 'test_runtime': 0.3084, 'test_samples_per_second': 1864.236, 'test_steps_per_second': 233.435}
2023-08-18 00:58:48,411 - INFO - {'confusion_matrix': array([[315,  54],
       [ 67, 139]])}
2023-08-18 00:58:48,411 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
prajjwal1/bert-tiny	3	0.48178020119667053	0.7895652173913044	0.7202072538860104	0.6747572815533981	0.6967418546365916	0.7642079090693819	0.5365525547372402	0.3084	1864.236	233.435
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
prajjwal1/bert-tiny	3	[[315  54]
 [ 67 139]]

2023-08-18 00:58:48,411 - INFO - ----------------------------------------------------------------------
2023-08-18 00:58:48,411 - INFO - ----------------------------------------------------------------------
2023-08-18 00:58:48,411 - INFO - **TRACE** Outer Fold:4
2023-08-18 00:58:48,412 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-18 00:58:49,315 - INFO - -----------------------------------
2023-08-18 00:58:49,315 - INFO - -----------------------------------
2023-08-18 00:58:49,315 - INFO - **TRACE** Inner Fold: 0 for outer fold: 4
2023-08-18 00:58:49,315 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-18 00:58:49,315 - INFO - **TRACE** Create dataset...
2023-08-18 00:58:49,316 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:58:49,320 - INFO - **TRACE** Tokenise data...
2023-08-18 00:58:49,970 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:58:49,970 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 1e-05
2023-08-18 00:58:49,970 - INFO - Setting up training args and starting training...
2023-08-18 00:59:03,954 - INFO - Training complete...
2023-08-18 00:59:03,954 - INFO - TrainOutput(global_step=1080, training_loss=0.6320312040823477, metrics={'train_runtime': 13.8084, 'train_samples_per_second': 624.258, 'train_steps_per_second': 78.213, 'total_flos': 1069492020000.0, 'train_loss': 0.6320312040823477, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:59:03,955 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:59:03,986 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:59:03,987 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	0	1e-05	0.645730197429657	0.6119610570236439	0.6666666666666666	0.007142857142857143	0.014134275618374558	0.5024324764074194	0.03680211428775793	0.3543	2029.552	254.047	7.500000000000001e-06	1.0	270
prajjwal1/bert-tiny	4	0	1e-05	0.619088351726532	0.6731571627260083	0.7586206896551724	0.2357142857142857	0.35967302452316074	0.5939391474129515	0.28091163030436356	0.3425	2099.501	262.803	5e-06	2.0	540
prajjwal1/bert-tiny	4	0	1e-05	0.6059056520462036	0.694019471488178	0.7272727272727273	0.34285714285714286	0.46601941747572817	0.6304262935242435	0.3285491953009995	0.362	1986.245	248.626	2.5e-06	3.0	810
prajjwal1/bert-tiny	4	0	1e-05	0.6018437743186951	0.7065368567454798	0.7315436241610739	0.3892857142857143	0.5081585081585082	0.6490847705824926	0.3587104185952539	0.3675	1956.627	244.919	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	0	1e-05	13.8084	624.258	78.213	1069492020000.0	0.6320312040823477	0.0	4.0	1080

2023-08-18 00:59:03,987 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:59:03,987 - INFO - **TRACE** Appending...0.645730197429657
2023-08-18 00:59:03,987 - INFO - **TRACE** Appending...0.619088351726532
2023-08-18 00:59:03,987 - INFO - **TRACE** Appending...0.6059056520462036
2023-08-18 00:59:03,987 - INFO - **TRACE** Appending...0.6018437743186951
2023-08-18 00:59:03,987 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.6018437743186951 < 1000 LR: 1e-05
2023-08-18 00:59:04,018 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-18 00:59:04,018 - INFO - -----------------------------------
2023-08-18 00:59:04,018 - INFO - -----------------------------------
2023-08-18 00:59:04,018 - INFO - **TRACE** Inner Fold: 1 for outer fold: 4
2023-08-18 00:59:04,018 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-18 00:59:04,018 - INFO - **TRACE** Create dataset...
2023-08-18 00:59:04,019 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-18 00:59:04,023 - INFO - **TRACE** Tokenise data...
2023-08-18 00:59:04,684 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:59:04,685 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-06
2023-08-18 00:59:04,685 - INFO - Setting up training args and starting training...
2023-08-18 00:59:18,578 - INFO - Training complete...
2023-08-18 00:59:18,578 - INFO - TrainOutput(global_step=1080, training_loss=0.6689985557838722, metrics={'train_runtime': 13.1542, 'train_samples_per_second': 655.304, 'train_steps_per_second': 82.103, 'total_flos': 1069492020000.0, 'train_loss': 0.6689985557838722, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:59:18,578 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:59:18,631 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:59:18,631 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	1	5e-06	0.6765512824058533	0.5938803894297635	0.6	0.02040816326530612	0.039473684210526314	0.5054981992797118	0.046163155220916054	0.3476	2068.482	258.92	3.7500000000000005e-06	1.0	270
prajjwal1/bert-tiny	4	1	5e-06	0.6635806560516357	0.5897079276773296	0.0	0.0	0.0	0.4988235294117647	-0.03103966161463281	0.3294	2182.895	273.241	2.5e-06	2.0	540
prajjwal1/bert-tiny	4	1	5e-06	0.656298041343689	0.5910987482614742	0.0	0.0	0.0	0.5	0.0	0.3257	2207.648	276.34	1.25e-06	3.0	810
prajjwal1/bert-tiny	4	1	5e-06	0.6538455486297607	0.5924895688456189	1.0	0.003401360544217687	0.006779661016949153	0.5017006802721088	0.04487025913679913	0.3507	2050.14	256.624	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	1	5e-06	13.1542	655.304	82.103	1069492020000.0	0.6689985557838722	0.0	4.0	1080

2023-08-18 00:59:18,631 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:59:18,631 - INFO - **TRACE** Appending...0.6765512824058533
2023-08-18 00:59:18,631 - INFO - **TRACE** Appending...0.6635806560516357
2023-08-18 00:59:18,631 - INFO - **TRACE** Appending...0.656298041343689
2023-08-18 00:59:18,631 - INFO - **TRACE** Appending...0.6538455486297607
2023-08-18 00:59:18,631 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.6538455486297607 >= 0.6018437743186951 LR: 5e-06
2023-08-18 00:59:18,631 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-18 00:59:18,631 - INFO - -----------------------------------
2023-08-18 00:59:18,631 - INFO - -----------------------------------
2023-08-18 00:59:18,631 - INFO - **TRACE** Inner Fold: 2 for outer fold: 4
2023-08-18 00:59:18,631 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-18 00:59:18,631 - INFO - **TRACE** Create dataset...
2023-08-18 00:59:18,632 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:59:18,639 - INFO - **TRACE** Tokenise data...
2023-08-18 00:59:19,459 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:59:19,459 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-05
2023-08-18 00:59:19,459 - INFO - Setting up training args and starting training...
2023-08-18 00:59:33,093 - INFO - Training complete...
2023-08-18 00:59:33,093 - INFO - TrainOutput(global_step=1080, training_loss=0.5304949619151927, metrics={'train_runtime': 13.472, 'train_samples_per_second': 640.141, 'train_steps_per_second': 80.166, 'total_flos': 1069988304000.0, 'train_loss': 0.5304949619151927, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:59:33,093 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:59:33,129 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:59:33,129 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	2	5e-05	0.5701333284378052	0.7298050139275766	0.6397058823529411	0.6444444444444445	0.6420664206642067	0.7128472222222222	0.4250763963538608	0.3435	2090.104	261.991	3.7500000000000003e-05	1.0	270
prajjwal1/bert-tiny	4	2	5e-05	0.5312216877937317	0.7381615598885793	0.6433566433566433	0.6814814814814815	0.6618705035971223	0.7269014550264552	0.4490175083737978	0.373	1924.952	241.289	2.5e-05	2.0	540
prajjwal1/bert-tiny	4	2	5e-05	0.5125057101249695	0.754874651810585	0.6666666666666666	0.6962962962962963	0.6811594202898551	0.7432374338624338	0.48251797766873133	0.3318	2163.785	271.227	1.25e-05	3.0	810
prajjwal1/bert-tiny	4	2	5e-05	0.5067821145057678	0.754874651810585	0.6690647482014388	0.6888888888888889	0.6788321167883211	0.741765873015873	0.48083618816133855	0.3341	2148.977	269.37	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	2	5e-05	13.472	640.141	80.166	1069988304000.0	0.5304949619151927	0.0	4.0	1080

2023-08-18 00:59:33,129 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:59:33,129 - INFO - **TRACE** Appending...0.5701333284378052
2023-08-18 00:59:33,129 - INFO - **TRACE** Appending...0.5312216877937317
2023-08-18 00:59:33,129 - INFO - **TRACE** Appending...0.5125057101249695
2023-08-18 00:59:33,129 - INFO - **TRACE** Appending...0.5067821145057678
2023-08-18 00:59:33,129 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.5067821145057678 < 0.6538455486297607 LR: 5e-05
2023-08-18 00:59:33,162 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-18 00:59:33,162 - INFO - -----------------------------------
2023-08-18 00:59:33,162 - INFO - -----------------------------------
2023-08-18 00:59:33,162 - INFO - **TRACE** Inner Fold: 3 for outer fold: 4
2023-08-18 00:59:33,162 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-18 00:59:33,162 - INFO - **TRACE** Create dataset...
2023-08-18 00:59:33,163 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-18 00:59:33,167 - INFO - **TRACE** Tokenise data...
2023-08-18 00:59:33,777 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:59:33,778 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 3e-05
2023-08-18 00:59:33,778 - INFO - Setting up training args and starting training...
2023-08-18 00:59:47,007 - INFO - Training complete...
2023-08-18 00:59:47,008 - INFO - TrainOutput(global_step=1080, training_loss=0.5733840942382813, metrics={'train_runtime': 13.0879, 'train_samples_per_second': 658.931, 'train_steps_per_second': 82.519, 'total_flos': 1069988304000.0, 'train_loss': 0.5733840942382813, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 00:59:47,008 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 00:59:47,038 - INFO - **TRACE** Report evaluation results...
2023-08-18 00:59:47,039 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	3	3e-05	0.5985259413719177	0.7075208913649025	0.6106194690265486	0.5307692307692308	0.5679012345679012	0.6693147463889821	0.3504349571733726	0.3446	2083.414	261.152	2.25e-05	1.0	270
prajjwal1/bert-tiny	4	3	3e-05	0.5461417436599731	0.7493036211699164	0.6739130434782609	0.5961538461538461	0.6326530612244897	0.7161991938192812	0.4453789118096246	0.3462	2073.919	259.962	1.5e-05	2.0	540
prajjwal1/bert-tiny	4	3	3e-05	0.5269239544868469	0.7534818941504178	0.6666666666666666	0.6384615384615384	0.6522593320235757	0.7286194155189788	0.4617175939629237	0.3611	1988.356	249.237	7.5e-06	3.0	810
prajjwal1/bert-tiny	4	3	3e-05	0.5212753415107727	0.7479108635097493	0.6586345381526104	0.6307692307692307	0.6444007858546168	0.7225898555592879	0.4495403521003988	0.3381	2123.767	266.21	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	4	3	3e-05	13.0879	658.931	82.519	1069988304000.0	0.5733840942382813	0.0	4.0	1080

2023-08-18 00:59:47,039 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 00:59:47,039 - INFO - **TRACE** Appending...0.5985259413719177
2023-08-18 00:59:47,039 - INFO - **TRACE** Appending...0.5461417436599731
2023-08-18 00:59:47,039 - INFO - **TRACE** Appending...0.5269239544868469
2023-08-18 00:59:47,039 - INFO - **TRACE** Appending...0.5212753415107727
2023-08-18 00:59:47,039 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.5212753415107727 >= 0.5067821145057678 LR: 3e-05
2023-08-18 00:59:47,039 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-18 00:59:47,039 - INFO - -----------------------------------
2023-08-18 00:59:47,039 - INFO - -----------------------------------
2023-08-18 00:59:47,039 - INFO - **TRACE** All inner CVs complete for outer CV 4
2023-08-18 00:59:47,039 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.5067821145057678 with learning rate: 3e-05
2023-08-18 00:59:47,039 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-18 00:59:47,039 - INFO - **TRACE** Loading the best model from inner CV
2023-08-18 00:59:47,093 - INFO - **TRACE** Running predictions with test data
2023-08-18 00:59:47,568 - INFO - Metrics from the Predictions...
2023-08-18 00:59:47,568 - INFO - {'test_loss': 0.5307641625404358, 'test_accuracy': 0.7426086956521739, 'test_precision': 0.6629213483146067, 'test_recall': 0.5728155339805825, 'test_f1': 0.6145833333333334, 'test_roc_auc': 0.7051069539821612, 'test_matthews_correlation': 0.42545332235984007, 'test_runtime': 0.3049, 'test_samples_per_second': 1886.158, 'test_steps_per_second': 236.18}
2023-08-18 00:59:47,568 - INFO - {'confusion_matrix': array([[309,  60],
       [ 88, 118]])}
2023-08-18 00:59:47,568 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
prajjwal1/bert-tiny	4	0.5307641625404358	0.7426086956521739	0.6629213483146067	0.5728155339805825	0.6145833333333334	0.7051069539821612	0.42545332235984007	0.3049	1886.158	236.18
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
prajjwal1/bert-tiny	4	[[309  60]
 [ 88 118]]

2023-08-18 00:59:47,568 - INFO - ----------------------------------------------------------------------
2023-08-18 00:59:47,568 - INFO - ----------------------------------------------------------------------
2023-08-18 00:59:47,568 - INFO - **TRACE** Outer Fold:5
2023-08-18 00:59:47,569 - INFO - Dataset sizes: Train - 2875 Test - 574
2023-08-18 00:59:48,456 - INFO - -----------------------------------
2023-08-18 00:59:48,456 - INFO - -----------------------------------
2023-08-18 00:59:48,456 - INFO - **TRACE** Inner Fold: 0 for outer fold: 5
2023-08-18 00:59:48,457 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-18 00:59:48,457 - INFO - **TRACE** Create dataset...
2023-08-18 00:59:48,457 - INFO - Dataset sizes: Train - 2156 Dev - 719
2023-08-18 00:59:48,461 - INFO - **TRACE** Tokenise data...
2023-08-18 00:59:49,434 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 00:59:49,434 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 1e-05
2023-08-18 00:59:49,434 - INFO - Setting up training args and starting training...
2023-08-18 01:00:03,065 - INFO - Training complete...
2023-08-18 01:00:03,065 - INFO - TrainOutput(global_step=1080, training_loss=0.6343026302478931, metrics={'train_runtime': 13.4687, 'train_samples_per_second': 640.3, 'train_steps_per_second': 80.186, 'total_flos': 1069988304000.0, 'train_loss': 0.6343026302478931, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 01:00:03,065 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 01:00:03,098 - INFO - **TRACE** Report evaluation results...
2023-08-18 01:00:03,098 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	0	1e-05	0.6462984085083008	0.6189151599443672	0.75	0.010869565217391304	0.021428571428571425	0.5043061144371381	0.056310443840631885	0.3619	1986.484	248.656	7.500000000000001e-06	1.0	270
prajjwal1/bert-tiny	5	0	1e-05	0.6200684309005737	0.6648122392211405	0.8070175438596491	0.16666666666666666	0.27627627627627627	0.5709179834462003	0.25531501435490106	0.3472	2070.587	259.183	5e-06	2.0	540
prajjwal1/bert-tiny	5	0	1e-05	0.6044289469718933	0.6995827538247567	0.717391304347826	0.358695652173913	0.4782608695652174	0.6353297673962116	0.3342351538645289	0.3532	2035.814	254.831	2.5e-06	3.0	810
prajjwal1/bert-tiny	5	0	1e-05	0.5996706485748291	0.7051460361613352	0.7105263157894737	0.391304347826087	0.5046728971962617	0.6459907743645108	0.3477751035104018	0.3373	2131.873	266.855	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	0	1e-05	13.4687	640.3	80.186	1069988304000.0	0.6343026302478931	0.0	4.0	1080

2023-08-18 01:00:03,098 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 01:00:03,098 - INFO - **TRACE** Appending...0.6462984085083008
2023-08-18 01:00:03,098 - INFO - **TRACE** Appending...0.6200684309005737
2023-08-18 01:00:03,098 - INFO - **TRACE** Appending...0.6044289469718933
2023-08-18 01:00:03,098 - INFO - **TRACE** Appending...0.5996706485748291
2023-08-18 01:00:03,098 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.5996706485748291 < 1000 LR: 1e-05
2023-08-18 01:00:03,129 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-18 01:00:03,130 - INFO - -----------------------------------
2023-08-18 01:00:03,130 - INFO - -----------------------------------
2023-08-18 01:00:03,130 - INFO - **TRACE** Inner Fold: 1 for outer fold: 5
2023-08-18 01:00:03,130 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-18 01:00:03,130 - INFO - **TRACE** Create dataset...
2023-08-18 01:00:03,130 - INFO - Dataset sizes: Train - 2156 Dev - 719
2023-08-18 01:00:03,135 - INFO - **TRACE** Tokenise data...
2023-08-18 01:00:05,858 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 01:00:05,858 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-06
2023-08-18 01:00:05,858 - INFO - Setting up training args and starting training...
2023-08-18 01:00:18,586 - INFO - Training complete...
2023-08-18 01:00:18,586 - INFO - TrainOutput(global_step=1080, training_loss=0.6708615903501157, metrics={'train_runtime': 12.554, 'train_samples_per_second': 686.952, 'train_steps_per_second': 86.028, 'total_flos': 1069988304000.0, 'train_loss': 0.6708615903501157, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 01:00:18,586 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 01:00:18,615 - INFO - **TRACE** Report evaluation results...
2023-08-18 01:00:18,616 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	1	5e-06	0.675747275352478	0.6022253129346314	0.6	0.020833333333333332	0.040268456375838924	0.5057762954369682	0.04833827574215146	0.3276	2194.678	274.716	3.7500000000000005e-06	1.0	270
prajjwal1/bert-tiny	5	1	5e-06	0.6633865833282471	0.5994436717663422	0.0	0.0	0.0	0.5	0.0	0.3264	2202.582	275.706	2.5e-06	2.0	540
prajjwal1/bert-tiny	5	1	5e-06	0.6567708849906921	0.5994436717663422	0.0	0.0	0.0	0.5	0.0	0.3373	2131.793	266.845	1.25e-06	3.0	810
prajjwal1/bert-tiny	5	1	5e-06	0.6542478203773499	0.5994436717663422	0.0	0.0	0.0	0.5	0.0	0.3332	2157.877	270.11	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	1	5e-06	12.554	686.952	86.028	1069988304000.0	0.6708615903501157	0.0	4.0	1080

2023-08-18 01:00:18,616 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 01:00:18,616 - INFO - **TRACE** Appending...0.675747275352478
2023-08-18 01:00:18,616 - INFO - **TRACE** Appending...0.6633865833282471
2023-08-18 01:00:18,616 - INFO - **TRACE** Appending...0.6567708849906921
2023-08-18 01:00:18,616 - INFO - **TRACE** Appending...0.6542478203773499
2023-08-18 01:00:18,616 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.6542478203773499 >= 0.5996706485748291 LR: 5e-06
2023-08-18 01:00:18,616 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-18 01:00:18,616 - INFO - -----------------------------------
2023-08-18 01:00:18,616 - INFO - -----------------------------------
2023-08-18 01:00:18,616 - INFO - **TRACE** Inner Fold: 2 for outer fold: 5
2023-08-18 01:00:18,616 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-18 01:00:18,616 - INFO - **TRACE** Create dataset...
2023-08-18 01:00:18,617 - INFO - Dataset sizes: Train - 2156 Dev - 719
2023-08-18 01:00:18,621 - INFO - **TRACE** Tokenise data...
2023-08-18 01:00:19,548 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 01:00:19,548 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 5e-05
2023-08-18 01:00:19,548 - INFO - Setting up training args and starting training...
2023-08-18 01:00:32,528 - INFO - Training complete...
2023-08-18 01:00:32,528 - INFO - TrainOutput(global_step=1080, training_loss=0.5271968488340024, metrics={'train_runtime': 12.8436, 'train_samples_per_second': 671.463, 'train_steps_per_second': 84.089, 'total_flos': 1069988304000.0, 'train_loss': 0.5271968488340024, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 01:00:32,528 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 01:00:32,561 - INFO - **TRACE** Report evaluation results...
2023-08-18 01:00:32,561 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	2	5e-05	0.5624740123748779	0.713490959666203	0.5849673202614379	0.6937984496124031	0.6347517730496455	0.7091551900990432	0.4058104423628865	0.3377	2129.188	266.519	3.7500000000000003e-05	1.0	270
prajjwal1/bert-tiny	5	2	5e-05	0.5018890500068665	0.7538247566063978	0.6462093862815884	0.6937984496124031	0.6691588785046728	0.7406085523550084	0.4742969722489874	0.3335	2155.853	269.856	2.5e-05	2.0	540
prajjwal1/bert-tiny	5	2	5e-05	0.4804520606994629	0.7746870653685675	0.6875	0.6821705426356589	0.6848249027237354	0.7543173754393044	0.50951370023569	0.3392	2119.76	265.339	1.25e-05	3.0	810
prajjwal1/bert-tiny	5	2	5e-05	0.4765626788139343	0.7746870653685675	0.6764705882352942	0.7131782945736435	0.6943396226415095	0.7611444618204443	0.5165744450340516	0.3349	2147.191	268.772	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	2	5e-05	12.8436	671.463	84.089	1069988304000.0	0.5271968488340024	0.0	4.0	1080

2023-08-18 01:00:32,561 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 01:00:32,561 - INFO - **TRACE** Appending...0.5624740123748779
2023-08-18 01:00:32,561 - INFO - **TRACE** Appending...0.5018890500068665
2023-08-18 01:00:32,561 - INFO - **TRACE** Appending...0.4804520606994629
2023-08-18 01:00:32,561 - INFO - **TRACE** Appending...0.4765626788139343
2023-08-18 01:00:32,561 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.4765626788139343 < 0.6542478203773499 LR: 5e-05
2023-08-18 01:00:32,592 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-18 01:00:32,592 - INFO - -----------------------------------
2023-08-18 01:00:32,592 - INFO - -----------------------------------
2023-08-18 01:00:32,592 - INFO - **TRACE** Inner Fold: 3 for outer fold: 5
2023-08-18 01:00:32,592 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-18 01:00:32,592 - INFO - **TRACE** Create dataset...
2023-08-18 01:00:32,593 - INFO - Dataset sizes: Train - 2157 Dev - 718
2023-08-18 01:00:32,597 - INFO - **TRACE** Tokenise data...
2023-08-18 01:00:33,310 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-18 01:00:33,310 - INFO - Function finetune_and_evaluate() received model: prajjwal1/bert-tiny, lr: 3e-05
2023-08-18 01:00:33,310 - INFO - Setting up training args and starting training...
2023-08-18 01:00:46,430 - INFO - Training complete...
2023-08-18 01:00:46,431 - INFO - TrainOutput(global_step=1080, training_loss=0.5672532152246546, metrics={'train_runtime': 12.7605, 'train_samples_per_second': 676.149, 'train_steps_per_second': 84.636, 'total_flos': 1070484588000.0, 'train_loss': 0.5672532152246546, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 01:00:46,431 - INFO - Saving model at /notebooks/complaints/outputs/ft_prajjwal1-bert-tiny
2023-08-18 01:00:46,465 - INFO - **TRACE** Report evaluation results...
2023-08-18 01:00:46,465 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	3	3e-05	0.6067732572555542	0.658774373259053	0.7466666666666667	0.19858156028368795	0.3137254901960785	0.5775017893161559	0.24749897556273937	0.3573	2009.607	251.901	2.25e-05	1.0	270
prajjwal1/bert-tiny	5	3	3e-05	0.5560780763626099	0.7423398328690808	0.7487179487179487	0.5177304964539007	0.6121593291404612	0.7026725876764917	0.44506624433864134	0.339	2117.69	265.449	1.5e-05	2.0	540
prajjwal1/bert-tiny	5	3	3e-05	0.5338460803031921	0.754874651810585	0.7054263565891473	0.6453900709219859	0.674074074074074	0.7355390721582407	0.47948164383137604	0.3285	2185.865	273.994	7.5e-06	3.0	810
prajjwal1/bert-tiny	5	3	3e-05	0.5296080708503723	0.7590529247910863	0.7137254901960784	0.6453900709219859	0.6778398510242086	0.7389794391307177	0.4877505258274762	0.3632	1976.954	247.808	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
prajjwal1/bert-tiny	5	3	3e-05	12.7605	676.149	84.636	1070484588000.0	0.5672532152246546	0.0	4.0	1080

2023-08-18 01:00:46,466 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-18 01:00:46,466 - INFO - **TRACE** Appending...0.6067732572555542
2023-08-18 01:00:46,466 - INFO - **TRACE** Appending...0.5560780763626099
2023-08-18 01:00:46,466 - INFO - **TRACE** Appending...0.5338460803031921
2023-08-18 01:00:46,466 - INFO - **TRACE** Appending...0.5296080708503723
2023-08-18 01:00:46,466 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.5296080708503723 >= 0.4765626788139343 LR: 3e-05
2023-08-18 01:00:46,466 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-18 01:00:46,466 - INFO - -----------------------------------
2023-08-18 01:00:46,466 - INFO - -----------------------------------
2023-08-18 01:00:46,466 - INFO - **TRACE** All inner CVs complete for outer CV 5
2023-08-18 01:00:46,466 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.4765626788139343 with learning rate: 3e-05
2023-08-18 01:00:46,466 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-18 01:00:46,466 - INFO - **TRACE** Loading the best model from inner CV
2023-08-18 01:00:46,546 - INFO - **TRACE** Running predictions with test data
2023-08-18 01:00:47,007 - INFO - Metrics from the Predictions...
2023-08-18 01:00:47,007 - INFO - {'test_loss': 0.4881008565425873, 'test_accuracy': 0.7961672473867596, 'test_precision': 0.7268041237113402, 'test_recall': 0.6878048780487804, 'test_f1': 0.7067669172932332, 'test_roc_auc': 0.7720867208672086, 'test_matthews_correlation': 0.5512324714634538, 'test_runtime': 0.2791, 'test_samples_per_second': 2056.613, 'test_steps_per_second': 257.972}
2023-08-18 01:00:47,007 - INFO - {'confusion_matrix': array([[316,  53],
       [ 64, 141]])}
2023-08-18 01:00:47,007 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
prajjwal1/bert-tiny	5	0.4881008565425873	0.7961672473867596	0.7268041237113402	0.6878048780487804	0.7067669172932332	0.7720867208672086	0.5512324714634538	0.2791	2056.613	257.972
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
prajjwal1/bert-tiny	5	[[316  53]
 [ 64 141]]

2023-08-18 01:00:47,007 - INFO - ----------------------------------------------------------------------
2023-08-18 01:00:47,007 - INFO - ----------------------------------------------------------------------
2023-08-18 01:00:47,007 - INFO - **TRACE** All CVs complete, calculating mean of test metrics
2023-08-18 01:00:47,008 - INFO - 

Results as of 202308-18_00-5430 for prajjwal1/bert-tiny
***** Mean Test(predict) metrics *****
model	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
prajjwal1/bert-tiny	0.496948704123497	0.7715351209412714	0.7012135631797584	0.6266279895808666	0.661573216580357	0.7393381897170673	0.4919783716220408	0.29434999999999995	1955.2186666666666	244.90216666666666
***** Mean Confusion Matrix(predict) *****
model	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
prajjwal1/bert-tiny	314.8333333333333	54.666666666666664	76.66666666666667	128.66666666666666

2023-08-18 01:00:47,008 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 01:00:47,045 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 01:00:47,045 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 01:00:47,045 - INFO - The path /notebooks/test_trainer does not exist.
