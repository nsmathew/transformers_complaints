2023-08-18 08:34:49,314 - INFO - Starting cross-domain experiments for model: vinai/bertweet-base and learning rate: 3e-05
2023-08-18 08:34:49,315 - INFO - Training Params - NO_OF_EPOCHS: 4 CROSSDOMAIN_CV: 3 MAX_LENGTH: 50 LR: 3e-05 SEED: 2023

2023-08-18 08:34:49,315 - INFO - ********************************************************************************************************************************************
2023-08-18 08:34:49,315 - INFO - TRAIN DOMAIN: food
2023-08-18 08:34:49,437 - INFO - Overall data count for train and dev: 127
2023-08-18 08:34:49,438 - INFO - **********************************************************************
2023-08-18 08:34:49,438 - INFO - Iteration number: 0 for TRAIN DOMAIN: food
2023-08-18 08:34:49,438 - INFO - Tokenizing the data...
2023-08-18 08:34:53,411 - INFO - TRAIN data count: 84 and DEV data count: 43
2023-08-18 08:34:53,411 - INFO - Finetune and perform evaluation...
2023-08-18 08:34:53,411 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:34:53,411 - INFO - Setting up training args and starting training...
2023-08-18 08:35:13,787 - INFO - Training complete...
2023-08-18 08:35:13,787 - INFO - TrainOutput(global_step=44, training_loss=0.47467903657393024, metrics={'train_runtime': 14.1836, 'train_samples_per_second': 23.689, 'train_steps_per_second': 3.102, 'total_flos': 8633331504000.0, 'train_loss': 0.47467903657393024, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:35:13,787 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:35:14,595 - INFO - Report evaluation results...
2023-08-18 08:35:14,595 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	food	na	0	3e-05	0.5557730197906494	0.7209302325581395	0.7209302325581395	1.0	0.8378378378378378	0.5	0.0	0.099	434.341	60.606	2.25e-05	1.0	11
vinai/bertweet-base	food	na	0	3e-05	0.5367576479911804	0.7209302325581395	0.7209302325581395	1.0	0.8378378378378378	0.5	0.0	0.0946	454.38	63.402	1.5e-05	2.0	22
vinai/bertweet-base	food	na	0	3e-05	0.5271244049072266	0.7674418604651163	0.7692307692307693	0.967741935483871	0.8571428571428572	0.6088709677419355	0.3362414499360346	0.0991	434.102	60.572	7.5e-06	3.0	33
vinai/bertweet-base	food	na	0	3e-05	0.5259707570075989	0.7906976744186046	0.7894736842105263	0.967741935483871	0.8695652173913043	0.6505376344086022	0.4212789431414202	0.0987	435.662	60.79	0.0	4.0	44
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	food	na	0	3e-05	14.1836	23.689	3.102	8633331504000.0	0.47467903657393024	0.0	4.0	44

2023-08-18 08:35:14,595 - INFO - Loading the finetuned model
2023-08-18 08:35:15,537 - INFO - ***********************************
2023-08-18 08:35:15,538 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: food
2023-08-18 08:35:15,538 - INFO - Train and test domains are the same: food, hence skipping
2023-08-18 08:35:15,538 - INFO - ***********************************
2023-08-18 08:35:15,538 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: apparel
2023-08-18 08:35:15,580 - INFO - TEST data count: 262
2023-08-18 08:35:16,770 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:17,480 - INFO - Metrics from the Predictions...
2023-08-18 08:35:17,480 - INFO - {'test_loss': 0.7583327889442444, 'test_accuracy': 0.5877862595419847, 'test_precision': 0.5787234042553191, 'test_recall': 0.9379310344827586, 'test_f1': 0.7157894736842104, 'test_roc_auc': 0.5458885941644562, 'test_matthews_correlation': 0.15007068585520716, 'test_runtime': 0.4712, 'test_samples_per_second': 556.085, 'test_steps_per_second': 70.041}
2023-08-18 08:35:17,480 - INFO - {'confusion_matrix': array([[ 18,  99],
       [  9, 136]])}
2023-08-18 08:35:17,480 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	apparel	0	3e-05	0.7583327889442444	0.5877862595419847	0.5787234042553191	0.9379310344827586	0.7157894736842104	0.5458885941644562	0.15007068585520716	0.4712	556.085	70.041
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	apparel	0	3e-05	[[ 18  99]
 [  9 136]]

2023-08-18 08:35:17,480 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:35:17,480 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:17,480 - INFO - ***********************************
2023-08-18 08:35:17,480 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: cars
2023-08-18 08:35:17,522 - INFO - TEST data count: 93
2023-08-18 08:35:18,635 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:19,000 - INFO - Metrics from the Predictions...
2023-08-18 08:35:19,000 - INFO - {'test_loss': 0.5294099450111389, 'test_accuracy': 0.7526881720430108, 'test_precision': 0.7586206896551724, 'test_recall': 0.9705882352941176, 'test_f1': 0.8516129032258065, 'test_roc_auc': 0.5652941176470588, 'test_matthews_correlation': 0.23566400946043833, 'test_runtime': 0.1862, 'test_samples_per_second': 499.569, 'test_steps_per_second': 64.461}
2023-08-18 08:35:19,000 - INFO - {'confusion_matrix': array([[ 4, 21],
       [ 2, 66]])}
2023-08-18 08:35:19,001 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	cars	0	3e-05	0.5294099450111389	0.7526881720430108	0.7586206896551724	0.9705882352941176	0.8516129032258065	0.5652941176470588	0.23566400946043833	0.1862	499.569	64.461
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	cars	0	3e-05	[[ 4 21]
 [ 2 66]]

2023-08-18 08:35:19,001 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: cars iteration: 0
2023-08-18 08:35:19,001 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:19,001 - INFO - ***********************************
2023-08-18 08:35:19,001 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: retail
2023-08-18 08:35:19,051 - INFO - TEST data count: 197
2023-08-18 08:35:20,163 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:20,670 - INFO - Metrics from the Predictions...
2023-08-18 08:35:20,670 - INFO - {'test_loss': 0.6503923535346985, 'test_accuracy': 0.6802030456852792, 'test_precision': 0.6612021857923497, 'test_recall': 0.9918032786885246, 'test_f1': 0.7934426229508196, 'test_roc_auc': 0.5825683060109289, 'test_matthews_correlation': 0.31207886268685375, 'test_runtime': 0.3476, 'test_samples_per_second': 566.752, 'test_steps_per_second': 71.923}
2023-08-18 08:35:20,670 - INFO - {'confusion_matrix': array([[ 13,  62],
       [  1, 121]])}
2023-08-18 08:35:20,670 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	retail	0	3e-05	0.6503923535346985	0.6802030456852792	0.6612021857923497	0.9918032786885246	0.7934426229508196	0.5825683060109289	0.31207886268685375	0.3476	566.752	71.923
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	retail	0	3e-05	[[ 13  62]
 [  1 121]]

2023-08-18 08:35:20,670 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: retail iteration: 0
2023-08-18 08:35:20,670 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:20,670 - INFO - ***********************************
2023-08-18 08:35:20,670 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: services
2023-08-18 08:35:20,735 - INFO - TEST data count: 335
2023-08-18 08:35:21,905 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:27,662 - INFO - Metrics from the Predictions...
2023-08-18 08:35:27,662 - INFO - {'test_loss': 0.6428893804550171, 'test_accuracy': 0.6746268656716418, 'test_precision': 0.6610169491525424, 'test_recall': 0.9558823529411765, 'test_f1': 0.781563126252505, 'test_roc_auc': 0.5962617871576111, 'test_matthews_correlation': 0.2897301184082628, 'test_runtime': 0.5712, 'test_samples_per_second': 586.528, 'test_steps_per_second': 73.535}
2023-08-18 08:35:27,662 - INFO - {'confusion_matrix': array([[ 31, 100],
       [  9, 195]])}
2023-08-18 08:35:27,662 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	services	0	3e-05	0.6428893804550171	0.6746268656716418	0.6610169491525424	0.9558823529411765	0.781563126252505	0.5962617871576111	0.2897301184082628	0.5712	586.528	73.535
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	services	0	3e-05	[[ 31 100]
 [  9 195]]

2023-08-18 08:35:27,662 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: services iteration: 0
2023-08-18 08:35:27,662 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:27,662 - INFO - ***********************************
2023-08-18 08:35:27,662 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: software
2023-08-18 08:35:27,701 - INFO - TEST data count: 295
2023-08-18 08:35:28,869 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:29,605 - INFO - Metrics from the Predictions...
2023-08-18 08:35:29,605 - INFO - {'test_loss': 0.5961282849311829, 'test_accuracy': 0.711864406779661, 'test_precision': 0.7034220532319392, 'test_recall': 0.9635416666666666, 'test_f1': 0.8131868131868133, 'test_roc_auc': 0.6031300566343042, 'test_matthews_correlation': 0.316177976142787, 'test_runtime': 0.508, 'test_samples_per_second': 580.757, 'test_steps_per_second': 72.841}
2023-08-18 08:35:29,605 - INFO - {'confusion_matrix': array([[ 25,  78],
       [  7, 185]])}
2023-08-18 08:35:29,605 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	software	0	3e-05	0.5961282849311829	0.711864406779661	0.7034220532319392	0.9635416666666666	0.8131868131868133	0.6031300566343042	0.316177976142787	0.508	580.757	72.841
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	software	0	3e-05	[[ 25  78]
 [  7 185]]

2023-08-18 08:35:29,605 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: software iteration: 0
2023-08-18 08:35:29,605 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:29,605 - INFO - ***********************************
2023-08-18 08:35:29,605 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: transport
2023-08-18 08:35:34,648 - INFO - TEST data count: 247
2023-08-18 08:35:37,795 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:38,441 - INFO - Metrics from the Predictions...
2023-08-18 08:35:38,441 - INFO - {'test_loss': 0.7669835686683655, 'test_accuracy': 0.5951417004048583, 'test_precision': 0.5871559633027523, 'test_recall': 0.927536231884058, 'test_f1': 0.7191011235955056, 'test_roc_auc': 0.5509240792447813, 'test_matthews_correlation': 0.1571009196566882, 'test_runtime': 0.4484, 'test_samples_per_second': 550.791, 'test_steps_per_second': 69.128}
2023-08-18 08:35:38,441 - INFO - {'confusion_matrix': array([[ 19,  90],
       [ 10, 128]])}
2023-08-18 08:35:38,441 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	transport	0	3e-05	0.7669835686683655	0.5951417004048583	0.5871559633027523	0.927536231884058	0.7191011235955056	0.5509240792447813	0.1571009196566882	0.4484	550.791	69.128
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	transport	0	3e-05	[[ 19  90]
 [ 10 128]]

2023-08-18 08:35:38,441 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: transport iteration: 0
2023-08-18 08:35:38,441 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:38,441 - INFO - ***********************************
2023-08-18 08:35:38,441 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: electronics
2023-08-18 08:35:38,488 - INFO - TEST data count: 290
2023-08-18 08:35:39,648 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:40,328 - INFO - Metrics from the Predictions...
2023-08-18 08:35:40,328 - INFO - {'test_loss': 0.6188067197799683, 'test_accuracy': 0.6655172413793103, 'test_precision': 0.6536964980544747, 'test_recall': 0.9545454545454546, 'test_f1': 0.7759815242494227, 'test_roc_auc': 0.5869218500797448, 'test_matthews_correlation': 0.2673893989890008, 'test_runtime': 0.5106, 'test_samples_per_second': 567.997, 'test_steps_per_second': 72.469}
2023-08-18 08:35:40,328 - INFO - {'confusion_matrix': array([[ 25,  89],
       [  8, 168]])}
2023-08-18 08:35:40,328 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	electronics	0	3e-05	0.6188067197799683	0.6655172413793103	0.6536964980544747	0.9545454545454546	0.7759815242494227	0.5869218500797448	0.2673893989890008	0.5106	567.997	72.469
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	electronics	0	3e-05	[[ 25  89]
 [  8 168]]

2023-08-18 08:35:40,328 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:35:40,328 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:40,329 - INFO - ***********************************
2023-08-18 08:35:40,329 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: other
2023-08-18 08:35:40,374 - INFO - TEST data count: 128
2023-08-18 08:35:41,528 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:35:41,938 - INFO - Metrics from the Predictions...
2023-08-18 08:35:41,939 - INFO - {'test_loss': 0.537261962890625, 'test_accuracy': 0.7578125, 'test_precision': 0.753968253968254, 'test_recall': 1.0, 'test_f1': 0.8597285067873303, 'test_roc_auc': 0.5303030303030303, 'test_matthews_correlation': 0.21376399531971163, 'test_runtime': 0.2573, 'test_samples_per_second': 497.501, 'test_steps_per_second': 62.188}
2023-08-18 08:35:41,939 - INFO - {'confusion_matrix': array([[ 2, 31],
       [ 0, 95]])}
2023-08-18 08:35:41,939 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	other	0	3e-05	0.537261962890625	0.7578125	0.753968253968254	1.0	0.8597285067873303	0.5303030303030303	0.21376399531971163	0.2573	497.501	62.188
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	other	0	3e-05	[[ 2 31]
 [ 0 95]]

2023-08-18 08:35:41,939 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: other iteration: 0
2023-08-18 08:35:41,939 - INFO - ----------------------------------------------------------------------
2023-08-18 08:35:41,939 - INFO - **********************************************************************
2023-08-18 08:35:41,939 - INFO - Iteration number: 1 for TRAIN DOMAIN: food
2023-08-18 08:35:41,939 - INFO - Tokenizing the data...
2023-08-18 08:35:48,784 - INFO - TRAIN data count: 85 and DEV data count: 42
2023-08-18 08:35:48,785 - INFO - Finetune and perform evaluation...
2023-08-18 08:35:48,785 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:35:48,785 - INFO - Setting up training args and starting training...
2023-08-18 08:36:06,099 - INFO - Training complete...
2023-08-18 08:36:06,100 - INFO - TrainOutput(global_step=44, training_loss=0.5409736199812456, metrics={'train_runtime': 15.663, 'train_samples_per_second': 21.707, 'train_steps_per_second': 2.809, 'total_flos': 8736109260000.0, 'train_loss': 0.5409736199812456, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:36:06,100 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:36:07,115 - INFO - Report evaluation results...
2023-08-18 08:36:07,116 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	food	na	1	3e-05	0.5384756326675415	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0968	434.067	62.01	2.25e-05	1.0	11
vinai/bertweet-base	food	na	1	3e-05	0.5119689106941223	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0975	430.757	61.537	1.5e-05	2.0	22
vinai/bertweet-base	food	na	1	3e-05	0.48457518219947815	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0999	420.303	60.043	7.5e-06	3.0	33
vinai/bertweet-base	food	na	1	3e-05	0.4755496382713318	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0936	448.498	64.071	0.0	4.0	44
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	food	na	1	3e-05	15.663	21.707	2.809	8736109260000.0	0.5409736199812456	0.0	4.0	44

2023-08-18 08:36:07,116 - INFO - Loading the finetuned model
2023-08-18 08:36:08,072 - INFO - ***********************************
2023-08-18 08:36:08,072 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: food
2023-08-18 08:36:08,072 - INFO - Train and test domains are the same: food, hence skipping
2023-08-18 08:36:08,072 - INFO - ***********************************
2023-08-18 08:36:08,072 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: apparel
2023-08-18 08:36:08,121 - INFO - TEST data count: 262
2023-08-18 08:36:09,297 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:10,192 - INFO - Metrics from the Predictions...
2023-08-18 08:36:10,192 - INFO - {'test_loss': 0.7598229050636292, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4578, 'test_samples_per_second': 572.254, 'test_steps_per_second': 72.078}
2023-08-18 08:36:10,192 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:36:10,193 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	apparel	1	3e-05	0.7598229050636292	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.4578	572.254	72.078
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	apparel	1	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:36:10,193 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:36:10,193 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:10,193 - INFO - ***********************************
2023-08-18 08:36:10,193 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: cars
2023-08-18 08:36:10,233 - INFO - TEST data count: 93
2023-08-18 08:36:12,563 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:12,904 - INFO - Metrics from the Predictions...
2023-08-18 08:36:12,904 - INFO - {'test_loss': 0.5368543267250061, 'test_accuracy': 0.7311827956989247, 'test_precision': 0.7311827956989247, 'test_recall': 1.0, 'test_f1': 0.84472049689441, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.1822, 'test_samples_per_second': 510.433, 'test_steps_per_second': 65.862}
2023-08-18 08:36:12,904 - INFO - {'confusion_matrix': array([[ 0, 25],
       [ 0, 68]])}
2023-08-18 08:36:12,904 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	cars	1	3e-05	0.5368543267250061	0.7311827956989247	0.7311827956989247	1.0	0.84472049689441	0.5	0.0	0.1822	510.433	65.862
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	cars	1	3e-05	[[ 0 25]
 [ 0 68]]

2023-08-18 08:36:12,904 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: cars iteration: 1
2023-08-18 08:36:12,904 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:12,904 - INFO - ***********************************
2023-08-18 08:36:12,904 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: retail
2023-08-18 08:36:12,954 - INFO - TEST data count: 197
2023-08-18 08:36:14,129 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:14,729 - INFO - Metrics from the Predictions...
2023-08-18 08:36:14,729 - INFO - {'test_loss': 0.672709047794342, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4264, 'test_samples_per_second': 461.959, 'test_steps_per_second': 58.624}
2023-08-18 08:36:14,729 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:36:14,729 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	retail	1	3e-05	0.672709047794342	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.4264	461.959	58.624
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	retail	1	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:36:14,729 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: retail iteration: 1
2023-08-18 08:36:14,729 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:14,729 - INFO - ***********************************
2023-08-18 08:36:14,729 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: services
2023-08-18 08:36:14,769 - INFO - TEST data count: 335
2023-08-18 08:36:15,941 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:16,696 - INFO - Metrics from the Predictions...
2023-08-18 08:36:16,696 - INFO - {'test_loss': 0.6632044315338135, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.595, 'test_samples_per_second': 562.995, 'test_steps_per_second': 70.584}
2023-08-18 08:36:16,696 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:36:16,696 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	services	1	3e-05	0.6632044315338135	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.595	562.995	70.584
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	services	1	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:36:16,696 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: services iteration: 1
2023-08-18 08:36:16,696 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:16,696 - INFO - ***********************************
2023-08-18 08:36:16,696 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: software
2023-08-18 08:36:16,733 - INFO - TEST data count: 295
2023-08-18 08:36:23,458 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:24,157 - INFO - Metrics from the Predictions...
2023-08-18 08:36:24,157 - INFO - {'test_loss': 0.6235044598579407, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5264, 'test_samples_per_second': 560.411, 'test_steps_per_second': 70.289}
2023-08-18 08:36:24,157 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:36:24,157 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	software	1	3e-05	0.6235044598579407	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5264	560.411	70.289
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	software	1	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:36:24,157 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: software iteration: 1
2023-08-18 08:36:24,157 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:24,157 - INFO - ***********************************
2023-08-18 08:36:24,157 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: transport
2023-08-18 08:36:24,218 - INFO - TEST data count: 247
2023-08-18 08:36:25,349 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:25,958 - INFO - Metrics from the Predictions...
2023-08-18 08:36:25,958 - INFO - {'test_loss': 0.7610257267951965, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.441, 'test_samples_per_second': 560.073, 'test_steps_per_second': 70.293}
2023-08-18 08:36:25,959 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:36:25,959 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	transport	1	3e-05	0.7610257267951965	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.441	560.073	70.293
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	transport	1	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:36:25,959 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: transport iteration: 1
2023-08-18 08:36:25,959 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:25,959 - INFO - ***********************************
2023-08-18 08:36:25,959 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: electronics
2023-08-18 08:36:26,001 - INFO - TEST data count: 290
2023-08-18 08:36:27,197 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:27,868 - INFO - Metrics from the Predictions...
2023-08-18 08:36:27,868 - INFO - {'test_loss': 0.6582531332969666, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5157, 'test_samples_per_second': 562.367, 'test_steps_per_second': 71.75}
2023-08-18 08:36:27,868 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:36:27,868 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	electronics	1	3e-05	0.6582531332969666	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5157	562.367	71.75
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	electronics	1	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:36:27,868 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:36:27,868 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:27,868 - INFO - ***********************************
2023-08-18 08:36:27,868 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: other
2023-08-18 08:36:27,910 - INFO - TEST data count: 128
2023-08-18 08:36:29,027 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:29,431 - INFO - Metrics from the Predictions...
2023-08-18 08:36:29,431 - INFO - {'test_loss': 0.5587641000747681, 'test_accuracy': 0.7421875, 'test_precision': 0.7421875, 'test_recall': 1.0, 'test_f1': 0.852017937219731, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2453, 'test_samples_per_second': 521.764, 'test_steps_per_second': 65.221}
2023-08-18 08:36:29,431 - INFO - {'confusion_matrix': array([[ 0, 33],
       [ 0, 95]])}
2023-08-18 08:36:29,431 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	other	1	3e-05	0.5587641000747681	0.7421875	0.7421875	1.0	0.852017937219731	0.5	0.0	0.2453	521.764	65.221
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	other	1	3e-05	[[ 0 33]
 [ 0 95]]

2023-08-18 08:36:29,431 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: other iteration: 1
2023-08-18 08:36:29,431 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:29,431 - INFO - **********************************************************************
2023-08-18 08:36:29,431 - INFO - Iteration number: 2 for TRAIN DOMAIN: food
2023-08-18 08:36:29,431 - INFO - Tokenizing the data...
2023-08-18 08:36:31,255 - INFO - TRAIN data count: 85 and DEV data count: 42
2023-08-18 08:36:31,255 - INFO - Finetune and perform evaluation...
2023-08-18 08:36:31,255 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:36:31,255 - INFO - Setting up training args and starting training...
2023-08-18 08:36:46,873 - INFO - Training complete...
2023-08-18 08:36:46,874 - INFO - TrainOutput(global_step=44, training_loss=0.5689126361500133, metrics={'train_runtime': 14.2819, 'train_samples_per_second': 23.806, 'train_steps_per_second': 3.081, 'total_flos': 8736109260000.0, 'train_loss': 0.5689126361500133, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:36:46,874 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:36:47,784 - INFO - Report evaluation results...
2023-08-18 08:36:47,785 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	food	na	2	3e-05	0.5474415421485901	0.7142857142857143	0.7142857142857143	1.0	0.8333333333333333	0.5	0.0	0.0943	445.463	63.638	2.25e-05	1.0	11
vinai/bertweet-base	food	na	2	3e-05	0.5511329770088196	0.7142857142857143	0.7142857142857143	1.0	0.8333333333333333	0.5	0.0	0.0975	430.982	61.569	1.5e-05	2.0	22
vinai/bertweet-base	food	na	2	3e-05	0.5553961992263794	0.7142857142857143	0.7142857142857143	1.0	0.8333333333333333	0.5	0.0	0.1025	409.613	58.516	7.5e-06	3.0	33
vinai/bertweet-base	food	na	2	3e-05	0.550905704498291	0.7142857142857143	0.7142857142857143	1.0	0.8333333333333333	0.5	0.0	0.0912	460.716	65.817	0.0	4.0	44
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	food	na	2	3e-05	14.2819	23.806	3.081	8736109260000.0	0.5689126361500133	0.0	4.0	44

2023-08-18 08:36:47,785 - INFO - Loading the finetuned model
2023-08-18 08:36:48,927 - INFO - ***********************************
2023-08-18 08:36:48,927 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: food
2023-08-18 08:36:48,927 - INFO - Train and test domains are the same: food, hence skipping
2023-08-18 08:36:48,927 - INFO - ***********************************
2023-08-18 08:36:48,927 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: apparel
2023-08-18 08:36:48,969 - INFO - TEST data count: 262
2023-08-18 08:36:50,265 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:50,961 - INFO - Metrics from the Predictions...
2023-08-18 08:36:50,961 - INFO - {'test_loss': 0.7856162190437317, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4646, 'test_samples_per_second': 563.87, 'test_steps_per_second': 71.022}
2023-08-18 08:36:50,961 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:36:50,961 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	apparel	2	3e-05	0.7856162190437317	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.4646	563.87	71.022
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	apparel	2	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:36:50,961 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:36:50,961 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:50,961 - INFO - ***********************************
2023-08-18 08:36:50,961 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: cars
2023-08-18 08:36:51,001 - INFO - TEST data count: 93
2023-08-18 08:36:53,237 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:53,670 - INFO - Metrics from the Predictions...
2023-08-18 08:36:53,670 - INFO - {'test_loss': 0.5663992166519165, 'test_accuracy': 0.7311827956989247, 'test_precision': 0.7311827956989247, 'test_recall': 1.0, 'test_f1': 0.84472049689441, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.1917, 'test_samples_per_second': 485.07, 'test_steps_per_second': 62.59}
2023-08-18 08:36:53,670 - INFO - {'confusion_matrix': array([[ 0, 25],
       [ 0, 68]])}
2023-08-18 08:36:53,671 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	cars	2	3e-05	0.5663992166519165	0.7311827956989247	0.7311827956989247	1.0	0.84472049689441	0.5	0.0	0.1917	485.07	62.59
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	cars	2	3e-05	[[ 0 25]
 [ 0 68]]

2023-08-18 08:36:53,671 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: cars iteration: 2
2023-08-18 08:36:53,671 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:53,671 - INFO - ***********************************
2023-08-18 08:36:53,671 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: retail
2023-08-18 08:36:53,729 - INFO - TEST data count: 197
2023-08-18 08:36:55,258 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:36:55,792 - INFO - Metrics from the Predictions...
2023-08-18 08:36:55,792 - INFO - {'test_loss': 0.7024291157722473, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.3633, 'test_samples_per_second': 542.177, 'test_steps_per_second': 68.804}
2023-08-18 08:36:55,792 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:36:55,793 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	retail	2	3e-05	0.7024291157722473	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3633	542.177	68.804
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	retail	2	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:36:55,793 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: retail iteration: 2
2023-08-18 08:36:55,793 - INFO - ----------------------------------------------------------------------
2023-08-18 08:36:55,793 - INFO - ***********************************
2023-08-18 08:36:55,793 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: services
2023-08-18 08:36:55,840 - INFO - TEST data count: 335
2023-08-18 08:36:57,021 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:02,909 - INFO - Metrics from the Predictions...
2023-08-18 08:37:02,909 - INFO - {'test_loss': 0.7047469615936279, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.6012, 'test_samples_per_second': 557.173, 'test_steps_per_second': 69.855}
2023-08-18 08:37:02,909 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:37:02,909 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	services	2	3e-05	0.7047469615936279	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.6012	557.173	69.855
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	services	2	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:37:02,909 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: services iteration: 2
2023-08-18 08:37:02,909 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:02,909 - INFO - ***********************************
2023-08-18 08:37:02,909 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: software
2023-08-18 08:37:02,953 - INFO - TEST data count: 295
2023-08-18 08:37:04,327 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:05,030 - INFO - Metrics from the Predictions...
2023-08-18 08:37:05,030 - INFO - {'test_loss': 0.6551344990730286, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5324, 'test_samples_per_second': 554.141, 'test_steps_per_second': 69.502}
2023-08-18 08:37:05,030 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:37:05,030 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	software	2	3e-05	0.6551344990730286	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5324	554.141	69.502
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	software	2	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:37:05,030 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: software iteration: 2
2023-08-18 08:37:05,030 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:05,031 - INFO - ***********************************
2023-08-18 08:37:05,031 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: transport
2023-08-18 08:37:05,118 - INFO - TEST data count: 247
2023-08-18 08:37:06,296 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:06,898 - INFO - Metrics from the Predictions...
2023-08-18 08:37:06,899 - INFO - {'test_loss': 0.7803347706794739, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4488, 'test_samples_per_second': 550.341, 'test_steps_per_second': 69.071}
2023-08-18 08:37:06,899 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:37:06,899 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	transport	2	3e-05	0.7803347706794739	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4488	550.341	69.071
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	transport	2	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:37:06,899 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: transport iteration: 2
2023-08-18 08:37:06,899 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:06,899 - INFO - ***********************************
2023-08-18 08:37:06,899 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: electronics
2023-08-18 08:37:06,934 - INFO - TEST data count: 290
2023-08-18 08:37:08,079 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:08,776 - INFO - Metrics from the Predictions...
2023-08-18 08:37:08,776 - INFO - {'test_loss': 0.7046915888786316, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5108, 'test_samples_per_second': 567.755, 'test_steps_per_second': 72.438}
2023-08-18 08:37:08,776 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:37:08,777 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	electronics	2	3e-05	0.7046915888786316	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5108	567.755	72.438
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	electronics	2	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:37:08,777 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:37:08,777 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:08,777 - INFO - ***********************************
2023-08-18 08:37:08,777 - INFO - For TRAIN domain: food now testing with TEST DOMAIN: other
2023-08-18 08:37:08,815 - INFO - TEST data count: 128
2023-08-18 08:37:10,727 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:11,258 - INFO - Metrics from the Predictions...
2023-08-18 08:37:11,258 - INFO - {'test_loss': 0.5624930262565613, 'test_accuracy': 0.7421875, 'test_precision': 0.7421875, 'test_recall': 1.0, 'test_f1': 0.852017937219731, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2408, 'test_samples_per_second': 531.531, 'test_steps_per_second': 66.441}
2023-08-18 08:37:11,258 - INFO - {'confusion_matrix': array([[ 0, 33],
       [ 0, 95]])}
2023-08-18 08:37:11,258 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	food	other	2	3e-05	0.5624930262565613	0.7421875	0.7421875	1.0	0.852017937219731	0.5	0.0	0.2408	531.531	66.441
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	food	other	2	3e-05	[[ 0 33]
 [ 0 95]]

2023-08-18 08:37:11,258 - INFO - Finished testing for TRAIN DOMAIN: food and TEST DOMAIN: other iteration: 2
2023-08-18 08:37:11,258 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:11,258 - INFO - Finished all iterations and all testing for TRAIN domain: food
2023-08-18 08:37:11,258 - INFO - Calculating mean of test metrics for TRAIN domain: food
2023-08-18 08:37:11,259 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	apparel	2	3e-05	0.7679239710172018	0.564885496183206	0.5618645444209842	0.9793103448275863	0.7136169662485452	0.5152961980548187	0.05002356195173572	0.4645333333333334	564.0696666666666	71.04700000000001
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	apparel	2	3e-05	6.0	111.0	3.0	142.0

2023-08-18 08:37:11,259 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	cars	2	3e-05	0.5442211627960205	0.7383512544802867	0.7403287603510073	0.9901960784313726	0.8470179656715423	0.521764705882353	0.07855466982014611	0.1867	498.3573333333333	64.30433333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	cars	2	3e-05	1.3333333333333333	23.666666666666668	0.6666666666666666	67.33333333333333

2023-08-18 08:37:11,260 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	retail	2	3e-05	0.6751768390337626	0.6395939086294415	0.6332602886651317	0.9972677595628415	0.7744077290713808	0.5275227686703096	0.10402628756228459	0.3791	523.6293333333333	66.45033333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	retail	2	3e-05	4.333333333333333	70.66666666666667	0.3333333333333333	121.66666666666667

2023-08-18 08:37:11,260 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	services	2	3e-05	0.6702802578608195	0.6308457711442785	0.6263091323045789	0.9852941176470589	0.7651592610081015	0.5320872623858705	0.0965767061360876	0.5891333333333333	568.8986666666667	71.32466666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	services	2	3e-05	10.333333333333334	120.66666666666667	3.0	201.0

2023-08-18 08:37:11,260 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	software	2	3e-05	0.6249224146207174	0.6711864406779661	0.6683723228287254	0.9878472222222222	0.7967296221916346	0.534376685544768	0.10539265871426233	0.5222666666666667	565.103	70.87733333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	software	2	3e-05	8.333333333333334	94.66666666666667	2.3333333333333335	189.66666666666666

2023-08-18 08:37:11,260 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	transport	2	3e-05	0.7694480220476786	0.5708502024291499	0.5681882900617813	0.9758454106280193	0.7176224524539131	0.5169746930815937	0.05236697321889607	0.44606666666666667	553.735	69.49733333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	transport	2	3e-05	6.333333333333333	102.66666666666667	3.3333333333333335	134.66666666666666

2023-08-18 08:37:11,261 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	electronics	2	3e-05	0.6605838139851888	0.6264367816091955	0.6224965338342502	0.9848484848484849	0.7622370459944428	0.5289739500265817	0.08912979966300028	0.5123666666666667	566.0396666666667	72.219
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	electronics	2	3e-05	8.333333333333334	105.66666666666667	2.6666666666666665	173.33333333333334

2023-08-18 08:37:11,261 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	food	other	2	3e-05	0.5528396964073181	0.7473958333333334	0.746114417989418	1.0	0.8545881270755974	0.51010101010101	0.07125466510657054	0.2478	516.9319999999999	64.61666666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	food	other	2	3e-05	0.6666666666666666	32.333333333333336	0.0	95.0

2023-08-18 08:37:11,261 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:37:11,428 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:37:11,428 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:37:11,428 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:37:11,428 - INFO - ********************************************************************************************************************************************
2023-08-18 08:37:11,428 - INFO - TRAIN DOMAIN: apparel
2023-08-18 08:37:11,492 - INFO - Overall data count for train and dev: 262
2023-08-18 08:37:11,492 - INFO - **********************************************************************
2023-08-18 08:37:11,492 - INFO - Iteration number: 0 for TRAIN DOMAIN: apparel
2023-08-18 08:37:11,492 - INFO - Tokenizing the data...
2023-08-18 08:37:13,426 - INFO - TRAIN data count: 174 and DEV data count: 88
2023-08-18 08:37:13,426 - INFO - Finetune and perform evaluation...
2023-08-18 08:37:13,426 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:37:13,426 - INFO - Setting up training args and starting training...
2023-08-18 08:37:33,027 - INFO - Training complete...
2023-08-18 08:37:33,028 - INFO - TrainOutput(global_step=88, training_loss=0.41410099376331677, metrics={'train_runtime': 17.8445, 'train_samples_per_second': 39.004, 'train_steps_per_second': 4.931, 'total_flos': 17883329544000.0, 'train_loss': 0.41410099376331677, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:37:33,028 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:37:33,923 - INFO - Report evaluation results...
2023-08-18 08:37:33,923 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	apparel	na	0	3e-05	0.6196602582931519	0.625	0.5975609756097561	1.0	0.748091603053435	0.5769230769230769	0.303203657276947	0.1665	528.511	66.064	2.25e-05	1.0	22
vinai/bertweet-base	apparel	na	0	3e-05	0.44444912672042847	0.8409090909090909	0.8431372549019608	0.8775510204081632	0.86	0.836211407639979	0.6766854431681134	0.1705	516.024	64.503	1.5e-05	2.0	44
vinai/bertweet-base	apparel	na	0	3e-05	0.4569910168647766	0.8181818181818182	0.8	0.8979591836734694	0.8461538461538463	0.8079539508110937	0.6319865048116812	0.1724	510.586	63.823	7.5e-06	3.0	66
vinai/bertweet-base	apparel	na	0	3e-05	0.3816985785961151	0.8295454545454546	0.8863636363636364	0.7959183673469388	0.8387096774193548	0.8338566195709053	0.6633880657639324	0.1685	522.202	65.275	0.0	4.0	88
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	apparel	na	0	3e-05	17.8445	39.004	4.931	17883329544000.0	0.41410099376331677	0.0	4.0	88

2023-08-18 08:37:33,923 - INFO - Loading the finetuned model
2023-08-18 08:37:34,898 - INFO - ***********************************
2023-08-18 08:37:34,898 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: food
2023-08-18 08:37:34,935 - INFO - TEST data count: 127
2023-08-18 08:37:36,148 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:36,619 - INFO - Metrics from the Predictions...
2023-08-18 08:37:36,619 - INFO - {'test_loss': 0.3774845600128174, 'test_accuracy': 0.84251968503937, 'test_precision': 0.9285714285714286, 'test_recall': 0.8478260869565217, 'test_f1': 0.8863636363636365, 'test_roc_auc': 0.8381987577639751, 'test_matthews_correlation': 0.638639930132682, 'test_runtime': 0.2333, 'test_samples_per_second': 544.428, 'test_steps_per_second': 68.589}
2023-08-18 08:37:36,619 - INFO - {'confusion_matrix': array([[29,  6],
       [14, 78]])}
2023-08-18 08:37:36,620 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	food	0	3e-05	0.3774845600128174	0.84251968503937	0.9285714285714286	0.8478260869565217	0.8863636363636365	0.8381987577639751	0.638639930132682	0.2333	544.428	68.589
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	food	0	3e-05	[[29  6]
 [14 78]]

2023-08-18 08:37:36,620 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: food iteration: 0
2023-08-18 08:37:36,620 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:36,620 - INFO - ***********************************
2023-08-18 08:37:36,620 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: apparel
2023-08-18 08:37:36,620 - INFO - Train and test domains are the same: apparel, hence skipping
2023-08-18 08:37:36,620 - INFO - ***********************************
2023-08-18 08:37:36,620 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: cars
2023-08-18 08:37:36,665 - INFO - TEST data count: 93
2023-08-18 08:37:37,769 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:38,108 - INFO - Metrics from the Predictions...
2023-08-18 08:37:38,108 - INFO - {'test_loss': 0.3977659344673157, 'test_accuracy': 0.8494623655913979, 'test_precision': 0.8857142857142857, 'test_recall': 0.9117647058823529, 'test_f1': 0.8985507246376812, 'test_roc_auc': 0.7958823529411764, 'test_matthews_correlation': 0.6080798074652584, 'test_runtime': 0.1898, 'test_samples_per_second': 490.043, 'test_steps_per_second': 63.231}
2023-08-18 08:37:38,108 - INFO - {'confusion_matrix': array([[17,  8],
       [ 6, 62]])}
2023-08-18 08:37:38,109 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	cars	0	3e-05	0.3977659344673157	0.8494623655913979	0.8857142857142857	0.9117647058823529	0.8985507246376812	0.7958823529411764	0.6080798074652584	0.1898	490.043	63.231
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	cars	0	3e-05	[[17  8]
 [ 6 62]]

2023-08-18 08:37:38,109 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: cars iteration: 0
2023-08-18 08:37:38,109 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:38,109 - INFO - ***********************************
2023-08-18 08:37:38,109 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: retail
2023-08-18 08:37:38,150 - INFO - TEST data count: 197
2023-08-18 08:37:45,311 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:45,838 - INFO - Metrics from the Predictions...
2023-08-18 08:37:45,838 - INFO - {'test_loss': 0.40742987394332886, 'test_accuracy': 0.8324873096446701, 'test_precision': 0.908256880733945, 'test_recall': 0.8114754098360656, 'test_f1': 0.8571428571428572, 'test_roc_auc': 0.8390710382513662, 'test_matthews_correlation': 0.6623333964197113, 'test_runtime': 0.3552, 'test_samples_per_second': 554.553, 'test_steps_per_second': 70.375}
2023-08-18 08:37:45,839 - INFO - {'confusion_matrix': array([[65, 10],
       [23, 99]])}
2023-08-18 08:37:45,839 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	retail	0	3e-05	0.40742987394332886	0.8324873096446701	0.908256880733945	0.8114754098360656	0.8571428571428572	0.8390710382513662	0.6623333964197113	0.3552	554.553	70.375
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	retail	0	3e-05	[[65 10]
 [23 99]]

2023-08-18 08:37:45,839 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: retail iteration: 0
2023-08-18 08:37:45,839 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:45,839 - INFO - ***********************************
2023-08-18 08:37:45,839 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: services
2023-08-18 08:37:45,876 - INFO - TEST data count: 335
2023-08-18 08:37:47,029 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:47,765 - INFO - Metrics from the Predictions...
2023-08-18 08:37:47,765 - INFO - {'test_loss': 0.42470771074295044, 'test_accuracy': 0.8238805970149253, 'test_precision': 0.8502415458937198, 'test_recall': 0.8627450980392157, 'test_f1': 0.8564476885644768, 'test_roc_auc': 0.8130519383325849, 'test_matthews_correlation': 0.6287919409195215, 'test_runtime': 0.5805, 'test_samples_per_second': 577.138, 'test_steps_per_second': 72.358}
2023-08-18 08:37:47,765 - INFO - {'confusion_matrix': array([[100,  31],
       [ 28, 176]])}
2023-08-18 08:37:47,766 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	services	0	3e-05	0.42470771074295044	0.8238805970149253	0.8502415458937198	0.8627450980392157	0.8564476885644768	0.8130519383325849	0.6287919409195215	0.5805	577.138	72.358
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	services	0	3e-05	[[100  31]
 [ 28 176]]

2023-08-18 08:37:47,766 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: services iteration: 0
2023-08-18 08:37:47,766 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:47,766 - INFO - ***********************************
2023-08-18 08:37:47,766 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: software
2023-08-18 08:37:47,804 - INFO - TEST data count: 295
2023-08-18 08:37:48,992 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:49,720 - INFO - Metrics from the Predictions...
2023-08-18 08:37:49,720 - INFO - {'test_loss': 0.3777007460594177, 'test_accuracy': 0.8338983050847457, 'test_precision': 0.9440993788819876, 'test_recall': 0.7916666666666666, 'test_f1': 0.8611898016997168, 'test_roc_auc': 0.8521440129449838, 'test_matthews_correlation': 0.6743016062473781, 'test_runtime': 0.544, 'test_samples_per_second': 542.236, 'test_steps_per_second': 68.009}
2023-08-18 08:37:49,720 - INFO - {'confusion_matrix': array([[ 94,   9],
       [ 40, 152]])}
2023-08-18 08:37:49,720 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	software	0	3e-05	0.3777007460594177	0.8338983050847457	0.9440993788819876	0.7916666666666666	0.8611898016997168	0.8521440129449838	0.6743016062473781	0.544	542.236	68.009
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	software	0	3e-05	[[ 94   9]
 [ 40 152]]

2023-08-18 08:37:49,720 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: software iteration: 0
2023-08-18 08:37:49,720 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:49,720 - INFO - ***********************************
2023-08-18 08:37:49,720 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: transport
2023-08-18 08:37:49,775 - INFO - TEST data count: 247
2023-08-18 08:37:50,903 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:51,509 - INFO - Metrics from the Predictions...
2023-08-18 08:37:51,509 - INFO - {'test_loss': 0.40207797288894653, 'test_accuracy': 0.8380566801619433, 'test_precision': 0.855072463768116, 'test_recall': 0.855072463768116, 'test_f1': 0.855072463768116, 'test_roc_auc': 0.8357931126180029, 'test_matthews_correlation': 0.6715862252360059, 'test_runtime': 0.447, 'test_samples_per_second': 552.599, 'test_steps_per_second': 69.355}
2023-08-18 08:37:51,509 - INFO - {'confusion_matrix': array([[ 89,  20],
       [ 20, 118]])}
2023-08-18 08:37:51,510 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	transport	0	3e-05	0.40207797288894653	0.8380566801619433	0.855072463768116	0.855072463768116	0.855072463768116	0.8357931126180029	0.6715862252360059	0.447	552.599	69.355
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	transport	0	3e-05	[[ 89  20]
 [ 20 118]]

2023-08-18 08:37:51,510 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: transport iteration: 0
2023-08-18 08:37:51,510 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:51,510 - INFO - ***********************************
2023-08-18 08:37:51,510 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: electronics
2023-08-18 08:37:51,566 - INFO - TEST data count: 290
2023-08-18 08:37:52,740 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:53,412 - INFO - Metrics from the Predictions...
2023-08-18 08:37:53,413 - INFO - {'test_loss': 0.41401344537734985, 'test_accuracy': 0.8103448275862069, 'test_precision': 0.8379888268156425, 'test_recall': 0.8522727272727273, 'test_f1': 0.8450704225352113, 'test_roc_auc': 0.7989433811802232, 'test_matthews_correlation': 0.6008135140114182, 'test_runtime': 0.5111, 'test_samples_per_second': 567.405, 'test_steps_per_second': 72.393}
2023-08-18 08:37:53,413 - INFO - {'confusion_matrix': array([[ 85,  29],
       [ 26, 150]])}
2023-08-18 08:37:53,413 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	electronics	0	3e-05	0.41401344537734985	0.8103448275862069	0.8379888268156425	0.8522727272727273	0.8450704225352113	0.7989433811802232	0.6008135140114182	0.5111	567.405	72.393
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	electronics	0	3e-05	[[ 85  29]
 [ 26 150]]

2023-08-18 08:37:53,413 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:37:53,413 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:53,413 - INFO - ***********************************
2023-08-18 08:37:53,413 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: other
2023-08-18 08:37:53,457 - INFO - TEST data count: 128
2023-08-18 08:37:54,637 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:37:55,044 - INFO - Metrics from the Predictions...
2023-08-18 08:37:55,044 - INFO - {'test_loss': 0.32727059721946716, 'test_accuracy': 0.828125, 'test_precision': 0.9101123595505618, 'test_recall': 0.8526315789473684, 'test_f1': 0.8804347826086957, 'test_roc_auc': 0.805103668261563, 'test_matthews_correlation': 0.5799210734128273, 'test_runtime': 0.2546, 'test_samples_per_second': 502.692, 'test_steps_per_second': 62.836}
2023-08-18 08:37:55,044 - INFO - {'confusion_matrix': array([[25,  8],
       [14, 81]])}
2023-08-18 08:37:55,044 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	other	0	3e-05	0.32727059721946716	0.828125	0.9101123595505618	0.8526315789473684	0.8804347826086957	0.805103668261563	0.5799210734128273	0.2546	502.692	62.836
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	other	0	3e-05	[[25  8]
 [14 81]]

2023-08-18 08:37:55,044 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: other iteration: 0
2023-08-18 08:37:55,044 - INFO - ----------------------------------------------------------------------
2023-08-18 08:37:55,044 - INFO - **********************************************************************
2023-08-18 08:37:55,044 - INFO - Iteration number: 1 for TRAIN DOMAIN: apparel
2023-08-18 08:37:55,044 - INFO - Tokenizing the data...
2023-08-18 08:37:56,879 - INFO - TRAIN data count: 175 and DEV data count: 87
2023-08-18 08:37:56,879 - INFO - Finetune and perform evaluation...
2023-08-18 08:37:56,879 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:37:56,879 - INFO - Setting up training args and starting training...
2023-08-18 08:38:16,506 - INFO - Training complete...
2023-08-18 08:38:16,506 - INFO - TrainOutput(global_step=88, training_loss=0.4820777719671076, metrics={'train_runtime': 18.5129, 'train_samples_per_second': 37.812, 'train_steps_per_second': 4.753, 'total_flos': 17986107300000.0, 'train_loss': 0.4820777719671076, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:38:16,506 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:38:17,449 - INFO - Report evaluation results...
2023-08-18 08:38:17,449 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	apparel	na	1	3e-05	0.6390487551689148	0.5517241379310345	0.5517241379310345	1.0	0.7111111111111111	0.5	0.0	0.192	453.216	57.303	2.25e-05	1.0	22
vinai/bertweet-base	apparel	na	1	3e-05	0.4923148453235626	0.8045977011494253	0.7719298245614035	0.9166666666666666	0.838095238095238	0.7916666666666667	0.6103397577440298	0.1648	527.759	66.728	1.5e-05	2.0	44
vinai/bertweet-base	apparel	na	1	3e-05	0.35973918437957764	0.8735632183908046	0.8936170212765957	0.875	0.8842105263157894	0.8733974358974359	0.7452042525836388	0.173	502.942	63.59	7.5e-06	3.0	66
vinai/bertweet-base	apparel	na	1	3e-05	0.3479054868221283	0.8735632183908046	0.8775510204081632	0.8958333333333334	0.8865979381443299	0.8709935897435898	0.7439769582795979	0.1708	509.479	64.417	0.0	4.0	88
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	apparel	na	1	3e-05	18.5129	37.812	4.753	17986107300000.0	0.4820777719671076	0.0	4.0	88

2023-08-18 08:38:17,449 - INFO - Loading the finetuned model
2023-08-18 08:38:19,081 - INFO - ***********************************
2023-08-18 08:38:19,081 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: food
2023-08-18 08:38:19,122 - INFO - TEST data count: 127
2023-08-18 08:38:20,575 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:21,043 - INFO - Metrics from the Predictions...
2023-08-18 08:38:21,043 - INFO - {'test_loss': 0.33298513293266296, 'test_accuracy': 0.8976377952755905, 'test_precision': 0.9072164948453608, 'test_recall': 0.9565217391304348, 'test_f1': 0.9312169312169312, 'test_roc_auc': 0.8496894409937888, 'test_matthews_correlation': 0.7356884804639079, 'test_runtime': 0.2413, 'test_samples_per_second': 526.268, 'test_steps_per_second': 66.301}
2023-08-18 08:38:21,043 - INFO - {'confusion_matrix': array([[26,  9],
       [ 4, 88]])}
2023-08-18 08:38:21,043 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	food	1	3e-05	0.33298513293266296	0.8976377952755905	0.9072164948453608	0.9565217391304348	0.9312169312169312	0.8496894409937888	0.7356884804639079	0.2413	526.268	66.301
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	food	1	3e-05	[[26  9]
 [ 4 88]]

2023-08-18 08:38:21,043 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: food iteration: 1
2023-08-18 08:38:21,043 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:21,043 - INFO - ***********************************
2023-08-18 08:38:21,043 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: apparel
2023-08-18 08:38:21,043 - INFO - Train and test domains are the same: apparel, hence skipping
2023-08-18 08:38:21,043 - INFO - ***********************************
2023-08-18 08:38:21,043 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: cars
2023-08-18 08:38:21,083 - INFO - TEST data count: 93
2023-08-18 08:38:22,265 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:22,644 - INFO - Metrics from the Predictions...
2023-08-18 08:38:22,644 - INFO - {'test_loss': 0.37375757098197937, 'test_accuracy': 0.8387096774193549, 'test_precision': 0.8533333333333334, 'test_recall': 0.9411764705882353, 'test_f1': 0.8951048951048952, 'test_roc_auc': 0.7505882352941177, 'test_matthews_correlation': 0.562403804410751, 'test_runtime': 0.2244, 'test_samples_per_second': 414.384, 'test_steps_per_second': 53.469}
2023-08-18 08:38:22,644 - INFO - {'confusion_matrix': array([[14, 11],
       [ 4, 64]])}
2023-08-18 08:38:22,644 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	cars	1	3e-05	0.37375757098197937	0.8387096774193549	0.8533333333333334	0.9411764705882353	0.8951048951048952	0.7505882352941177	0.562403804410751	0.2244	414.384	53.469
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	cars	1	3e-05	[[14 11]
 [ 4 64]]

2023-08-18 08:38:22,644 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: cars iteration: 1
2023-08-18 08:38:22,644 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:22,644 - INFO - ***********************************
2023-08-18 08:38:22,644 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: retail
2023-08-18 08:38:22,686 - INFO - TEST data count: 197
2023-08-18 08:38:23,846 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:24,369 - INFO - Metrics from the Predictions...
2023-08-18 08:38:24,369 - INFO - {'test_loss': 0.4065163731575012, 'test_accuracy': 0.8426395939086294, 'test_precision': 0.8699186991869918, 'test_recall': 0.8770491803278688, 'test_f1': 0.873469387755102, 'test_roc_auc': 0.8318579234972677, 'test_matthews_correlation': 0.6654636205194638, 'test_runtime': 0.3517, 'test_samples_per_second': 560.134, 'test_steps_per_second': 71.083}
2023-08-18 08:38:24,369 - INFO - {'confusion_matrix': array([[ 59,  16],
       [ 15, 107]])}
2023-08-18 08:38:24,370 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	retail	1	3e-05	0.4065163731575012	0.8426395939086294	0.8699186991869918	0.8770491803278688	0.873469387755102	0.8318579234972677	0.6654636205194638	0.3517	560.134	71.083
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	retail	1	3e-05	[[ 59  16]
 [ 15 107]]

2023-08-18 08:38:24,370 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: retail iteration: 1
2023-08-18 08:38:24,370 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:24,370 - INFO - ***********************************
2023-08-18 08:38:24,370 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: services
2023-08-18 08:38:24,413 - INFO - TEST data count: 335
2023-08-18 08:38:30,548 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:36,341 - INFO - Metrics from the Predictions...
2023-08-18 08:38:36,341 - INFO - {'test_loss': 0.42907533049583435, 'test_accuracy': 0.8238805970149253, 'test_precision': 0.8138528138528138, 'test_recall': 0.9215686274509803, 'test_f1': 0.8643678160919541, 'test_roc_auc': 0.79666217632091, 'test_matthews_correlation': 0.6257779352835489, 'test_runtime': 0.6128, 'test_samples_per_second': 546.648, 'test_steps_per_second': 68.535}
2023-08-18 08:38:36,341 - INFO - {'confusion_matrix': array([[ 88,  43],
       [ 16, 188]])}
2023-08-18 08:38:36,341 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	services	1	3e-05	0.42907533049583435	0.8238805970149253	0.8138528138528138	0.9215686274509803	0.8643678160919541	0.79666217632091	0.6257779352835489	0.6128	546.648	68.535
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	services	1	3e-05	[[ 88  43]
 [ 16 188]]

2023-08-18 08:38:36,341 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: services iteration: 1
2023-08-18 08:38:36,341 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:36,341 - INFO - ***********************************
2023-08-18 08:38:36,341 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: software
2023-08-18 08:38:36,388 - INFO - TEST data count: 295
2023-08-18 08:38:37,684 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:43,419 - INFO - Metrics from the Predictions...
2023-08-18 08:38:43,419 - INFO - {'test_loss': 0.34959569573402405, 'test_accuracy': 0.8711864406779661, 'test_precision': 0.8969072164948454, 'test_recall': 0.90625, 'test_f1': 0.9015544041450777, 'test_roc_auc': 0.8560376213592233, 'test_matthews_correlation': 0.7153746746839701, 'test_runtime': 0.5356, 'test_samples_per_second': 550.779, 'test_steps_per_second': 69.081}
2023-08-18 08:38:43,419 - INFO - {'confusion_matrix': array([[ 83,  20],
       [ 18, 174]])}
2023-08-18 08:38:43,419 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	software	1	3e-05	0.34959569573402405	0.8711864406779661	0.8969072164948454	0.90625	0.9015544041450777	0.8560376213592233	0.7153746746839701	0.5356	550.779	69.081
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	software	1	3e-05	[[ 83  20]
 [ 18 174]]

2023-08-18 08:38:43,419 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: software iteration: 1
2023-08-18 08:38:43,419 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:43,419 - INFO - ***********************************
2023-08-18 08:38:43,419 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: transport
2023-08-18 08:38:43,488 - INFO - TEST data count: 247
2023-08-18 08:38:44,600 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:45,186 - INFO - Metrics from the Predictions...
2023-08-18 08:38:45,186 - INFO - {'test_loss': 0.4494289755821228, 'test_accuracy': 0.8137651821862348, 'test_precision': 0.7911392405063291, 'test_recall': 0.9057971014492754, 'test_f1': 0.8445945945945946, 'test_roc_auc': 0.801522403935647, 'test_matthews_correlation': 0.6237044289046078, 'test_runtime': 0.4309, 'test_samples_per_second': 573.229, 'test_steps_per_second': 71.944}
2023-08-18 08:38:45,186 - INFO - {'confusion_matrix': array([[ 76,  33],
       [ 13, 125]])}
2023-08-18 08:38:45,186 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	transport	1	3e-05	0.4494289755821228	0.8137651821862348	0.7911392405063291	0.9057971014492754	0.8445945945945946	0.801522403935647	0.6237044289046078	0.4309	573.229	71.944
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	transport	1	3e-05	[[ 76  33]
 [ 13 125]]

2023-08-18 08:38:45,186 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: transport iteration: 1
2023-08-18 08:38:45,186 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:45,186 - INFO - ***********************************
2023-08-18 08:38:45,186 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: electronics
2023-08-18 08:38:45,222 - INFO - TEST data count: 290
2023-08-18 08:38:46,430 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:47,092 - INFO - Metrics from the Predictions...
2023-08-18 08:38:47,092 - INFO - {'test_loss': 0.42842739820480347, 'test_accuracy': 0.8103448275862069, 'test_precision': 0.7894736842105263, 'test_recall': 0.9375, 'test_f1': 0.8571428571428572, 'test_roc_auc': 0.7757675438596492, 'test_matthews_correlation': 0.6004353511793072, 'test_runtime': 0.5071, 'test_samples_per_second': 571.828, 'test_steps_per_second': 72.957}
2023-08-18 08:38:47,092 - INFO - {'confusion_matrix': array([[ 70,  44],
       [ 11, 165]])}
2023-08-18 08:38:47,092 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	electronics	1	3e-05	0.42842739820480347	0.8103448275862069	0.7894736842105263	0.9375	0.8571428571428572	0.7757675438596492	0.6004353511793072	0.5071	571.828	72.957
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	electronics	1	3e-05	[[ 70  44]
 [ 11 165]]

2023-08-18 08:38:47,092 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:38:47,092 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:47,092 - INFO - ***********************************
2023-08-18 08:38:47,092 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: other
2023-08-18 08:38:47,249 - INFO - TEST data count: 128
2023-08-18 08:38:48,506 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:38:49,014 - INFO - Metrics from the Predictions...
2023-08-18 08:38:49,014 - INFO - {'test_loss': 0.2807605266571045, 'test_accuracy': 0.921875, 'test_precision': 0.9292929292929293, 'test_recall': 0.968421052631579, 'test_f1': 0.9484536082474226, 'test_roc_auc': 0.8781499202551833, 'test_matthews_correlation': 0.7903076487521166, 'test_runtime': 0.2572, 'test_samples_per_second': 497.703, 'test_steps_per_second': 62.213}
2023-08-18 08:38:49,014 - INFO - {'confusion_matrix': array([[26,  7],
       [ 3, 92]])}
2023-08-18 08:38:49,014 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	other	1	3e-05	0.2807605266571045	0.921875	0.9292929292929293	0.968421052631579	0.9484536082474226	0.8781499202551833	0.7903076487521166	0.2572	497.703	62.213
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	other	1	3e-05	[[26  7]
 [ 3 92]]

2023-08-18 08:38:49,014 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: other iteration: 1
2023-08-18 08:38:49,014 - INFO - ----------------------------------------------------------------------
2023-08-18 08:38:49,014 - INFO - **********************************************************************
2023-08-18 08:38:49,014 - INFO - Iteration number: 2 for TRAIN DOMAIN: apparel
2023-08-18 08:38:49,014 - INFO - Tokenizing the data...
2023-08-18 08:38:50,897 - INFO - TRAIN data count: 175 and DEV data count: 87
2023-08-18 08:38:50,897 - INFO - Finetune and perform evaluation...
2023-08-18 08:38:50,897 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:38:50,897 - INFO - Setting up training args and starting training...
2023-08-18 08:39:10,548 - INFO - Training complete...
2023-08-18 08:39:10,548 - INFO - TrainOutput(global_step=88, training_loss=0.4147845615040172, metrics={'train_runtime': 18.4874, 'train_samples_per_second': 37.864, 'train_steps_per_second': 4.76, 'total_flos': 17986107300000.0, 'train_loss': 0.4147845615040172, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:39:10,548 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:39:11,428 - INFO - Report evaluation results...
2023-08-18 08:39:11,429 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	apparel	na	2	3e-05	0.6408990621566772	0.5862068965517241	0.5769230769230769	0.9375	0.7142857142857143	0.5456730769230769	0.14916764459256535	0.1699	511.986	64.734	2.25e-05	1.0	22
vinai/bertweet-base	apparel	na	2	3e-05	0.5062896013259888	0.8045977011494253	0.7627118644067796	0.9375	0.8411214953271028	0.7892628205128205	0.6158437140735497	0.1678	518.546	65.563	1.5e-05	2.0	44
vinai/bertweet-base	apparel	na	2	3e-05	0.41268718242645264	0.8390804597701149	0.8035714285714286	0.9375	0.8653846153846154	0.8277243589743589	0.6806389215623444	0.1667	521.991	65.999	7.5e-06	3.0	66
vinai/bertweet-base	apparel	na	2	3e-05	0.40943101048469543	0.8505747126436781	0.8571428571428571	0.875	0.8659793814432989	0.8477564102564101	0.6973779695320637	0.1666	522.095	66.012	0.0	4.0	88
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	apparel	na	2	3e-05	18.4874	37.864	4.76	17986107300000.0	0.4147845615040172	0.0	4.0	88

2023-08-18 08:39:11,429 - INFO - Loading the finetuned model
2023-08-18 08:39:12,367 - INFO - ***********************************
2023-08-18 08:39:12,367 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: food
2023-08-18 08:39:12,411 - INFO - TEST data count: 127
2023-08-18 08:39:13,575 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:14,017 - INFO - Metrics from the Predictions...
2023-08-18 08:39:14,017 - INFO - {'test_loss': 0.2977488934993744, 'test_accuracy': 0.905511811023622, 'test_precision': 0.925531914893617, 'test_recall': 0.9456521739130435, 'test_f1': 0.935483870967742, 'test_roc_auc': 0.8728260869565219, 'test_matthews_correlation': 0.7597021009963646, 'test_runtime': 0.2333, 'test_samples_per_second': 544.466, 'test_steps_per_second': 68.594}
2023-08-18 08:39:14,017 - INFO - {'confusion_matrix': array([[28,  7],
       [ 5, 87]])}
2023-08-18 08:39:14,018 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	food	2	3e-05	0.2977488934993744	0.905511811023622	0.925531914893617	0.9456521739130435	0.935483870967742	0.8728260869565219	0.7597021009963646	0.2333	544.466	68.594
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	food	2	3e-05	[[28  7]
 [ 5 87]]

2023-08-18 08:39:14,018 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: food iteration: 2
2023-08-18 08:39:14,018 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:14,018 - INFO - ***********************************
2023-08-18 08:39:14,018 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: apparel
2023-08-18 08:39:14,018 - INFO - Train and test domains are the same: apparel, hence skipping
2023-08-18 08:39:14,018 - INFO - ***********************************
2023-08-18 08:39:14,018 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: cars
2023-08-18 08:39:14,058 - INFO - TEST data count: 93
2023-08-18 08:39:15,198 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:15,547 - INFO - Metrics from the Predictions...
2023-08-18 08:39:15,547 - INFO - {'test_loss': 0.3907933533191681, 'test_accuracy': 0.8602150537634409, 'test_precision': 0.8666666666666667, 'test_recall': 0.9558823529411765, 'test_f1': 0.9090909090909091, 'test_roc_auc': 0.7779411764705882, 'test_matthews_correlation': 0.6237929520753048, 'test_runtime': 0.1856, 'test_samples_per_second': 501.153, 'test_steps_per_second': 64.665}
2023-08-18 08:39:15,547 - INFO - {'confusion_matrix': array([[15, 10],
       [ 3, 65]])}
2023-08-18 08:39:15,548 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	cars	2	3e-05	0.3907933533191681	0.8602150537634409	0.8666666666666667	0.9558823529411765	0.9090909090909091	0.7779411764705882	0.6237929520753048	0.1856	501.153	64.665
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	cars	2	3e-05	[[15 10]
 [ 3 65]]

2023-08-18 08:39:15,548 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: cars iteration: 2
2023-08-18 08:39:15,548 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:15,548 - INFO - ***********************************
2023-08-18 08:39:15,548 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: retail
2023-08-18 08:39:15,582 - INFO - TEST data count: 197
2023-08-18 08:39:16,755 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:17,271 - INFO - Metrics from the Predictions...
2023-08-18 08:39:17,271 - INFO - {'test_loss': 0.38862645626068115, 'test_accuracy': 0.8274111675126904, 'test_precision': 0.8548387096774194, 'test_recall': 0.8688524590163934, 'test_f1': 0.8617886178861789, 'test_roc_auc': 0.8144262295081967, 'test_matthews_correlation': 0.6322473793494501, 'test_runtime': 0.3606, 'test_samples_per_second': 546.237, 'test_steps_per_second': 69.319}
2023-08-18 08:39:17,271 - INFO - {'confusion_matrix': array([[ 57,  18],
       [ 16, 106]])}
2023-08-18 08:39:17,271 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	retail	2	3e-05	0.38862645626068115	0.8274111675126904	0.8548387096774194	0.8688524590163934	0.8617886178861789	0.8144262295081967	0.6322473793494501	0.3606	546.237	69.319
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	retail	2	3e-05	[[ 57  18]
 [ 16 106]]

2023-08-18 08:39:17,271 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: retail iteration: 2
2023-08-18 08:39:17,271 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:17,271 - INFO - ***********************************
2023-08-18 08:39:17,271 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: services
2023-08-18 08:39:17,311 - INFO - TEST data count: 335
2023-08-18 08:39:18,583 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:19,501 - INFO - Metrics from the Predictions...
2023-08-18 08:39:19,501 - INFO - {'test_loss': 0.4246295988559723, 'test_accuracy': 0.826865671641791, 'test_precision': 0.8443396226415094, 'test_recall': 0.8774509803921569, 'test_f1': 0.8605769230769231, 'test_roc_auc': 0.812771291722796, 'test_matthews_correlation': 0.6332673900804575, 'test_runtime': 0.5874, 'test_samples_per_second': 570.28, 'test_steps_per_second': 71.498}
2023-08-18 08:39:19,501 - INFO - {'confusion_matrix': array([[ 98,  33],
       [ 25, 179]])}
2023-08-18 08:39:19,502 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	services	2	3e-05	0.4246295988559723	0.826865671641791	0.8443396226415094	0.8774509803921569	0.8605769230769231	0.812771291722796	0.6332673900804575	0.5874	570.28	71.498
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	services	2	3e-05	[[ 98  33]
 [ 25 179]]

2023-08-18 08:39:19,502 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: services iteration: 2
2023-08-18 08:39:19,502 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:19,502 - INFO - ***********************************
2023-08-18 08:39:19,502 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: software
2023-08-18 08:39:19,544 - INFO - TEST data count: 295
2023-08-18 08:39:20,735 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:21,431 - INFO - Metrics from the Predictions...
2023-08-18 08:39:21,431 - INFO - {'test_loss': 0.35025736689567566, 'test_accuracy': 0.847457627118644, 'test_precision': 0.9152542372881356, 'test_recall': 0.84375, 'test_f1': 0.8780487804878049, 'test_roc_auc': 0.8490594660194175, 'test_matthews_correlation': 0.6793146889343272, 'test_runtime': 0.5259, 'test_samples_per_second': 560.893, 'test_steps_per_second': 70.349}
2023-08-18 08:39:21,431 - INFO - {'confusion_matrix': array([[ 88,  15],
       [ 30, 162]])}
2023-08-18 08:39:21,431 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	software	2	3e-05	0.35025736689567566	0.847457627118644	0.9152542372881356	0.84375	0.8780487804878049	0.8490594660194175	0.6793146889343272	0.5259	560.893	70.349
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	software	2	3e-05	[[ 88  15]
 [ 30 162]]

2023-08-18 08:39:21,431 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: software iteration: 2
2023-08-18 08:39:21,431 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:21,431 - INFO - ***********************************
2023-08-18 08:39:21,431 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: transport
2023-08-18 08:39:21,468 - INFO - TEST data count: 247
2023-08-18 08:39:27,717 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:28,310 - INFO - Metrics from the Predictions...
2023-08-18 08:39:28,310 - INFO - {'test_loss': 0.5055288672447205, 'test_accuracy': 0.7813765182186235, 'test_precision': 0.7560975609756098, 'test_recall': 0.8985507246376812, 'test_f1': 0.8211920529801324, 'test_roc_auc': 0.7657891237867305, 'test_matthews_correlation': 0.5588033783563402, 'test_runtime': 0.4379, 'test_samples_per_second': 564.065, 'test_steps_per_second': 70.794}
2023-08-18 08:39:28,310 - INFO - {'confusion_matrix': array([[ 69,  40],
       [ 14, 124]])}
2023-08-18 08:39:28,310 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	transport	2	3e-05	0.5055288672447205	0.7813765182186235	0.7560975609756098	0.8985507246376812	0.8211920529801324	0.7657891237867305	0.5588033783563402	0.4379	564.065	70.794
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	transport	2	3e-05	[[ 69  40]
 [ 14 124]]

2023-08-18 08:39:28,310 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: transport iteration: 2
2023-08-18 08:39:28,310 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:28,310 - INFO - ***********************************
2023-08-18 08:39:28,310 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: electronics
2023-08-18 08:39:28,364 - INFO - TEST data count: 290
2023-08-18 08:39:29,520 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:30,179 - INFO - Metrics from the Predictions...
2023-08-18 08:39:30,179 - INFO - {'test_loss': 0.39245927333831787, 'test_accuracy': 0.8310344827586207, 'test_precision': 0.8290155440414507, 'test_recall': 0.9090909090909091, 'test_f1': 0.8672086720867209, 'test_roc_auc': 0.8098086124401914, 'test_matthews_correlation': 0.6414572532200502, 'test_runtime': 0.5078, 'test_samples_per_second': 571.063, 'test_steps_per_second': 72.86}
2023-08-18 08:39:30,179 - INFO - {'confusion_matrix': array([[ 81,  33],
       [ 16, 160]])}
2023-08-18 08:39:30,179 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	electronics	2	3e-05	0.39245927333831787	0.8310344827586207	0.8290155440414507	0.9090909090909091	0.8672086720867209	0.8098086124401914	0.6414572532200502	0.5078	571.063	72.86
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	electronics	2	3e-05	[[ 81  33]
 [ 16 160]]

2023-08-18 08:39:30,179 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:39:30,179 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:30,179 - INFO - ***********************************
2023-08-18 08:39:30,179 - INFO - For TRAIN domain: apparel now testing with TEST DOMAIN: other
2023-08-18 08:39:30,227 - INFO - TEST data count: 128
2023-08-18 08:39:31,339 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:31,726 - INFO - Metrics from the Predictions...
2023-08-18 08:39:31,727 - INFO - {'test_loss': 0.3124730885028839, 'test_accuracy': 0.875, 'test_precision': 0.8910891089108911, 'test_recall': 0.9473684210526315, 'test_f1': 0.9183673469387755, 'test_roc_auc': 0.8070175438596492, 'test_matthews_correlation': 0.6583690285290694, 'test_runtime': 0.2369, 'test_samples_per_second': 540.315, 'test_steps_per_second': 67.539}
2023-08-18 08:39:31,727 - INFO - {'confusion_matrix': array([[22, 11],
       [ 5, 90]])}
2023-08-18 08:39:31,727 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	apparel	other	2	3e-05	0.3124730885028839	0.875	0.8910891089108911	0.9473684210526315	0.9183673469387755	0.8070175438596492	0.6583690285290694	0.2369	540.315	67.539
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	apparel	other	2	3e-05	[[22 11]
 [ 5 90]]

2023-08-18 08:39:31,727 - INFO - Finished testing for TRAIN DOMAIN: apparel and TEST DOMAIN: other iteration: 2
2023-08-18 08:39:31,727 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:31,727 - INFO - Finished all iterations and all testing for TRAIN domain: apparel
2023-08-18 08:39:31,727 - INFO - Calculating mean of test metrics for TRAIN domain: apparel
2023-08-18 08:39:31,727 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	food	2	3e-05	0.3360728621482849	0.8818897637795274	0.9204399461034688	0.9166666666666666	0.91768814618277	0.8535714285714286	0.7113435038643181	0.23596666666666666	538.3873333333332	67.82799999999999
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	food	2	3e-05	27.666666666666668	7.333333333333333	7.666666666666667	84.33333333333333

2023-08-18 08:39:31,728 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	cars	2	3e-05	0.38743895292282104	0.8494623655913979	0.8685714285714287	0.9362745098039217	0.9009155096111617	0.7748039215686274	0.5980921879837714	0.19993333333333332	468.52666666666664	60.455000000000005
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	cars	2	3e-05	15.333333333333334	9.666666666666666	4.333333333333333	63.666666666666664

2023-08-18 08:39:31,728 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	retail	2	3e-05	0.4008575677871704	0.8341793570219966	0.8776714298661187	0.8524590163934426	0.864133620928046	0.8284517304189435	0.6533481320962085	0.3558333333333334	553.6413333333334	70.259
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	retail	2	3e-05	60.333333333333336	14.666666666666666	18.0	104.0

2023-08-18 08:39:31,728 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	services	2	3e-05	0.4261375466982524	0.8248756218905472	0.8361446607960143	0.8872549019607843	0.8604641425777846	0.8074951354587636	0.629279088761176	0.5935666666666667	564.6886666666667	70.79700000000001
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	services	2	3e-05	95.33333333333333	35.666666666666664	23.0	181.0

2023-08-18 08:39:31,729 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	software	2	3e-05	0.3591846028963725	0.8508474576271187	0.9187536108883227	0.8472222222222222	0.8802643287775331	0.8524137001078748	0.6896636566218918	0.5351666666666667	551.3026666666666	69.14633333333335
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	software	2	3e-05	88.33333333333333	14.666666666666666	29.333333333333332	162.66666666666666

2023-08-18 08:39:31,729 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	transport	2	3e-05	0.45234527190526325	0.8110661268556005	0.8007697550833516	0.8864734299516908	0.8402863704476143	0.8010348801134602	0.6180313441656513	0.43860000000000005	563.2976666666667	70.69766666666668
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	transport	2	3e-05	78.0	31.0	15.666666666666666	122.33333333333333

2023-08-18 08:39:31,729 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	electronics	2	3e-05	0.41163337230682373	0.8172413793103447	0.8188260183558732	0.899621212121212	0.8564739839215965	0.7948398458266879	0.6142353728035919	0.5086666666666667	570.0986666666666	72.73666666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	electronics	2	3e-05	78.66666666666667	35.333333333333336	17.666666666666668	158.33333333333334

2023-08-18 08:39:31,730 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	apparel	other	2	3e-05	0.30683473745981854	0.875	0.9101647992514607	0.9228070175438595	0.9157519125982979	0.8300903774587985	0.6761992502313378	0.2495666666666667	513.57	64.19600000000001
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	apparel	other	2	3e-05	24.333333333333332	8.666666666666666	7.333333333333333	87.66666666666667

2023-08-18 08:39:31,730 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:39:31,905 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:39:31,905 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:39:31,905 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:39:31,905 - INFO - ********************************************************************************************************************************************
2023-08-18 08:39:31,905 - INFO - TRAIN DOMAIN: cars
2023-08-18 08:39:31,949 - INFO - Overall data count for train and dev: 93
2023-08-18 08:39:31,950 - INFO - **********************************************************************
2023-08-18 08:39:31,950 - INFO - Iteration number: 0 for TRAIN DOMAIN: cars
2023-08-18 08:39:31,950 - INFO - Tokenizing the data...
2023-08-18 08:39:33,933 - INFO - TRAIN data count: 62 and DEV data count: 31
2023-08-18 08:39:33,933 - INFO - Finetune and perform evaluation...
2023-08-18 08:39:33,933 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:39:33,933 - INFO - Setting up training args and starting training...
2023-08-18 08:39:48,488 - INFO - Training complete...
2023-08-18 08:39:48,488 - INFO - TrainOutput(global_step=32, training_loss=0.5581072568893433, metrics={'train_runtime': 13.3584, 'train_samples_per_second': 18.565, 'train_steps_per_second': 2.396, 'total_flos': 6372220872000.0, 'train_loss': 0.5581072568893433, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:39:48,488 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:39:49,458 - INFO - Report evaluation results...
2023-08-18 08:39:49,459 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	cars	na	0	3e-05	0.5574539303779602	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0723	428.902	55.342	2.25e-05	1.0	8
vinai/bertweet-base	cars	na	0	3e-05	0.5539496541023254	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0719	431.451	55.671	1.5e-05	2.0	16
vinai/bertweet-base	cars	na	0	3e-05	0.5405933260917664	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0697	444.966	57.415	7.5e-06	3.0	24
vinai/bertweet-base	cars	na	0	3e-05	0.5317442417144775	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0725	427.652	55.181	0.0	4.0	32
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	cars	na	0	3e-05	13.3584	18.565	2.396	6372220872000.0	0.5581072568893433	0.0	4.0	32

2023-08-18 08:39:49,459 - INFO - Loading the finetuned model
2023-08-18 08:39:51,023 - INFO - ***********************************
2023-08-18 08:39:51,023 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: food
2023-08-18 08:39:51,120 - INFO - TEST data count: 127
2023-08-18 08:39:52,310 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:52,767 - INFO - Metrics from the Predictions...
2023-08-18 08:39:52,767 - INFO - {'test_loss': 0.5368643403053284, 'test_accuracy': 0.7244094488188977, 'test_precision': 0.7244094488188977, 'test_recall': 1.0, 'test_f1': 0.8401826484018265, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2359, 'test_samples_per_second': 538.355, 'test_steps_per_second': 67.824}
2023-08-18 08:39:52,767 - INFO - {'confusion_matrix': array([[ 0, 35],
       [ 0, 92]])}
2023-08-18 08:39:52,767 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	food	0	3e-05	0.5368643403053284	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.2359	538.355	67.824
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	food	0	3e-05	[[ 0 35]
 [ 0 92]]

2023-08-18 08:39:52,767 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: food iteration: 0
2023-08-18 08:39:52,767 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:52,767 - INFO - ***********************************
2023-08-18 08:39:52,767 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: apparel
2023-08-18 08:39:52,806 - INFO - TEST data count: 262
2023-08-18 08:39:53,990 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:39:54,652 - INFO - Metrics from the Predictions...
2023-08-18 08:39:54,652 - INFO - {'test_loss': 0.729978621006012, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5011, 'test_samples_per_second': 522.806, 'test_steps_per_second': 65.85}
2023-08-18 08:39:54,652 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:39:54,652 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	apparel	0	3e-05	0.729978621006012	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.5011	522.806	65.85
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	apparel	0	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:39:54,652 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:39:54,652 - INFO - ----------------------------------------------------------------------
2023-08-18 08:39:54,652 - INFO - ***********************************
2023-08-18 08:39:54,652 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: cars
2023-08-18 08:39:54,652 - INFO - Train and test domains are the same: cars, hence skipping
2023-08-18 08:39:54,652 - INFO - ***********************************
2023-08-18 08:39:54,653 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: retail
2023-08-18 08:39:54,692 - INFO - TEST data count: 197
2023-08-18 08:40:01,071 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:01,630 - INFO - Metrics from the Predictions...
2023-08-18 08:40:01,630 - INFO - {'test_loss': 0.6568219065666199, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.351, 'test_samples_per_second': 561.29, 'test_steps_per_second': 71.23}
2023-08-18 08:40:01,630 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:40:01,631 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	retail	0	3e-05	0.6568219065666199	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.351	561.29	71.23
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	retail	0	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:40:01,631 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: retail iteration: 0
2023-08-18 08:40:01,631 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:01,631 - INFO - ***********************************
2023-08-18 08:40:01,631 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: services
2023-08-18 08:40:06,677 - INFO - TEST data count: 335
2023-08-18 08:40:07,872 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:08,625 - INFO - Metrics from the Predictions...
2023-08-18 08:40:08,625 - INFO - {'test_loss': 0.6736958026885986, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5762, 'test_samples_per_second': 581.443, 'test_steps_per_second': 72.897}
2023-08-18 08:40:08,625 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:40:08,625 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	services	0	3e-05	0.6736958026885986	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5762	581.443	72.897
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	services	0	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:40:08,625 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: services iteration: 0
2023-08-18 08:40:08,625 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:08,625 - INFO - ***********************************
2023-08-18 08:40:08,625 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: software
2023-08-18 08:40:08,664 - INFO - TEST data count: 295
2023-08-18 08:40:09,924 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:15,632 - INFO - Metrics from the Predictions...
2023-08-18 08:40:15,632 - INFO - {'test_loss': 0.6187466382980347, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5236, 'test_samples_per_second': 563.429, 'test_steps_per_second': 70.667}
2023-08-18 08:40:15,632 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:40:15,632 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	software	0	3e-05	0.6187466382980347	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5236	563.429	70.667
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	software	0	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:40:15,632 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: software iteration: 0
2023-08-18 08:40:15,632 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:15,632 - INFO - ***********************************
2023-08-18 08:40:15,632 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: transport
2023-08-18 08:40:15,681 - INFO - TEST data count: 247
2023-08-18 08:40:16,851 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:17,443 - INFO - Metrics from the Predictions...
2023-08-18 08:40:17,444 - INFO - {'test_loss': 0.7334977984428406, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4361, 'test_samples_per_second': 566.37, 'test_steps_per_second': 71.083}
2023-08-18 08:40:17,444 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:40:17,444 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	transport	0	3e-05	0.7334977984428406	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4361	566.37	71.083
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	transport	0	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:40:17,444 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: transport iteration: 0
2023-08-18 08:40:17,444 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:17,444 - INFO - ***********************************
2023-08-18 08:40:17,444 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: electronics
2023-08-18 08:40:17,482 - INFO - TEST data count: 290
2023-08-18 08:40:18,648 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:19,309 - INFO - Metrics from the Predictions...
2023-08-18 08:40:19,310 - INFO - {'test_loss': 0.6707334518432617, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5129, 'test_samples_per_second': 565.435, 'test_steps_per_second': 72.142}
2023-08-18 08:40:19,310 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:40:19,310 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	electronics	0	3e-05	0.6707334518432617	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5129	565.435	72.142
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	electronics	0	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:40:19,310 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:40:19,310 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:19,310 - INFO - ***********************************
2023-08-18 08:40:19,310 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: other
2023-08-18 08:40:19,360 - INFO - TEST data count: 128
2023-08-18 08:40:20,524 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:20,932 - INFO - Metrics from the Predictions...
2023-08-18 08:40:20,932 - INFO - {'test_loss': 0.543569028377533, 'test_accuracy': 0.7421875, 'test_precision': 0.7421875, 'test_recall': 1.0, 'test_f1': 0.852017937219731, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2424, 'test_samples_per_second': 528.012, 'test_steps_per_second': 66.001}
2023-08-18 08:40:20,932 - INFO - {'confusion_matrix': array([[ 0, 33],
       [ 0, 95]])}
2023-08-18 08:40:20,932 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	other	0	3e-05	0.543569028377533	0.7421875	0.7421875	1.0	0.852017937219731	0.5	0.0	0.2424	528.012	66.001
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	other	0	3e-05	[[ 0 33]
 [ 0 95]]

2023-08-18 08:40:20,932 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: other iteration: 0
2023-08-18 08:40:20,932 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:20,932 - INFO - **********************************************************************
2023-08-18 08:40:20,932 - INFO - Iteration number: 1 for TRAIN DOMAIN: cars
2023-08-18 08:40:20,932 - INFO - Tokenizing the data...
2023-08-18 08:40:24,735 - INFO - TRAIN data count: 62 and DEV data count: 31
2023-08-18 08:40:24,735 - INFO - Finetune and perform evaluation...
2023-08-18 08:40:24,736 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:40:24,736 - INFO - Setting up training args and starting training...
2023-08-18 08:40:38,856 - INFO - Training complete...
2023-08-18 08:40:38,856 - INFO - TrainOutput(global_step=32, training_loss=0.5604250431060791, metrics={'train_runtime': 13.0006, 'train_samples_per_second': 19.076, 'train_steps_per_second': 2.461, 'total_flos': 6372220872000.0, 'train_loss': 0.5604250431060791, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:40:38,856 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:40:39,707 - INFO - Report evaluation results...
2023-08-18 08:40:39,707 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	cars	na	1	3e-05	0.5427492260932922	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.071	436.648	56.342	2.25e-05	1.0	8
vinai/bertweet-base	cars	na	1	3e-05	0.5293749570846558	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0784	395.276	51.003	1.5e-05	2.0	16
vinai/bertweet-base	cars	na	1	3e-05	0.5145756602287292	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0718	431.818	55.718	7.5e-06	3.0	24
vinai/bertweet-base	cars	na	1	3e-05	0.5093392729759216	0.7419354838709677	0.7419354838709677	1.0	0.8518518518518519	0.5	0.0	0.0701	442.251	57.065	0.0	4.0	32
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	cars	na	1	3e-05	13.0006	19.076	2.461	6372220872000.0	0.5604250431060791	0.0	4.0	32

2023-08-18 08:40:39,707 - INFO - Loading the finetuned model
2023-08-18 08:40:40,657 - INFO - ***********************************
2023-08-18 08:40:40,657 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: food
2023-08-18 08:40:40,701 - INFO - TEST data count: 127
2023-08-18 08:40:42,071 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:42,568 - INFO - Metrics from the Predictions...
2023-08-18 08:40:42,568 - INFO - {'test_loss': 0.5348976850509644, 'test_accuracy': 0.7244094488188977, 'test_precision': 0.7244094488188977, 'test_recall': 1.0, 'test_f1': 0.8401826484018265, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2329, 'test_samples_per_second': 545.306, 'test_steps_per_second': 68.7}
2023-08-18 08:40:42,568 - INFO - {'confusion_matrix': array([[ 0, 35],
       [ 0, 92]])}
2023-08-18 08:40:42,569 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	food	1	3e-05	0.5348976850509644	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.2329	545.306	68.7
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	food	1	3e-05	[[ 0 35]
 [ 0 92]]

2023-08-18 08:40:42,569 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: food iteration: 1
2023-08-18 08:40:42,569 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:42,569 - INFO - ***********************************
2023-08-18 08:40:42,569 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: apparel
2023-08-18 08:40:42,608 - INFO - TEST data count: 262
2023-08-18 08:40:43,815 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:44,668 - INFO - Metrics from the Predictions...
2023-08-18 08:40:44,668 - INFO - {'test_loss': 0.718743085861206, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5458, 'test_samples_per_second': 480.012, 'test_steps_per_second': 60.459}
2023-08-18 08:40:44,669 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:40:44,669 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	apparel	1	3e-05	0.718743085861206	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.5458	480.012	60.459
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	apparel	1	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:40:44,669 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:40:44,669 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:44,669 - INFO - ***********************************
2023-08-18 08:40:44,669 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: cars
2023-08-18 08:40:44,669 - INFO - Train and test domains are the same: cars, hence skipping
2023-08-18 08:40:44,669 - INFO - ***********************************
2023-08-18 08:40:44,669 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: retail
2023-08-18 08:40:44,742 - INFO - TEST data count: 197
2023-08-18 08:40:45,861 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:46,376 - INFO - Metrics from the Predictions...
2023-08-18 08:40:46,376 - INFO - {'test_loss': 0.6539307236671448, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.3703, 'test_samples_per_second': 531.948, 'test_steps_per_second': 67.506}
2023-08-18 08:40:46,376 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:40:46,376 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	retail	1	3e-05	0.6539307236671448	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3703	531.948	67.506
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	retail	1	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:40:46,376 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: retail iteration: 1
2023-08-18 08:40:46,376 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:46,376 - INFO - ***********************************
2023-08-18 08:40:46,376 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: services
2023-08-18 08:40:46,419 - INFO - TEST data count: 335
2023-08-18 08:40:47,842 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:48,586 - INFO - Metrics from the Predictions...
2023-08-18 08:40:48,587 - INFO - {'test_loss': 0.6676660776138306, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5818, 'test_samples_per_second': 575.751, 'test_steps_per_second': 72.184}
2023-08-18 08:40:48,587 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:40:48,587 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	services	1	3e-05	0.6676660776138306	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5818	575.751	72.184
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	services	1	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:40:48,587 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: services iteration: 1
2023-08-18 08:40:48,587 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:48,587 - INFO - ***********************************
2023-08-18 08:40:48,587 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: software
2023-08-18 08:40:48,630 - INFO - TEST data count: 295
2023-08-18 08:40:52,059 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:52,749 - INFO - Metrics from the Predictions...
2023-08-18 08:40:52,749 - INFO - {'test_loss': 0.608120858669281, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5185, 'test_samples_per_second': 568.994, 'test_steps_per_second': 71.365}
2023-08-18 08:40:52,749 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:40:52,749 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	software	1	3e-05	0.608120858669281	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5185	568.994	71.365
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	software	1	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:40:52,749 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: software iteration: 1
2023-08-18 08:40:52,749 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:52,749 - INFO - ***********************************
2023-08-18 08:40:52,749 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: transport
2023-08-18 08:40:52,786 - INFO - TEST data count: 247
2023-08-18 08:40:53,924 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:54,538 - INFO - Metrics from the Predictions...
2023-08-18 08:40:54,538 - INFO - {'test_loss': 0.7315242886543274, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4544, 'test_samples_per_second': 543.561, 'test_steps_per_second': 68.22}
2023-08-18 08:40:54,538 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:40:54,538 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	transport	1	3e-05	0.7315242886543274	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4544	543.561	68.22
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	transport	1	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:40:54,538 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: transport iteration: 1
2023-08-18 08:40:54,538 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:54,538 - INFO - ***********************************
2023-08-18 08:40:54,538 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: electronics
2023-08-18 08:40:54,583 - INFO - TEST data count: 290
2023-08-18 08:40:55,724 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:40:56,415 - INFO - Metrics from the Predictions...
2023-08-18 08:40:56,415 - INFO - {'test_loss': 0.6627204418182373, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5199, 'test_samples_per_second': 557.831, 'test_steps_per_second': 71.172}
2023-08-18 08:40:56,415 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:40:56,416 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	electronics	1	3e-05	0.6627204418182373	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5199	557.831	71.172
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	electronics	1	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:40:56,416 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:40:56,416 - INFO - ----------------------------------------------------------------------
2023-08-18 08:40:56,416 - INFO - ***********************************
2023-08-18 08:40:56,416 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: other
2023-08-18 08:40:56,460 - INFO - TEST data count: 128
2023-08-18 08:41:02,615 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:02,997 - INFO - Metrics from the Predictions...
2023-08-18 08:41:02,998 - INFO - {'test_loss': 0.542351245880127, 'test_accuracy': 0.7421875, 'test_precision': 0.7421875, 'test_recall': 1.0, 'test_f1': 0.852017937219731, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2387, 'test_samples_per_second': 536.264, 'test_steps_per_second': 67.033}
2023-08-18 08:41:02,998 - INFO - {'confusion_matrix': array([[ 0, 33],
       [ 0, 95]])}
2023-08-18 08:41:02,998 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	other	1	3e-05	0.542351245880127	0.7421875	0.7421875	1.0	0.852017937219731	0.5	0.0	0.2387	536.264	67.033
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	other	1	3e-05	[[ 0 33]
 [ 0 95]]

2023-08-18 08:41:02,998 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: other iteration: 1
2023-08-18 08:41:02,998 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:02,998 - INFO - **********************************************************************
2023-08-18 08:41:02,998 - INFO - Iteration number: 2 for TRAIN DOMAIN: cars
2023-08-18 08:41:02,998 - INFO - Tokenizing the data...
2023-08-18 08:41:04,868 - INFO - TRAIN data count: 62 and DEV data count: 31
2023-08-18 08:41:04,868 - INFO - Finetune and perform evaluation...
2023-08-18 08:41:04,868 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:41:04,868 - INFO - Setting up training args and starting training...
2023-08-18 08:41:18,675 - INFO - Training complete...
2023-08-18 08:41:18,676 - INFO - TrainOutput(global_step=32, training_loss=0.533911406993866, metrics={'train_runtime': 12.662, 'train_samples_per_second': 19.586, 'train_steps_per_second': 2.527, 'total_flos': 6372220872000.0, 'train_loss': 0.533911406993866, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:41:18,676 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:41:19,522 - INFO - Report evaluation results...
2023-08-18 08:41:19,523 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	cars	na	2	3e-05	0.6014251112937927	0.7096774193548387	0.7096774193548387	1.0	0.8301886792452831	0.5	0.0	0.073	424.577	54.784	2.25e-05	1.0	8
vinai/bertweet-base	cars	na	2	3e-05	0.6321974992752075	0.7096774193548387	0.7096774193548387	1.0	0.8301886792452831	0.5	0.0	0.0696	445.213	57.447	1.5e-05	2.0	16
vinai/bertweet-base	cars	na	2	3e-05	0.6263689398765564	0.7096774193548387	0.7096774193548387	1.0	0.8301886792452831	0.5	0.0	0.0712	435.184	56.153	7.5e-06	3.0	24
vinai/bertweet-base	cars	na	2	3e-05	0.6161069273948669	0.7096774193548387	0.7096774193548387	1.0	0.8301886792452831	0.5	0.0	0.0738	419.909	54.182	0.0	4.0	32
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	cars	na	2	3e-05	12.662	19.586	2.527	6372220872000.0	0.533911406993866	0.0	4.0	32

2023-08-18 08:41:19,523 - INFO - Loading the finetuned model
2023-08-18 08:41:20,455 - INFO - ***********************************
2023-08-18 08:41:20,455 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: food
2023-08-18 08:41:20,710 - INFO - TEST data count: 127
2023-08-18 08:41:21,832 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:22,286 - INFO - Metrics from the Predictions...
2023-08-18 08:41:22,286 - INFO - {'test_loss': 0.5610525608062744, 'test_accuracy': 0.7244094488188977, 'test_precision': 0.7244094488188977, 'test_recall': 1.0, 'test_f1': 0.8401826484018265, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2284, 'test_samples_per_second': 556.088, 'test_steps_per_second': 70.058}
2023-08-18 08:41:22,286 - INFO - {'confusion_matrix': array([[ 0, 35],
       [ 0, 92]])}
2023-08-18 08:41:22,286 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	food	2	3e-05	0.5610525608062744	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.2284	556.088	70.058
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	food	2	3e-05	[[ 0 35]
 [ 0 92]]

2023-08-18 08:41:22,286 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: food iteration: 2
2023-08-18 08:41:22,286 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:22,286 - INFO - ***********************************
2023-08-18 08:41:22,286 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: apparel
2023-08-18 08:41:22,320 - INFO - TEST data count: 262
2023-08-18 08:41:28,500 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:29,119 - INFO - Metrics from the Predictions...
2023-08-18 08:41:29,119 - INFO - {'test_loss': 0.7192108035087585, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4588, 'test_samples_per_second': 571.055, 'test_steps_per_second': 71.927}
2023-08-18 08:41:29,119 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:41:29,120 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	apparel	2	3e-05	0.7192108035087585	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.4588	571.055	71.927
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	apparel	2	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:41:29,120 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:41:29,120 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:29,120 - INFO - ***********************************
2023-08-18 08:41:29,120 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: cars
2023-08-18 08:41:29,120 - INFO - Train and test domains are the same: cars, hence skipping
2023-08-18 08:41:29,120 - INFO - ***********************************
2023-08-18 08:41:29,120 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: retail
2023-08-18 08:41:29,197 - INFO - TEST data count: 197
2023-08-18 08:41:30,428 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:30,958 - INFO - Metrics from the Predictions...
2023-08-18 08:41:30,958 - INFO - {'test_loss': 0.6602043509483337, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.3553, 'test_samples_per_second': 554.444, 'test_steps_per_second': 70.361}
2023-08-18 08:41:30,958 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:41:30,958 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	retail	2	3e-05	0.6602043509483337	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3553	554.444	70.361
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	retail	2	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:41:30,958 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: retail iteration: 2
2023-08-18 08:41:30,958 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:30,958 - INFO - ***********************************
2023-08-18 08:41:30,958 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: services
2023-08-18 08:41:30,997 - INFO - TEST data count: 335
2023-08-18 08:41:32,120 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:32,855 - INFO - Metrics from the Predictions...
2023-08-18 08:41:32,855 - INFO - {'test_loss': 0.6673420667648315, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5758, 'test_samples_per_second': 581.761, 'test_steps_per_second': 72.937}
2023-08-18 08:41:32,855 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:41:32,855 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	services	2	3e-05	0.6673420667648315	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5758	581.761	72.937
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	services	2	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:41:32,856 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: services iteration: 2
2023-08-18 08:41:32,856 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:32,856 - INFO - ***********************************
2023-08-18 08:41:32,856 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: software
2023-08-18 08:41:32,894 - INFO - TEST data count: 295
2023-08-18 08:41:34,026 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:34,734 - INFO - Metrics from the Predictions...
2023-08-18 08:41:34,734 - INFO - {'test_loss': 0.6283408999443054, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5148, 'test_samples_per_second': 573.027, 'test_steps_per_second': 71.871}
2023-08-18 08:41:34,734 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:41:34,734 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	software	2	3e-05	0.6283408999443054	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5148	573.027	71.871
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	software	2	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:41:34,734 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: software iteration: 2
2023-08-18 08:41:34,734 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:34,734 - INFO - ***********************************
2023-08-18 08:41:34,734 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: transport
2023-08-18 08:41:34,769 - INFO - TEST data count: 247
2023-08-18 08:41:35,895 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:36,510 - INFO - Metrics from the Predictions...
2023-08-18 08:41:36,511 - INFO - {'test_loss': 0.71656334400177, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4331, 'test_samples_per_second': 570.314, 'test_steps_per_second': 71.578}
2023-08-18 08:41:36,511 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:41:36,511 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	transport	2	3e-05	0.71656334400177	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4331	570.314	71.578
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	transport	2	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:41:36,511 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: transport iteration: 2
2023-08-18 08:41:36,511 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:36,511 - INFO - ***********************************
2023-08-18 08:41:36,511 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: electronics
2023-08-18 08:41:36,548 - INFO - TEST data count: 290
2023-08-18 08:41:37,660 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:38,322 - INFO - Metrics from the Predictions...
2023-08-18 08:41:38,322 - INFO - {'test_loss': 0.6667062044143677, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5097, 'test_samples_per_second': 568.974, 'test_steps_per_second': 72.593}
2023-08-18 08:41:38,322 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:41:38,322 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	electronics	2	3e-05	0.6667062044143677	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5097	568.974	72.593
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	electronics	2	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:41:38,323 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:41:38,323 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:38,323 - INFO - ***********************************
2023-08-18 08:41:38,323 - INFO - For TRAIN domain: cars now testing with TEST DOMAIN: other
2023-08-18 08:41:38,363 - INFO - TEST data count: 128
2023-08-18 08:41:39,470 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:41:39,860 - INFO - Metrics from the Predictions...
2023-08-18 08:41:39,860 - INFO - {'test_loss': 0.5596179366111755, 'test_accuracy': 0.7421875, 'test_precision': 0.7421875, 'test_recall': 1.0, 'test_f1': 0.852017937219731, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2415, 'test_samples_per_second': 529.996, 'test_steps_per_second': 66.25}
2023-08-18 08:41:39,860 - INFO - {'confusion_matrix': array([[ 0, 33],
       [ 0, 95]])}
2023-08-18 08:41:39,860 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	cars	other	2	3e-05	0.5596179366111755	0.7421875	0.7421875	1.0	0.852017937219731	0.5	0.0	0.2415	529.996	66.25
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	cars	other	2	3e-05	[[ 0 33]
 [ 0 95]]

2023-08-18 08:41:39,860 - INFO - Finished testing for TRAIN DOMAIN: cars and TEST DOMAIN: other iteration: 2
2023-08-18 08:41:39,860 - INFO - ----------------------------------------------------------------------
2023-08-18 08:41:39,860 - INFO - Finished all iterations and all testing for TRAIN domain: cars
2023-08-18 08:41:39,860 - INFO - Calculating mean of test metrics for TRAIN domain: cars
2023-08-18 08:41:39,861 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	food	2	3e-05	0.5442715287208557	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.23240000000000002	546.583	68.86066666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	food	2	3e-05	0.0	35.0	0.0	92.0

2023-08-18 08:41:39,861 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	apparel	2	3e-05	0.7226441701253256	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307124	0.5	0.0	0.5019	524.6243333333333	66.07866666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	apparel	2	3e-05	0.0	117.0	0.0	145.0

2023-08-18 08:41:39,861 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	retail	2	3e-05	0.6569856603940328	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.35886666666666667	549.2273333333333	69.699
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	retail	2	3e-05	0.0	75.0	0.0	122.0

2023-08-18 08:41:39,862 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	services	2	3e-05	0.6695679823557535	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5779333333333333	579.6516666666666	72.67266666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	services	2	3e-05	0.0	131.0	0.0	204.0

2023-08-18 08:41:39,862 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	software	2	3e-05	0.6184027989705404	0.6508474576271186	0.6508474576271186	1.0	0.788501026694045	0.5	0.0	0.5189666666666667	568.4833333333333	71.30099999999999
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	software	2	3e-05	0.0	103.0	0.0	192.0

2023-08-18 08:41:39,862 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	transport	2	3e-05	0.727195143699646	0.5587044534412956	0.5587044534412956	1.0	0.716883116883117	0.5	0.0	0.44120000000000004	560.0816666666666	70.29366666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	transport	2	3e-05	0.0	109.0	0.0	138.0

2023-08-18 08:41:39,863 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	electronics	2	3e-05	0.6667200326919556	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5141666666666667	564.08	71.969
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	electronics	2	3e-05	0.0	114.0	0.0	176.0

2023-08-18 08:41:39,863 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	cars	other	2	3e-05	0.5485127369562784	0.7421875	0.7421875	1.0	0.8520179372197308	0.5	0.0	0.24086666666666665	531.424	66.428
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	cars	other	2	3e-05	0.0	33.0	0.0	95.0

2023-08-18 08:41:39,863 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:41:40,097 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:41:40,098 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:41:40,098 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:41:40,098 - INFO - ********************************************************************************************************************************************
2023-08-18 08:41:40,098 - INFO - TRAIN DOMAIN: retail
2023-08-18 08:41:40,140 - INFO - Overall data count for train and dev: 197
2023-08-18 08:41:40,141 - INFO - **********************************************************************
2023-08-18 08:41:40,141 - INFO - Iteration number: 0 for TRAIN DOMAIN: retail
2023-08-18 08:41:40,141 - INFO - Tokenizing the data...
2023-08-18 08:41:41,991 - INFO - TRAIN data count: 131 and DEV data count: 66
2023-08-18 08:41:41,991 - INFO - Finetune and perform evaluation...
2023-08-18 08:41:41,991 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:41:41,991 - INFO - Setting up training args and starting training...
2023-08-18 08:41:59,246 - INFO - Training complete...
2023-08-18 08:41:59,246 - INFO - TrainOutput(global_step=68, training_loss=0.49738143472110524, metrics={'train_runtime': 15.8433, 'train_samples_per_second': 33.074, 'train_steps_per_second': 4.292, 'total_flos': 13463886036000.0, 'train_loss': 0.49738143472110524, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:41:59,246 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:42:00,253 - INFO - Report evaluation results...
2023-08-18 08:42:00,253 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	retail	na	0	3e-05	0.6302699446678162	0.6212121212121212	0.6212121212121212	1.0	0.766355140186916	0.5	0.0	0.137	481.856	65.708	2.25e-05	1.0	17
vinai/bertweet-base	retail	na	0	3e-05	0.5584108233451843	0.6818181818181818	0.6724137931034483	0.9512195121951219	0.7878787878787878	0.595609756097561	0.28420724737721337	0.1362	484.421	66.057	1.5e-05	2.0	34
vinai/bertweet-base	retail	na	0	3e-05	0.46899107098579407	0.803030303030303	0.8043478260869565	0.9024390243902439	0.8505747126436782	0.771219512195122	0.5725572854963715	0.1365	483.65	65.952	7.5e-06	3.0	51
vinai/bertweet-base	retail	na	0	3e-05	0.44503262639045715	0.8333333333333334	0.8260869565217391	0.926829268292683	0.8735632183908046	0.8034146341463414	0.6405227186668041	0.1403	470.337	64.137	0.0	4.0	68
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	retail	na	0	3e-05	15.8433	33.074	4.292	13463886036000.0	0.49738143472110524	0.0	4.0	68

2023-08-18 08:42:00,253 - INFO - Loading the finetuned model
2023-08-18 08:42:01,652 - INFO - ***********************************
2023-08-18 08:42:01,653 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: food
2023-08-18 08:42:01,701 - INFO - TEST data count: 127
2023-08-18 08:42:02,874 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:03,362 - INFO - Metrics from the Predictions...
2023-08-18 08:42:03,362 - INFO - {'test_loss': 0.3931484520435333, 'test_accuracy': 0.8346456692913385, 'test_precision': 0.8901098901098901, 'test_recall': 0.8804347826086957, 'test_f1': 0.8852459016393442, 'test_roc_auc': 0.797360248447205, 'test_matthews_correlation': 0.5896155054846632, 'test_runtime': 0.2313, 'test_samples_per_second': 549.067, 'test_steps_per_second': 69.174}
2023-08-18 08:42:03,362 - INFO - {'confusion_matrix': array([[25, 10],
       [11, 81]])}
2023-08-18 08:42:03,363 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	food	0	3e-05	0.3931484520435333	0.8346456692913385	0.8901098901098901	0.8804347826086957	0.8852459016393442	0.797360248447205	0.5896155054846632	0.2313	549.067	69.174
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	food	0	3e-05	[[25 10]
 [11 81]]

2023-08-18 08:42:03,363 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: food iteration: 0
2023-08-18 08:42:03,363 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:03,363 - INFO - ***********************************
2023-08-18 08:42:03,363 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: apparel
2023-08-18 08:42:03,404 - INFO - TEST data count: 262
2023-08-18 08:42:04,596 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:05,219 - INFO - Metrics from the Predictions...
2023-08-18 08:42:05,220 - INFO - {'test_loss': 0.4811299443244934, 'test_accuracy': 0.7748091603053435, 'test_precision': 0.7471264367816092, 'test_recall': 0.896551724137931, 'test_f1': 0.8150470219435736, 'test_roc_auc': 0.7602416740347775, 'test_matthews_correlation': 0.547857752282025, 'test_runtime': 0.4663, 'test_samples_per_second': 561.91, 'test_steps_per_second': 70.775}
2023-08-18 08:42:05,220 - INFO - {'confusion_matrix': array([[ 73,  44],
       [ 15, 130]])}
2023-08-18 08:42:05,220 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	apparel	0	3e-05	0.4811299443244934	0.7748091603053435	0.7471264367816092	0.896551724137931	0.8150470219435736	0.7602416740347775	0.547857752282025	0.4663	561.91	70.775
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	apparel	0	3e-05	[[ 73  44]
 [ 15 130]]

2023-08-18 08:42:05,220 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:42:05,220 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:05,220 - INFO - ***********************************
2023-08-18 08:42:05,220 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: cars
2023-08-18 08:42:05,259 - INFO - TEST data count: 93
2023-08-18 08:42:06,402 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:06,749 - INFO - Metrics from the Predictions...
2023-08-18 08:42:06,750 - INFO - {'test_loss': 0.38763096928596497, 'test_accuracy': 0.8494623655913979, 'test_precision': 0.8552631578947368, 'test_recall': 0.9558823529411765, 'test_f1': 0.9027777777777778, 'test_roc_auc': 0.7579411764705883, 'test_matthews_correlation': 0.5917576429543608, 'test_runtime': 0.1888, 'test_samples_per_second': 492.613, 'test_steps_per_second': 63.563}
2023-08-18 08:42:06,750 - INFO - {'confusion_matrix': array([[14, 11],
       [ 3, 65]])}
2023-08-18 08:42:06,750 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	cars	0	3e-05	0.38763096928596497	0.8494623655913979	0.8552631578947368	0.9558823529411765	0.9027777777777778	0.7579411764705883	0.5917576429543608	0.1888	492.613	63.563
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	cars	0	3e-05	[[14 11]
 [ 3 65]]

2023-08-18 08:42:06,750 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: cars iteration: 0
2023-08-18 08:42:06,750 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:06,750 - INFO - ***********************************
2023-08-18 08:42:06,750 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: retail
2023-08-18 08:42:06,750 - INFO - Train and test domains are the same: retail, hence skipping
2023-08-18 08:42:06,750 - INFO - ***********************************
2023-08-18 08:42:06,750 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: services
2023-08-18 08:42:06,792 - INFO - TEST data count: 335
2023-08-18 08:42:07,958 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:08,708 - INFO - Metrics from the Predictions...
2023-08-18 08:42:08,708 - INFO - {'test_loss': 0.5051644444465637, 'test_accuracy': 0.7761194029850746, 'test_precision': 0.7549407114624506, 'test_recall': 0.9362745098039216, 'test_f1': 0.8358862144420132, 'test_roc_auc': 0.7314960335279149, 'test_matthews_correlation': 0.5254810930395967, 'test_runtime': 0.5746, 'test_samples_per_second': 582.99, 'test_steps_per_second': 73.091}
2023-08-18 08:42:08,708 - INFO - {'confusion_matrix': array([[ 69,  62],
       [ 13, 191]])}
2023-08-18 08:42:08,708 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	services	0	3e-05	0.5051644444465637	0.7761194029850746	0.7549407114624506	0.9362745098039216	0.8358862144420132	0.7314960335279149	0.5254810930395967	0.5746	582.99	73.091
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	services	0	3e-05	[[ 69  62]
 [ 13 191]]

2023-08-18 08:42:08,708 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: services iteration: 0
2023-08-18 08:42:08,708 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:08,708 - INFO - ***********************************
2023-08-18 08:42:08,708 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: software
2023-08-18 08:42:08,750 - INFO - TEST data count: 295
2023-08-18 08:42:15,140 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:15,868 - INFO - Metrics from the Predictions...
2023-08-18 08:42:15,868 - INFO - {'test_loss': 0.3896048367023468, 'test_accuracy': 0.8542372881355932, 'test_precision': 0.8401826484018264, 'test_recall': 0.9583333333333334, 'test_f1': 0.8953771289537713, 'test_roc_auc': 0.8092637540453075, 'test_matthews_correlation': 0.6742165239079909, 'test_runtime': 0.5178, 'test_samples_per_second': 569.712, 'test_steps_per_second': 71.455}
2023-08-18 08:42:15,868 - INFO - {'confusion_matrix': array([[ 68,  35],
       [  8, 184]])}
2023-08-18 08:42:15,868 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	software	0	3e-05	0.3896048367023468	0.8542372881355932	0.8401826484018264	0.9583333333333334	0.8953771289537713	0.8092637540453075	0.6742165239079909	0.5178	569.712	71.455
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	software	0	3e-05	[[ 68  35]
 [  8 184]]

2023-08-18 08:42:15,868 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: software iteration: 0
2023-08-18 08:42:15,868 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:15,868 - INFO - ***********************************
2023-08-18 08:42:15,868 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: transport
2023-08-18 08:42:15,908 - INFO - TEST data count: 247
2023-08-18 08:42:17,054 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:17,664 - INFO - Metrics from the Predictions...
2023-08-18 08:42:17,664 - INFO - {'test_loss': 0.5190349817276001, 'test_accuracy': 0.7773279352226721, 'test_precision': 0.7318435754189944, 'test_recall': 0.9492753623188406, 'test_f1': 0.8264984227129336, 'test_roc_auc': 0.7544541949208882, 'test_matthews_correlation': 0.5657328938787843, 'test_runtime': 0.451, 'test_samples_per_second': 547.701, 'test_steps_per_second': 68.74}
2023-08-18 08:42:17,664 - INFO - {'confusion_matrix': array([[ 61,  48],
       [  7, 131]])}
2023-08-18 08:42:17,664 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	transport	0	3e-05	0.5190349817276001	0.7773279352226721	0.7318435754189944	0.9492753623188406	0.8264984227129336	0.7544541949208882	0.5657328938787843	0.451	547.701	68.74
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	transport	0	3e-05	[[ 61  48]
 [  7 131]]

2023-08-18 08:42:17,664 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: transport iteration: 0
2023-08-18 08:42:17,664 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:17,664 - INFO - ***********************************
2023-08-18 08:42:17,664 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: electronics
2023-08-18 08:42:17,709 - INFO - TEST data count: 290
2023-08-18 08:42:18,868 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:19,534 - INFO - Metrics from the Predictions...
2023-08-18 08:42:19,534 - INFO - {'test_loss': 0.4710841774940491, 'test_accuracy': 0.7724137931034483, 'test_precision': 0.7477477477477478, 'test_recall': 0.9431818181818182, 'test_f1': 0.8341708542713568, 'test_roc_auc': 0.7259768740031899, 'test_matthews_correlation': 0.5210408915684037, 'test_runtime': 0.5105, 'test_samples_per_second': 568.115, 'test_steps_per_second': 72.484}
2023-08-18 08:42:19,534 - INFO - {'confusion_matrix': array([[ 58,  56],
       [ 10, 166]])}
2023-08-18 08:42:19,534 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	electronics	0	3e-05	0.4710841774940491	0.7724137931034483	0.7477477477477478	0.9431818181818182	0.8341708542713568	0.7259768740031899	0.5210408915684037	0.5105	568.115	72.484
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	electronics	0	3e-05	[[ 58  56]
 [ 10 166]]

2023-08-18 08:42:19,534 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:42:19,535 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:19,535 - INFO - ***********************************
2023-08-18 08:42:19,535 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: other
2023-08-18 08:42:19,573 - INFO - TEST data count: 128
2023-08-18 08:42:20,720 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:21,118 - INFO - Metrics from the Predictions...
2023-08-18 08:42:21,118 - INFO - {'test_loss': 0.3608904778957367, 'test_accuracy': 0.859375, 'test_precision': 0.8532110091743119, 'test_recall': 0.9789473684210527, 'test_f1': 0.911764705882353, 'test_roc_auc': 0.7470494417862839, 'test_matthews_correlation': 0.6079146307564401, 'test_runtime': 0.241, 'test_samples_per_second': 531.227, 'test_steps_per_second': 66.403}
2023-08-18 08:42:21,118 - INFO - {'confusion_matrix': array([[17, 16],
       [ 2, 93]])}
2023-08-18 08:42:21,118 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	other	0	3e-05	0.3608904778957367	0.859375	0.8532110091743119	0.9789473684210527	0.911764705882353	0.7470494417862839	0.6079146307564401	0.241	531.227	66.403
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	other	0	3e-05	[[17 16]
 [ 2 93]]

2023-08-18 08:42:21,118 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: other iteration: 0
2023-08-18 08:42:21,118 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:21,118 - INFO - **********************************************************************
2023-08-18 08:42:21,118 - INFO - Iteration number: 1 for TRAIN DOMAIN: retail
2023-08-18 08:42:21,118 - INFO - Tokenizing the data...
2023-08-18 08:42:28,027 - INFO - TRAIN data count: 131 and DEV data count: 66
2023-08-18 08:42:28,028 - INFO - Finetune and perform evaluation...
2023-08-18 08:42:28,028 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:42:28,028 - INFO - Setting up training args and starting training...
2023-08-18 08:42:46,727 - INFO - Training complete...
2023-08-18 08:42:46,727 - INFO - TrainOutput(global_step=68, training_loss=0.5614661048440373, metrics={'train_runtime': 17.0293, 'train_samples_per_second': 30.771, 'train_steps_per_second': 3.993, 'total_flos': 13463886036000.0, 'train_loss': 0.5614661048440373, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:42:46,727 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:42:47,634 - INFO - Report evaluation results...
2023-08-18 08:42:47,635 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	retail	na	1	3e-05	0.6332203149795532	0.6212121212121212	0.6212121212121212	1.0	0.766355140186916	0.5	0.0	0.164	402.521	54.889	2.25e-05	1.0	17
vinai/bertweet-base	retail	na	1	3e-05	0.5829771161079407	0.6363636363636364	0.639344262295082	0.9512195121951219	0.7647058823529412	0.535609756097561	0.1305602604445819	0.1373	480.663	65.545	1.5e-05	2.0	34
vinai/bertweet-base	retail	na	1	3e-05	0.5022786259651184	0.6515151515151515	0.6607142857142857	0.9024390243902439	0.7628865979381443	0.571219512195122	0.19270674223218595	0.1373	480.821	65.567	7.5e-06	3.0	51
vinai/bertweet-base	retail	na	1	3e-05	0.4583820700645447	0.8181818181818182	0.8372093023255814	0.8780487804878049	0.8571428571428572	0.7990243902439024	0.6088361009458861	0.1407	468.967	63.95	0.0	4.0	68
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	retail	na	1	3e-05	17.0293	30.771	3.993	13463886036000.0	0.5614661048440373	0.0	4.0	68

2023-08-18 08:42:47,635 - INFO - Loading the finetuned model
2023-08-18 08:42:49,096 - INFO - ***********************************
2023-08-18 08:42:49,096 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: food
2023-08-18 08:42:49,154 - INFO - TEST data count: 127
2023-08-18 08:42:50,316 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:50,777 - INFO - Metrics from the Predictions...
2023-08-18 08:42:50,777 - INFO - {'test_loss': 0.48194620013237, 'test_accuracy': 0.8267716535433071, 'test_precision': 0.8977272727272727, 'test_recall': 0.8586956521739131, 'test_f1': 0.8777777777777778, 'test_roc_auc': 0.800776397515528, 'test_matthews_correlation': 0.5826772277522201, 'test_runtime': 0.2369, 'test_samples_per_second': 536.005, 'test_steps_per_second': 67.528}
2023-08-18 08:42:50,777 - INFO - {'confusion_matrix': array([[26,  9],
       [13, 79]])}
2023-08-18 08:42:50,778 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	food	1	3e-05	0.48194620013237	0.8267716535433071	0.8977272727272727	0.8586956521739131	0.8777777777777778	0.800776397515528	0.5826772277522201	0.2369	536.005	67.528
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	food	1	3e-05	[[26  9]
 [13 79]]

2023-08-18 08:42:50,778 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: food iteration: 1
2023-08-18 08:42:50,778 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:50,778 - INFO - ***********************************
2023-08-18 08:42:50,778 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: apparel
2023-08-18 08:42:50,818 - INFO - TEST data count: 262
2023-08-18 08:42:51,989 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:52,734 - INFO - Metrics from the Predictions...
2023-08-18 08:42:52,734 - INFO - {'test_loss': 0.5509111285209656, 'test_accuracy': 0.6984732824427481, 'test_precision': 0.6701030927835051, 'test_recall': 0.896551724137931, 'test_f1': 0.7669616519174042, 'test_roc_auc': 0.674771588564692, 'test_matthews_correlation': 0.39638977213558724, 'test_runtime': 0.5755, 'test_samples_per_second': 455.273, 'test_steps_per_second': 57.344}
2023-08-18 08:42:52,734 - INFO - {'confusion_matrix': array([[ 53,  64],
       [ 15, 130]])}
2023-08-18 08:42:52,735 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	apparel	1	3e-05	0.5509111285209656	0.6984732824427481	0.6701030927835051	0.896551724137931	0.7669616519174042	0.674771588564692	0.39638977213558724	0.5755	455.273	57.344
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	apparel	1	3e-05	[[ 53  64]
 [ 15 130]]

2023-08-18 08:42:52,735 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:42:52,735 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:52,735 - INFO - ***********************************
2023-08-18 08:42:52,735 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: cars
2023-08-18 08:42:52,771 - INFO - TEST data count: 93
2023-08-18 08:42:53,885 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:54,245 - INFO - Metrics from the Predictions...
2023-08-18 08:42:54,245 - INFO - {'test_loss': 0.44394031167030334, 'test_accuracy': 0.8172043010752689, 'test_precision': 0.8311688311688312, 'test_recall': 0.9411764705882353, 'test_f1': 0.8827586206896552, 'test_roc_auc': 0.7105882352941176, 'test_matthews_correlation': 0.49474704357638993, 'test_runtime': 0.1987, 'test_samples_per_second': 468.105, 'test_steps_per_second': 60.401}
2023-08-18 08:42:54,245 - INFO - {'confusion_matrix': array([[12, 13],
       [ 4, 64]])}
2023-08-18 08:42:54,246 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	cars	1	3e-05	0.44394031167030334	0.8172043010752689	0.8311688311688312	0.9411764705882353	0.8827586206896552	0.7105882352941176	0.49474704357638993	0.1987	468.105	60.401
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	cars	1	3e-05	[[12 13]
 [ 4 64]]

2023-08-18 08:42:54,246 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: cars iteration: 1
2023-08-18 08:42:54,246 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:54,246 - INFO - ***********************************
2023-08-18 08:42:54,246 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: retail
2023-08-18 08:42:54,246 - INFO - Train and test domains are the same: retail, hence skipping
2023-08-18 08:42:54,246 - INFO - ***********************************
2023-08-18 08:42:54,246 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: services
2023-08-18 08:42:54,307 - INFO - TEST data count: 335
2023-08-18 08:42:55,464 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:56,222 - INFO - Metrics from the Predictions...
2023-08-18 08:42:56,222 - INFO - {'test_loss': 0.5500162839889526, 'test_accuracy': 0.7074626865671642, 'test_precision': 0.712, 'test_recall': 0.8725490196078431, 'test_f1': 0.7841409691629956, 'test_roc_auc': 0.661465349498578, 'test_matthews_correlation': 0.36214341860620114, 'test_runtime': 0.5883, 'test_samples_per_second': 569.438, 'test_steps_per_second': 71.392}
2023-08-18 08:42:56,222 - INFO - {'confusion_matrix': array([[ 59,  72],
       [ 26, 178]])}
2023-08-18 08:42:56,222 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	services	1	3e-05	0.5500162839889526	0.7074626865671642	0.712	0.8725490196078431	0.7841409691629956	0.661465349498578	0.36214341860620114	0.5883	569.438	71.392
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	services	1	3e-05	[[ 59  72]
 [ 26 178]]

2023-08-18 08:42:56,222 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: services iteration: 1
2023-08-18 08:42:56,222 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:56,222 - INFO - ***********************************
2023-08-18 08:42:56,223 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: software
2023-08-18 08:42:56,260 - INFO - TEST data count: 295
2023-08-18 08:42:57,381 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:58,054 - INFO - Metrics from the Predictions...
2023-08-18 08:42:58,054 - INFO - {'test_loss': 0.4732593595981598, 'test_accuracy': 0.7898305084745763, 'test_precision': 0.7777777777777778, 'test_recall': 0.9479166666666666, 'test_f1': 0.8544600938967136, 'test_roc_auc': 0.721531148867314, 'test_matthews_correlation': 0.5215082413405384, 'test_runtime': 0.5261, 'test_samples_per_second': 560.698, 'test_steps_per_second': 70.325}
2023-08-18 08:42:58,054 - INFO - {'confusion_matrix': array([[ 51,  52],
       [ 10, 182]])}
2023-08-18 08:42:58,054 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	software	1	3e-05	0.4732593595981598	0.7898305084745763	0.7777777777777778	0.9479166666666666	0.8544600938967136	0.721531148867314	0.5215082413405384	0.5261	560.698	70.325
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	software	1	3e-05	[[ 51  52]
 [ 10 182]]

2023-08-18 08:42:58,054 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: software iteration: 1
2023-08-18 08:42:58,054 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:58,055 - INFO - ***********************************
2023-08-18 08:42:58,055 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: transport
2023-08-18 08:42:58,095 - INFO - TEST data count: 247
2023-08-18 08:42:59,283 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:42:59,899 - INFO - Metrics from the Predictions...
2023-08-18 08:42:59,899 - INFO - {'test_loss': 0.5719908475875854, 'test_accuracy': 0.6963562753036437, 'test_precision': 0.6740331491712708, 'test_recall': 0.8840579710144928, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.6713867836723839, 'test_matthews_correlation': 0.38463505386723945, 'test_runtime': 0.4465, 'test_samples_per_second': 553.161, 'test_steps_per_second': 69.425}
2023-08-18 08:42:59,899 - INFO - {'confusion_matrix': array([[ 50,  59],
       [ 16, 122]])}
2023-08-18 08:42:59,899 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	transport	1	3e-05	0.5719908475875854	0.6963562753036437	0.6740331491712708	0.8840579710144928	0.7648902821316614	0.6713867836723839	0.38463505386723945	0.4465	553.161	69.425
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	transport	1	3e-05	[[ 50  59]
 [ 16 122]]

2023-08-18 08:42:59,899 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: transport iteration: 1
2023-08-18 08:42:59,899 - INFO - ----------------------------------------------------------------------
2023-08-18 08:42:59,899 - INFO - ***********************************
2023-08-18 08:42:59,899 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: electronics
2023-08-18 08:42:59,940 - INFO - TEST data count: 290
2023-08-18 08:43:06,207 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:43:06,877 - INFO - Metrics from the Predictions...
2023-08-18 08:43:06,877 - INFO - {'test_loss': 0.5234834551811218, 'test_accuracy': 0.7310344827586207, 'test_precision': 0.7130434782608696, 'test_recall': 0.9318181818181818, 'test_f1': 0.8078817733990147, 'test_roc_auc': 0.6764354066985645, 'test_matthews_correlation': 0.4254856865771226, 'test_runtime': 0.5123, 'test_samples_per_second': 566.036, 'test_steps_per_second': 72.218}
2023-08-18 08:43:06,877 - INFO - {'confusion_matrix': array([[ 48,  66],
       [ 12, 164]])}
2023-08-18 08:43:06,877 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	electronics	1	3e-05	0.5234834551811218	0.7310344827586207	0.7130434782608696	0.9318181818181818	0.8078817733990147	0.6764354066985645	0.4254856865771226	0.5123	566.036	72.218
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	electronics	1	3e-05	[[ 48  66]
 [ 12 164]]

2023-08-18 08:43:06,877 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:43:06,877 - INFO - ----------------------------------------------------------------------
2023-08-18 08:43:06,878 - INFO - ***********************************
2023-08-18 08:43:06,878 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: other
2023-08-18 08:43:06,917 - INFO - TEST data count: 128
2023-08-18 08:43:08,082 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:43:08,480 - INFO - Metrics from the Predictions...
2023-08-18 08:43:08,480 - INFO - {'test_loss': 0.4215027987957001, 'test_accuracy': 0.7890625, 'test_precision': 0.788135593220339, 'test_recall': 0.9789473684210527, 'test_f1': 0.8732394366197183, 'test_roc_auc': 0.6106858054226475, 'test_matthews_correlation': 0.36082755391826665, 'test_runtime': 0.2391, 'test_samples_per_second': 535.307, 'test_steps_per_second': 66.913}
2023-08-18 08:43:08,480 - INFO - {'confusion_matrix': array([[ 8, 25],
       [ 2, 93]])}
2023-08-18 08:43:08,480 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	other	1	3e-05	0.4215027987957001	0.7890625	0.788135593220339	0.9789473684210527	0.8732394366197183	0.6106858054226475	0.36082755391826665	0.2391	535.307	66.913
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	other	1	3e-05	[[ 8 25]
 [ 2 93]]

2023-08-18 08:43:08,481 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: other iteration: 1
2023-08-18 08:43:08,481 - INFO - ----------------------------------------------------------------------
2023-08-18 08:43:08,481 - INFO - **********************************************************************
2023-08-18 08:43:08,481 - INFO - Iteration number: 2 for TRAIN DOMAIN: retail
2023-08-18 08:43:08,481 - INFO - Tokenizing the data...
2023-08-18 08:43:10,338 - INFO - TRAIN data count: 132 and DEV data count: 65
2023-08-18 08:43:10,338 - INFO - Finetune and perform evaluation...
2023-08-18 08:43:10,338 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:43:10,338 - INFO - Setting up training args and starting training...
2023-08-18 08:43:28,900 - INFO - Training complete...
2023-08-18 08:43:28,900 - INFO - TrainOutput(global_step=68, training_loss=0.5388525233549231, metrics={'train_runtime': 16.9257, 'train_samples_per_second': 31.195, 'train_steps_per_second': 4.018, 'total_flos': 13566663792000.0, 'train_loss': 0.5388525233549231, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:43:28,900 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:43:29,760 - INFO - Report evaluation results...
2023-08-18 08:43:29,761 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	retail	na	2	3e-05	0.6291136145591736	0.6153846153846154	0.6153846153846154	1.0	0.761904761904762	0.5	0.0	0.1339	485.346	67.202	2.25e-05	1.0	17
vinai/bertweet-base	retail	na	2	3e-05	0.6071363687515259	0.676923076923077	0.6610169491525424	0.975	0.7878787878787878	0.5874999999999999	0.2941280323856063	0.1366	475.769	65.876	1.5e-05	2.0	34
vinai/bertweet-base	retail	na	2	3e-05	0.5323963165283203	0.7692307692307693	0.7551020408163265	0.925	0.8314606741573034	0.7225	0.5025762709910461	0.1354	480.0	66.461	7.5e-06	3.0	51
vinai/bertweet-base	retail	na	2	3e-05	0.5195862054824829	0.7692307692307693	0.7450980392156863	0.95	0.8351648351648352	0.715	0.5088846484559872	0.1349	481.9	66.725	0.0	4.0	68
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	retail	na	2	3e-05	16.9257	31.195	4.018	13566663792000.0	0.5388525233549231	0.0	4.0	68

2023-08-18 08:43:29,761 - INFO - Loading the finetuned model
2023-08-18 08:43:30,774 - INFO - ***********************************
2023-08-18 08:43:30,774 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: food
2023-08-18 08:43:35,825 - INFO - TEST data count: 127
2023-08-18 08:43:42,258 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:43:42,739 - INFO - Metrics from the Predictions...
2023-08-18 08:43:42,739 - INFO - {'test_loss': 0.38828885555267334, 'test_accuracy': 0.8582677165354331, 'test_precision': 0.8775510204081632, 'test_recall': 0.9347826086956522, 'test_f1': 0.9052631578947369, 'test_roc_auc': 0.7959627329192547, 'test_matthews_correlation': 0.630061472233043, 'test_runtime': 0.2332, 'test_samples_per_second': 544.697, 'test_steps_per_second': 68.623}
2023-08-18 08:43:42,739 - INFO - {'confusion_matrix': array([[23, 12],
       [ 6, 86]])}
2023-08-18 08:43:42,739 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	food	2	3e-05	0.38828885555267334	0.8582677165354331	0.8775510204081632	0.9347826086956522	0.9052631578947369	0.7959627329192547	0.630061472233043	0.2332	544.697	68.623
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	food	2	3e-05	[[23 12]
 [ 6 86]]

2023-08-18 08:43:42,739 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: food iteration: 2
2023-08-18 08:43:42,739 - INFO - ----------------------------------------------------------------------
2023-08-18 08:43:42,739 - INFO - ***********************************
2023-08-18 08:43:42,739 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: apparel
2023-08-18 08:43:42,778 - INFO - TEST data count: 262
2023-08-18 08:43:43,935 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:43:44,643 - INFO - Metrics from the Predictions...
2023-08-18 08:43:44,643 - INFO - {'test_loss': 0.5570290684700012, 'test_accuracy': 0.7099236641221374, 'test_precision': 0.6699507389162561, 'test_recall': 0.9379310344827586, 'test_f1': 0.7816091954022988, 'test_roc_auc': 0.682640730916593, 'test_matthews_correlation': 0.43474093930747826, 'test_runtime': 0.4589, 'test_samples_per_second': 570.913, 'test_steps_per_second': 71.909}
2023-08-18 08:43:44,644 - INFO - {'confusion_matrix': array([[ 50,  67],
       [  9, 136]])}
2023-08-18 08:43:44,644 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	apparel	2	3e-05	0.5570290684700012	0.7099236641221374	0.6699507389162561	0.9379310344827586	0.7816091954022988	0.682640730916593	0.43474093930747826	0.4589	570.913	71.909
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	apparel	2	3e-05	[[ 50  67]
 [  9 136]]

2023-08-18 08:43:44,644 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:43:44,644 - INFO - ----------------------------------------------------------------------
2023-08-18 08:43:44,644 - INFO - ***********************************
2023-08-18 08:43:44,644 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: cars
2023-08-18 08:43:44,683 - INFO - TEST data count: 93
2023-08-18 08:43:45,842 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:43:46,182 - INFO - Metrics from the Predictions...
2023-08-18 08:43:46,182 - INFO - {'test_loss': 0.41004496812820435, 'test_accuracy': 0.8064516129032258, 'test_precision': 0.8125, 'test_recall': 0.9558823529411765, 'test_f1': 0.8783783783783784, 'test_roc_auc': 0.6779411764705883, 'test_matthews_correlation': 0.45500298343211626, 'test_runtime': 0.1842, 'test_samples_per_second': 505.007, 'test_steps_per_second': 65.162}
2023-08-18 08:43:46,182 - INFO - {'confusion_matrix': array([[10, 15],
       [ 3, 65]])}
2023-08-18 08:43:46,182 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	cars	2	3e-05	0.41004496812820435	0.8064516129032258	0.8125	0.9558823529411765	0.8783783783783784	0.6779411764705883	0.45500298343211626	0.1842	505.007	65.162
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	cars	2	3e-05	[[10 15]
 [ 3 65]]

2023-08-18 08:43:46,182 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: cars iteration: 2
2023-08-18 08:43:46,183 - INFO - ----------------------------------------------------------------------
2023-08-18 08:43:46,183 - INFO - ***********************************
2023-08-18 08:43:46,183 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: retail
2023-08-18 08:43:46,183 - INFO - Train and test domains are the same: retail, hence skipping
2023-08-18 08:43:46,183 - INFO - ***********************************
2023-08-18 08:43:46,183 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: services
2023-08-18 08:43:46,225 - INFO - TEST data count: 335
2023-08-18 08:43:47,407 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:43:48,158 - INFO - Metrics from the Predictions...
2023-08-18 08:43:48,158 - INFO - {'test_loss': 0.5410265326499939, 'test_accuracy': 0.7492537313432835, 'test_precision': 0.734375, 'test_recall': 0.9215686274509803, 'test_f1': 0.8173913043478261, 'test_roc_auc': 0.7012423289926657, 'test_matthews_correlation': 0.46266487937780937, 'test_runtime': 0.586, 'test_samples_per_second': 571.664, 'test_steps_per_second': 71.671}
2023-08-18 08:43:48,158 - INFO - {'confusion_matrix': array([[ 63,  68],
       [ 16, 188]])}
2023-08-18 08:43:48,158 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	services	2	3e-05	0.5410265326499939	0.7492537313432835	0.734375	0.9215686274509803	0.8173913043478261	0.7012423289926657	0.46266487937780937	0.586	571.664	71.671
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	services	2	3e-05	[[ 63  68]
 [ 16 188]]

2023-08-18 08:43:48,158 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: services iteration: 2
2023-08-18 08:43:48,158 - INFO - ----------------------------------------------------------------------
2023-08-18 08:43:48,158 - INFO - ***********************************
2023-08-18 08:43:48,158 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: software
2023-08-18 08:43:48,196 - INFO - TEST data count: 295
2023-08-18 08:43:59,353 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:00,038 - INFO - Metrics from the Predictions...
2023-08-18 08:44:00,038 - INFO - {'test_loss': 0.45161116123199463, 'test_accuracy': 0.7932203389830509, 'test_precision': 0.7811158798283262, 'test_recall': 0.9479166666666666, 'test_f1': 0.8564705882352941, 'test_roc_auc': 0.7263855177993527, 'test_matthews_correlation': 0.5297537724694156, 'test_runtime': 0.5081, 'test_samples_per_second': 580.549, 'test_steps_per_second': 72.815}
2023-08-18 08:44:00,038 - INFO - {'confusion_matrix': array([[ 52,  51],
       [ 10, 182]])}
2023-08-18 08:44:00,038 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	software	2	3e-05	0.45161116123199463	0.7932203389830509	0.7811158798283262	0.9479166666666666	0.8564705882352941	0.7263855177993527	0.5297537724694156	0.5081	580.549	72.815
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	software	2	3e-05	[[ 52  51]
 [ 10 182]]

2023-08-18 08:44:00,038 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: software iteration: 2
2023-08-18 08:44:00,038 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:00,038 - INFO - ***********************************
2023-08-18 08:44:00,038 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: transport
2023-08-18 08:44:00,077 - INFO - TEST data count: 247
2023-08-18 08:44:06,336 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:11,952 - INFO - Metrics from the Predictions...
2023-08-18 08:44:11,952 - INFO - {'test_loss': 0.5829002261161804, 'test_accuracy': 0.6963562753036437, 'test_precision': 0.6684491978609626, 'test_recall': 0.9057971014492754, 'test_f1': 0.7692307692307693, 'test_roc_auc': 0.668494880999867, 'test_matthews_correlation': 0.39018724692486195, 'test_runtime': 0.4237, 'test_samples_per_second': 582.909, 'test_steps_per_second': 73.159}
2023-08-18 08:44:11,952 - INFO - {'confusion_matrix': array([[ 47,  62],
       [ 13, 125]])}
2023-08-18 08:44:11,953 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	transport	2	3e-05	0.5829002261161804	0.6963562753036437	0.6684491978609626	0.9057971014492754	0.7692307692307693	0.668494880999867	0.39018724692486195	0.4237	582.909	73.159
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	transport	2	3e-05	[[ 47  62]
 [ 13 125]]

2023-08-18 08:44:11,953 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: transport iteration: 2
2023-08-18 08:44:11,953 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:11,953 - INFO - ***********************************
2023-08-18 08:44:11,953 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: electronics
2023-08-18 08:44:11,988 - INFO - TEST data count: 290
2023-08-18 08:44:13,106 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:13,789 - INFO - Metrics from the Predictions...
2023-08-18 08:44:13,789 - INFO - {'test_loss': 0.5190048813819885, 'test_accuracy': 0.7517241379310344, 'test_precision': 0.7300884955752213, 'test_recall': 0.9375, 'test_f1': 0.8208955223880597, 'test_roc_auc': 0.7012061403508771, 'test_matthews_correlation': 0.4739535482227382, 'test_runtime': 0.5005, 'test_samples_per_second': 579.449, 'test_steps_per_second': 73.93}
2023-08-18 08:44:13,789 - INFO - {'confusion_matrix': array([[ 53,  61],
       [ 11, 165]])}
2023-08-18 08:44:13,790 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	electronics	2	3e-05	0.5190048813819885	0.7517241379310344	0.7300884955752213	0.9375	0.8208955223880597	0.7012061403508771	0.4739535482227382	0.5005	579.449	73.93
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	electronics	2	3e-05	[[ 53  61]
 [ 11 165]]

2023-08-18 08:44:13,790 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:44:13,790 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:13,790 - INFO - ***********************************
2023-08-18 08:44:13,790 - INFO - For TRAIN domain: retail now testing with TEST DOMAIN: other
2023-08-18 08:44:13,827 - INFO - TEST data count: 128
2023-08-18 08:44:14,985 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:15,384 - INFO - Metrics from the Predictions...
2023-08-18 08:44:15,384 - INFO - {'test_loss': 0.40195995569229126, 'test_accuracy': 0.8046875, 'test_precision': 0.8017241379310345, 'test_recall': 0.9789473684210527, 'test_f1': 0.881516587677725, 'test_roc_auc': 0.6409888357256778, 'test_matthews_correlation': 0.4231690288583424, 'test_runtime': 0.2393, 'test_samples_per_second': 534.911, 'test_steps_per_second': 66.864}
2023-08-18 08:44:15,384 - INFO - {'confusion_matrix': array([[10, 23],
       [ 2, 93]])}
2023-08-18 08:44:15,384 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	retail	other	2	3e-05	0.40195995569229126	0.8046875	0.8017241379310345	0.9789473684210527	0.881516587677725	0.6409888357256778	0.4231690288583424	0.2393	534.911	66.864
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	retail	other	2	3e-05	[[10 23]
 [ 2 93]]

2023-08-18 08:44:15,384 - INFO - Finished testing for TRAIN DOMAIN: retail and TEST DOMAIN: other iteration: 2
2023-08-18 08:44:15,384 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:15,384 - INFO - Finished all iterations and all testing for TRAIN domain: retail
2023-08-18 08:44:15,384 - INFO - Calculating mean of test metrics for TRAIN domain: retail
2023-08-18 08:44:15,385 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	food	2	3e-05	0.42112783590952557	0.8398950131233596	0.888462727748442	0.891304347826087	0.8894289457706197	0.7980331262939959	0.6007847351566421	0.2338	543.2563333333334	68.44166666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	food	2	3e-05	24.666666666666668	10.333333333333334	10.0	82.0

2023-08-18 08:44:15,385 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	apparel	2	3e-05	0.5296900471051534	0.7277353689567431	0.6957267561604569	0.9103448275862069	0.7878726230877588	0.7058846645053541	0.45966282124169683	0.5002333333333334	529.3653333333333	66.676
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	apparel	2	3e-05	58.666666666666664	58.333333333333336	13.0	132.0

2023-08-18 08:44:15,386 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	cars	2	3e-05	0.41387208302815753	0.8243727598566308	0.8329773296878561	0.9509803921568628	0.8879715922819371	0.7154901960784313	0.5138358899876224	0.19056666666666666	488.57500000000005	63.042
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	cars	2	3e-05	12.0	13.0	3.3333333333333335	64.66666666666667

2023-08-18 08:44:15,386 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	services	2	3e-05	0.5320690870285034	0.7442786069651741	0.7337719038208168	0.9101307189542484	0.8124728293176117	0.6980679040063862	0.4500964636745357	0.5829666666666666	574.6973333333333	72.05133333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	services	2	3e-05	63.666666666666664	67.33333333333333	18.333333333333332	185.66666666666666

2023-08-18 08:44:15,386 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	software	2	3e-05	0.43815845251083374	0.8124293785310734	0.7996921020026434	0.9513888888888888	0.8687692703619264	0.752393473570658	0.5751595125726482	0.5173333333333333	570.3196666666666	71.53166666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	software	2	3e-05	57.0	46.0	9.333333333333334	182.66666666666666

2023-08-18 08:44:15,387 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	transport	2	3e-05	0.5579753518104553	0.7233468286099866	0.6914419741504093	0.9130434782608696	0.7868731580251214	0.698111953197713	0.44685173155696195	0.44039999999999996	561.2570000000001	70.44133333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	transport	2	3e-05	52.666666666666664	56.333333333333336	12.0	126.0

2023-08-18 08:44:15,387 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	electronics	2	3e-05	0.5045241713523865	0.7517241379310344	0.7302932405279462	0.9375	0.8209827166861438	0.7012061403508771	0.47349337545608816	0.5077666666666666	571.1999999999999	72.87733333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	electronics	2	3e-05	53.0	61.0	11.0	165.0

2023-08-18 08:44:15,387 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	retail	other	2	3e-05	0.394784410794576	0.8177083333333334	0.8143569134418952	0.9789473684210527	0.8888402433932655	0.6662413609782031	0.46397040451101645	0.2398	533.815	66.72666666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	retail	other	2	3e-05	11.666666666666666	21.333333333333332	2.0	93.0

2023-08-18 08:44:15,387 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:44:15,597 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:44:15,597 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:44:15,597 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:44:15,597 - INFO - ********************************************************************************************************************************************
2023-08-18 08:44:15,597 - INFO - TRAIN DOMAIN: services
2023-08-18 08:44:15,638 - INFO - Overall data count for train and dev: 335
2023-08-18 08:44:15,639 - INFO - **********************************************************************
2023-08-18 08:44:15,639 - INFO - Iteration number: 0 for TRAIN DOMAIN: services
2023-08-18 08:44:15,639 - INFO - Tokenizing the data...
2023-08-18 08:44:17,487 - INFO - TRAIN data count: 223 and DEV data count: 112
2023-08-18 08:44:17,488 - INFO - Finetune and perform evaluation...
2023-08-18 08:44:17,488 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:44:17,488 - INFO - Setting up training args and starting training...
2023-08-18 08:44:38,210 - INFO - Training complete...
2023-08-18 08:44:38,210 - INFO - TrainOutput(global_step=112, training_loss=0.42532617705208914, metrics={'train_runtime': 18.5566, 'train_samples_per_second': 48.069, 'train_steps_per_second': 6.036, 'total_flos': 22919439588000.0, 'train_loss': 0.42532617705208914, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:44:38,210 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:44:39,102 - INFO - Report evaluation results...
2023-08-18 08:44:39,102 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	services	na	0	3e-05	0.6299499869346619	0.6517857142857143	0.6355140186915887	1.0	0.777142857142857	0.5568181818181819	0.2687331429579243	0.2063	542.781	67.848	2.25e-05	1.0	28
vinai/bertweet-base	services	na	0	3e-05	0.47535234689712524	0.7946428571428571	0.7647058823529411	0.9558823529411765	0.849673202614379	0.750668449197861	0.572425694236414	0.253	442.703	55.338	1.5e-05	2.0	56
vinai/bertweet-base	services	na	0	3e-05	0.3210819661617279	0.8928571428571429	0.9516129032258065	0.8676470588235294	0.9076923076923077	0.8997326203208557	0.7854156195032467	0.2116	529.337	66.167	7.5e-06	3.0	84
vinai/bertweet-base	services	na	0	3e-05	0.3730042576789856	0.8392857142857143	0.8289473684210527	0.9264705882352942	0.875	0.8155080213903744	0.6598772393723595	0.2091	535.502	66.938	0.0	4.0	112
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	services	na	0	3e-05	18.5566	48.069	6.036	22919439588000.0	0.42532617705208914	0.0	4.0	112

2023-08-18 08:44:39,102 - INFO - Loading the finetuned model
2023-08-18 08:44:40,272 - INFO - ***********************************
2023-08-18 08:44:40,272 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: food
2023-08-18 08:44:40,316 - INFO - TEST data count: 127
2023-08-18 08:44:41,494 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:41,968 - INFO - Metrics from the Predictions...
2023-08-18 08:44:41,969 - INFO - {'test_loss': 0.5436739921569824, 'test_accuracy': 0.6929133858267716, 'test_precision': 0.9818181818181818, 'test_recall': 0.5869565217391305, 'test_f1': 0.7346938775510203, 'test_roc_auc': 0.7791925465838508, 'test_matthews_correlation': 0.5035170238552039, 'test_runtime': 0.239, 'test_samples_per_second': 531.433, 'test_steps_per_second': 66.952}
2023-08-18 08:44:41,969 - INFO - {'confusion_matrix': array([[34,  1],
       [38, 54]])}
2023-08-18 08:44:41,969 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	food	0	3e-05	0.5436739921569824	0.6929133858267716	0.9818181818181818	0.5869565217391305	0.7346938775510203	0.7791925465838508	0.5035170238552039	0.239	531.433	66.952
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	food	0	3e-05	[[34  1]
 [38 54]]

2023-08-18 08:44:41,969 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: food iteration: 0
2023-08-18 08:44:41,969 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:41,969 - INFO - ***********************************
2023-08-18 08:44:41,969 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: apparel
2023-08-18 08:44:42,022 - INFO - TEST data count: 262
2023-08-18 08:44:43,400 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:44,030 - INFO - Metrics from the Predictions...
2023-08-18 08:44:44,030 - INFO - {'test_loss': 0.4232165515422821, 'test_accuracy': 0.816793893129771, 'test_precision': 0.9532710280373832, 'test_recall': 0.7034482758620689, 'test_f1': 0.8095238095238095, 'test_roc_auc': 0.8303566165635132, 'test_matthews_correlation': 0.6682395858622908, 'test_runtime': 0.4745, 'test_samples_per_second': 552.215, 'test_steps_per_second': 69.554}
2023-08-18 08:44:44,030 - INFO - {'confusion_matrix': array([[112,   5],
       [ 43, 102]])}
2023-08-18 08:44:44,030 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	apparel	0	3e-05	0.4232165515422821	0.816793893129771	0.9532710280373832	0.7034482758620689	0.8095238095238095	0.8303566165635132	0.6682395858622908	0.4745	552.215	69.554
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	apparel	0	3e-05	[[112   5]
 [ 43 102]]

2023-08-18 08:44:44,030 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:44:44,030 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:44,030 - INFO - ***********************************
2023-08-18 08:44:44,030 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: cars
2023-08-18 08:44:44,068 - INFO - TEST data count: 93
2023-08-18 08:44:45,171 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:45,525 - INFO - Metrics from the Predictions...
2023-08-18 08:44:45,525 - INFO - {'test_loss': 0.4462089240550995, 'test_accuracy': 0.7956989247311828, 'test_precision': 0.9298245614035088, 'test_recall': 0.7794117647058824, 'test_f1': 0.8479999999999999, 'test_roc_auc': 0.8097058823529412, 'test_matthews_correlation': 0.5637872268433393, 'test_runtime': 0.1837, 'test_samples_per_second': 506.318, 'test_steps_per_second': 65.331}
2023-08-18 08:44:45,525 - INFO - {'confusion_matrix': array([[21,  4],
       [15, 53]])}
2023-08-18 08:44:45,526 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	cars	0	3e-05	0.4462089240550995	0.7956989247311828	0.9298245614035088	0.7794117647058824	0.8479999999999999	0.8097058823529412	0.5637872268433393	0.1837	506.318	65.331
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	cars	0	3e-05	[[21  4]
 [15 53]]

2023-08-18 08:44:45,526 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: cars iteration: 0
2023-08-18 08:44:45,526 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:45,526 - INFO - ***********************************
2023-08-18 08:44:45,526 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: retail
2023-08-18 08:44:45,564 - INFO - TEST data count: 197
2023-08-18 08:44:46,786 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:47,305 - INFO - Metrics from the Predictions...
2023-08-18 08:44:47,305 - INFO - {'test_loss': 0.46587130427360535, 'test_accuracy': 0.7817258883248731, 'test_precision': 0.9759036144578314, 'test_recall': 0.6639344262295082, 'test_f1': 0.7902439024390244, 'test_roc_auc': 0.8186338797814208, 'test_matthews_correlation': 0.6266730560785679, 'test_runtime': 0.3585, 'test_samples_per_second': 549.489, 'test_steps_per_second': 69.732}
2023-08-18 08:44:47,305 - INFO - {'confusion_matrix': array([[73,  2],
       [41, 81]])}
2023-08-18 08:44:47,305 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	retail	0	3e-05	0.46587130427360535	0.7817258883248731	0.9759036144578314	0.6639344262295082	0.7902439024390244	0.8186338797814208	0.6266730560785679	0.3585	549.489	69.732
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	retail	0	3e-05	[[73  2]
 [41 81]]

2023-08-18 08:44:47,305 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: retail iteration: 0
2023-08-18 08:44:47,305 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:47,305 - INFO - ***********************************
2023-08-18 08:44:47,305 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: services
2023-08-18 08:44:47,305 - INFO - Train and test domains are the same: services, hence skipping
2023-08-18 08:44:47,305 - INFO - ***********************************
2023-08-18 08:44:47,305 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: software
2023-08-18 08:44:47,373 - INFO - TEST data count: 295
2023-08-18 08:44:48,533 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:49,477 - INFO - Metrics from the Predictions...
2023-08-18 08:44:49,478 - INFO - {'test_loss': 0.3824465274810791, 'test_accuracy': 0.8338983050847457, 'test_precision': 0.9612903225806452, 'test_recall': 0.7760416666666666, 'test_f1': 0.8587896253602305, 'test_roc_auc': 0.8588946197411003, 'test_matthews_correlation': 0.6852298969877183, 'test_runtime': 0.7933, 'test_samples_per_second': 371.863, 'test_steps_per_second': 46.64}
2023-08-18 08:44:49,478 - INFO - {'confusion_matrix': array([[ 97,   6],
       [ 43, 149]])}
2023-08-18 08:44:49,478 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	software	0	3e-05	0.3824465274810791	0.8338983050847457	0.9612903225806452	0.7760416666666666	0.8587896253602305	0.8588946197411003	0.6852298969877183	0.7933	371.863	46.64
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	software	0	3e-05	[[ 97   6]
 [ 43 149]]

2023-08-18 08:44:49,478 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: software iteration: 0
2023-08-18 08:44:49,478 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:49,478 - INFO - ***********************************
2023-08-18 08:44:49,478 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: transport
2023-08-18 08:44:49,519 - INFO - TEST data count: 247
2023-08-18 08:44:50,675 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:56,313 - INFO - Metrics from the Predictions...
2023-08-18 08:44:56,313 - INFO - {'test_loss': 0.45219334959983826, 'test_accuracy': 0.7894736842105263, 'test_precision': 0.9134615384615384, 'test_recall': 0.6884057971014492, 'test_f1': 0.7851239669421487, 'test_roc_auc': 0.8029184948809999, 'test_matthews_correlation': 0.6092897747096211, 'test_runtime': 0.4665, 'test_samples_per_second': 529.462, 'test_steps_per_second': 66.451}
2023-08-18 08:44:56,313 - INFO - {'confusion_matrix': array([[100,   9],
       [ 43,  95]])}
2023-08-18 08:44:56,314 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	transport	0	3e-05	0.45219334959983826	0.7894736842105263	0.9134615384615384	0.6884057971014492	0.7851239669421487	0.8029184948809999	0.6092897747096211	0.4665	529.462	66.451
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	transport	0	3e-05	[[100   9]
 [ 43  95]]

2023-08-18 08:44:56,314 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: transport iteration: 0
2023-08-18 08:44:56,314 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:56,314 - INFO - ***********************************
2023-08-18 08:44:56,314 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: electronics
2023-08-18 08:44:56,434 - INFO - TEST data count: 290
2023-08-18 08:44:57,842 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:44:58,520 - INFO - Metrics from the Predictions...
2023-08-18 08:44:58,520 - INFO - {'test_loss': 0.38595154881477356, 'test_accuracy': 0.8379310344827586, 'test_precision': 0.9387755102040817, 'test_recall': 0.7840909090909091, 'test_f1': 0.8544891640866873, 'test_roc_auc': 0.8525717703349283, 'test_matthews_correlation': 0.6889054261234211, 'test_runtime': 0.5103, 'test_samples_per_second': 568.319, 'test_steps_per_second': 72.51}
2023-08-18 08:44:58,520 - INFO - {'confusion_matrix': array([[105,   9],
       [ 38, 138]])}
2023-08-18 08:44:58,520 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	electronics	0	3e-05	0.38595154881477356	0.8379310344827586	0.9387755102040817	0.7840909090909091	0.8544891640866873	0.8525717703349283	0.6889054261234211	0.5103	568.319	72.51
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	electronics	0	3e-05	[[105   9]
 [ 38 138]]

2023-08-18 08:44:58,521 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:44:58,521 - INFO - ----------------------------------------------------------------------
2023-08-18 08:44:58,521 - INFO - ***********************************
2023-08-18 08:44:58,521 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: other
2023-08-18 08:44:58,567 - INFO - TEST data count: 128
2023-08-18 08:44:59,664 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:00,058 - INFO - Metrics from the Predictions...
2023-08-18 08:45:00,058 - INFO - {'test_loss': 0.33640941977500916, 'test_accuracy': 0.84375, 'test_precision': 1.0, 'test_recall': 0.7894736842105263, 'test_f1': 0.8823529411764706, 'test_roc_auc': 0.8947368421052632, 'test_matthews_correlation': 0.701112748703968, 'test_runtime': 0.2399, 'test_samples_per_second': 533.586, 'test_steps_per_second': 66.698}
2023-08-18 08:45:00,059 - INFO - {'confusion_matrix': array([[33,  0],
       [20, 75]])}
2023-08-18 08:45:00,059 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	other	0	3e-05	0.33640941977500916	0.84375	1.0	0.7894736842105263	0.8823529411764706	0.8947368421052632	0.701112748703968	0.2399	533.586	66.698
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	other	0	3e-05	[[33  0]
 [20 75]]

2023-08-18 08:45:00,059 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: other iteration: 0
2023-08-18 08:45:00,059 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:00,059 - INFO - **********************************************************************
2023-08-18 08:45:00,059 - INFO - Iteration number: 1 for TRAIN DOMAIN: services
2023-08-18 08:45:00,059 - INFO - Tokenizing the data...
2023-08-18 08:45:02,006 - INFO - TRAIN data count: 223 and DEV data count: 112
2023-08-18 08:45:02,006 - INFO - Finetune and perform evaluation...
2023-08-18 08:45:02,006 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:45:02,006 - INFO - Setting up training args and starting training...
2023-08-18 08:45:23,432 - INFO - Training complete...
2023-08-18 08:45:23,432 - INFO - TrainOutput(global_step=112, training_loss=0.5396129403795514, metrics={'train_runtime': 20.3308, 'train_samples_per_second': 43.874, 'train_steps_per_second': 5.509, 'total_flos': 22919439588000.0, 'train_loss': 0.5396129403795514, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:45:23,433 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:45:24,358 - INFO - Report evaluation results...
2023-08-18 08:45:24,359 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	services	na	1	3e-05	0.624485194683075	0.6517857142857143	0.6355140186915887	1.0	0.777142857142857	0.5568181818181819	0.2687331429579243	0.2045	547.79	68.474	2.25e-05	1.0	28
vinai/bertweet-base	services	na	1	3e-05	0.6008074879646301	0.6696428571428571	0.6476190476190476	1.0	0.7861271676300579	0.5795454545454546	0.32098333762097847	0.2049	546.562	68.32	1.5e-05	2.0	56
vinai/bertweet-base	services	na	1	3e-05	0.4562639594078064	0.8214285714285714	0.8636363636363636	0.8382352941176471	0.8507462686567164	0.8168449197860962	0.6290811250285762	0.205	546.361	68.295	7.5e-06	3.0	84
vinai/bertweet-base	services	na	1	3e-05	0.44707101583480835	0.8035714285714286	0.8108108108108109	0.8823529411764706	0.8450704225352113	0.7820855614973262	0.5819477447954117	0.2067	541.73	67.716	0.0	4.0	112
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	services	na	1	3e-05	20.3308	43.874	5.509	22919439588000.0	0.5396129403795514	0.0	4.0	112

2023-08-18 08:45:24,359 - INFO - Loading the finetuned model
2023-08-18 08:45:25,316 - INFO - ***********************************
2023-08-18 08:45:25,317 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: food
2023-08-18 08:45:25,375 - INFO - TEST data count: 127
2023-08-18 08:45:26,699 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:27,157 - INFO - Metrics from the Predictions...
2023-08-18 08:45:27,157 - INFO - {'test_loss': 0.3923046290874481, 'test_accuracy': 0.8188976377952756, 'test_precision': 0.96, 'test_recall': 0.782608695652174, 'test_f1': 0.8622754491017965, 'test_roc_auc': 0.848447204968944, 'test_matthews_correlation': 0.6332316495768356, 'test_runtime': 0.2343, 'test_samples_per_second': 542.006, 'test_steps_per_second': 68.284}
2023-08-18 08:45:27,157 - INFO - {'confusion_matrix': array([[32,  3],
       [20, 72]])}
2023-08-18 08:45:27,157 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	food	1	3e-05	0.3923046290874481	0.8188976377952756	0.96	0.782608695652174	0.8622754491017965	0.848447204968944	0.6332316495768356	0.2343	542.006	68.284
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	food	1	3e-05	[[32  3]
 [20 72]]

2023-08-18 08:45:27,157 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: food iteration: 1
2023-08-18 08:45:27,157 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:27,157 - INFO - ***********************************
2023-08-18 08:45:27,157 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: apparel
2023-08-18 08:45:27,214 - INFO - TEST data count: 262
2023-08-18 08:45:28,512 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:29,152 - INFO - Metrics from the Predictions...
2023-08-18 08:45:29,152 - INFO - {'test_loss': 0.4533287286758423, 'test_accuracy': 0.8244274809160306, 'test_precision': 0.8561151079136691, 'test_recall': 0.8206896551724138, 'test_f1': 0.8380281690140844, 'test_roc_auc': 0.8248747421161214, 'test_matthews_correlation': 0.6472363790603334, 'test_runtime': 0.4716, 'test_samples_per_second': 555.548, 'test_steps_per_second': 69.974}
2023-08-18 08:45:29,152 - INFO - {'confusion_matrix': array([[ 97,  20],
       [ 26, 119]])}
2023-08-18 08:45:29,152 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	apparel	1	3e-05	0.4533287286758423	0.8244274809160306	0.8561151079136691	0.8206896551724138	0.8380281690140844	0.8248747421161214	0.6472363790603334	0.4716	555.548	69.974
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	apparel	1	3e-05	[[ 97  20]
 [ 26 119]]

2023-08-18 08:45:29,152 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:45:29,152 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:29,152 - INFO - ***********************************
2023-08-18 08:45:29,152 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: cars
2023-08-18 08:45:29,201 - INFO - TEST data count: 93
2023-08-18 08:45:35,308 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:35,656 - INFO - Metrics from the Predictions...
2023-08-18 08:45:35,656 - INFO - {'test_loss': 0.40387094020843506, 'test_accuracy': 0.8064516129032258, 'test_precision': 0.8676470588235294, 'test_recall': 0.8676470588235294, 'test_f1': 0.8676470588235294, 'test_roc_auc': 0.7538235294117648, 'test_matthews_correlation': 0.5076470588235295, 'test_runtime': 0.1863, 'test_samples_per_second': 499.215, 'test_steps_per_second': 64.415}
2023-08-18 08:45:35,656 - INFO - {'confusion_matrix': array([[16,  9],
       [ 9, 59]])}
2023-08-18 08:45:35,656 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	cars	1	3e-05	0.40387094020843506	0.8064516129032258	0.8676470588235294	0.8676470588235294	0.8676470588235294	0.7538235294117648	0.5076470588235295	0.1863	499.215	64.415
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	cars	1	3e-05	[[16  9]
 [ 9 59]]

2023-08-18 08:45:35,656 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: cars iteration: 1
2023-08-18 08:45:35,657 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:35,657 - INFO - ***********************************
2023-08-18 08:45:35,657 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: retail
2023-08-18 08:45:35,711 - INFO - TEST data count: 197
2023-08-18 08:45:36,856 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:37,370 - INFO - Metrics from the Predictions...
2023-08-18 08:45:37,370 - INFO - {'test_loss': 0.43100813031196594, 'test_accuracy': 0.8071065989847716, 'test_precision': 0.85, 'test_recall': 0.8360655737704918, 'test_f1': 0.8429752066115703, 'test_roc_auc': 0.7980327868852459, 'test_matthews_correlation': 0.5931555535873736, 'test_runtime': 0.3488, 'test_samples_per_second': 564.786, 'test_steps_per_second': 71.673}
2023-08-18 08:45:37,370 - INFO - {'confusion_matrix': array([[ 57,  18],
       [ 20, 102]])}
2023-08-18 08:45:37,370 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	retail	1	3e-05	0.43100813031196594	0.8071065989847716	0.85	0.8360655737704918	0.8429752066115703	0.7980327868852459	0.5931555535873736	0.3488	564.786	71.673
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	retail	1	3e-05	[[ 57  18]
 [ 20 102]]

2023-08-18 08:45:37,371 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: retail iteration: 1
2023-08-18 08:45:37,371 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:37,371 - INFO - ***********************************
2023-08-18 08:45:37,371 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: services
2023-08-18 08:45:37,371 - INFO - Train and test domains are the same: services, hence skipping
2023-08-18 08:45:37,371 - INFO - ***********************************
2023-08-18 08:45:37,371 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: software
2023-08-18 08:45:37,410 - INFO - TEST data count: 295
2023-08-18 08:45:38,581 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:39,265 - INFO - Metrics from the Predictions...
2023-08-18 08:45:39,265 - INFO - {'test_loss': 0.40729063749313354, 'test_accuracy': 0.8271186440677966, 'test_precision': 0.8542713567839196, 'test_recall': 0.8854166666666666, 'test_f1': 0.8695652173913043, 'test_roc_auc': 0.801931634304207, 'test_matthews_correlation': 0.6143921885869434, 'test_runtime': 0.5272, 'test_samples_per_second': 559.611, 'test_steps_per_second': 70.189}
2023-08-18 08:45:39,265 - INFO - {'confusion_matrix': array([[ 74,  29],
       [ 22, 170]])}
2023-08-18 08:45:39,266 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	software	1	3e-05	0.40729063749313354	0.8271186440677966	0.8542713567839196	0.8854166666666666	0.8695652173913043	0.801931634304207	0.6143921885869434	0.5272	559.611	70.189
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	software	1	3e-05	[[ 74  29]
 [ 22 170]]

2023-08-18 08:45:39,266 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: software iteration: 1
2023-08-18 08:45:39,266 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:39,266 - INFO - ***********************************
2023-08-18 08:45:39,266 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: transport
2023-08-18 08:45:40,334 - INFO - TEST data count: 247
2023-08-18 08:45:41,505 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:42,119 - INFO - Metrics from the Predictions...
2023-08-18 08:45:42,119 - INFO - {'test_loss': 0.4685211479663849, 'test_accuracy': 0.7935222672064778, 'test_precision': 0.8041958041958042, 'test_recall': 0.8333333333333334, 'test_f1': 0.8185053380782917, 'test_roc_auc': 0.7882262996941897, 'test_matthews_correlation': 0.5797379168777708, 'test_runtime': 0.4304, 'test_samples_per_second': 573.86, 'test_steps_per_second': 72.023}
2023-08-18 08:45:42,119 - INFO - {'confusion_matrix': array([[ 81,  28],
       [ 23, 115]])}
2023-08-18 08:45:42,119 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	transport	1	3e-05	0.4685211479663849	0.7935222672064778	0.8041958041958042	0.8333333333333334	0.8185053380782917	0.7882262996941897	0.5797379168777708	0.4304	573.86	72.023
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	transport	1	3e-05	[[ 81  28]
 [ 23 115]]

2023-08-18 08:45:42,119 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: transport iteration: 1
2023-08-18 08:45:42,119 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:42,119 - INFO - ***********************************
2023-08-18 08:45:42,120 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: electronics
2023-08-18 08:45:42,186 - INFO - TEST data count: 290
2023-08-18 08:45:43,397 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:44,059 - INFO - Metrics from the Predictions...
2023-08-18 08:45:44,059 - INFO - {'test_loss': 0.4255460500717163, 'test_accuracy': 0.8172413793103448, 'test_precision': 0.8090452261306532, 'test_recall': 0.9147727272727273, 'test_f1': 0.8586666666666666, 'test_roc_auc': 0.790719696969697, 'test_matthews_correlation': 0.6120205124089458, 'test_runtime': 0.5094, 'test_samples_per_second': 569.348, 'test_steps_per_second': 72.641}
2023-08-18 08:45:44,059 - INFO - {'confusion_matrix': array([[ 76,  38],
       [ 15, 161]])}
2023-08-18 08:45:44,059 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	electronics	1	3e-05	0.4255460500717163	0.8172413793103448	0.8090452261306532	0.9147727272727273	0.8586666666666666	0.790719696969697	0.6120205124089458	0.5094	569.348	72.641
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	electronics	1	3e-05	[[ 76  38]
 [ 15 161]]

2023-08-18 08:45:44,059 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:45:44,059 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:44,059 - INFO - ***********************************
2023-08-18 08:45:44,059 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: other
2023-08-18 08:45:44,099 - INFO - TEST data count: 128
2023-08-18 08:45:45,265 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:45:45,767 - INFO - Metrics from the Predictions...
2023-08-18 08:45:45,767 - INFO - {'test_loss': 0.33514562249183655, 'test_accuracy': 0.890625, 'test_precision': 0.9090909090909091, 'test_recall': 0.9473684210526315, 'test_f1': 0.9278350515463918, 'test_roc_auc': 0.8373205741626794, 'test_matthews_correlation': 0.7049770886169239, 'test_runtime': 0.3277, 'test_samples_per_second': 390.609, 'test_steps_per_second': 48.826}
2023-08-18 08:45:45,767 - INFO - {'confusion_matrix': array([[24,  9],
       [ 5, 90]])}
2023-08-18 08:45:45,768 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	other	1	3e-05	0.33514562249183655	0.890625	0.9090909090909091	0.9473684210526315	0.9278350515463918	0.8373205741626794	0.7049770886169239	0.3277	390.609	48.826
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	other	1	3e-05	[[24  9]
 [ 5 90]]

2023-08-18 08:45:45,768 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: other iteration: 1
2023-08-18 08:45:45,768 - INFO - ----------------------------------------------------------------------
2023-08-18 08:45:45,768 - INFO - **********************************************************************
2023-08-18 08:45:45,768 - INFO - Iteration number: 2 for TRAIN DOMAIN: services
2023-08-18 08:45:45,768 - INFO - Tokenizing the data...
2023-08-18 08:45:47,679 - INFO - TRAIN data count: 224 and DEV data count: 111
2023-08-18 08:45:47,680 - INFO - Finetune and perform evaluation...
2023-08-18 08:45:47,680 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:45:47,680 - INFO - Setting up training args and starting training...
2023-08-18 08:46:10,175 - INFO - Training complete...
2023-08-18 08:46:10,175 - INFO - TrainOutput(global_step=112, training_loss=0.3760579994746617, metrics={'train_runtime': 20.9581, 'train_samples_per_second': 42.752, 'train_steps_per_second': 5.344, 'total_flos': 23022217344000.0, 'train_loss': 0.3760579994746617, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:46:10,175 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:46:11,041 - INFO - Report evaluation results...
2023-08-18 08:46:11,042 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	services	na	2	3e-05	0.6072099804878235	0.6216216216216216	0.6181818181818182	1.0	0.7640449438202247	0.5116279069767442	0.11990129837939846	0.2065	537.412	67.782	2.25e-05	1.0	28
vinai/bertweet-base	services	na	2	3e-05	0.42631644010543823	0.8108108108108109	0.8405797101449275	0.8529411764705882	0.8467153284671534	0.7985636114911081	0.5997998663595531	0.2088	531.587	67.047	1.5e-05	2.0	56
vinai/bertweet-base	services	na	2	3e-05	0.4972406029701233	0.8288288288288288	0.8356164383561644	0.8970588235294118	0.8652482269503545	0.8089945280437756	0.6344775210452154	0.2054	540.306	68.147	7.5e-06	3.0	84
vinai/bertweet-base	services	na	2	3e-05	0.5424445867538452	0.8198198198198198	0.8157894736842105	0.9117647058823529	0.861111111111111	0.7930916552667577	0.6145840925882915	0.2119	523.91	66.079	0.0	4.0	112
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	services	na	2	3e-05	20.9581	42.752	5.344	23022217344000.0	0.3760579994746617	0.0	4.0	112

2023-08-18 08:46:11,042 - INFO - Loading the finetuned model
2023-08-18 08:46:11,986 - INFO - ***********************************
2023-08-18 08:46:11,986 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: food
2023-08-18 08:46:12,037 - INFO - TEST data count: 127
2023-08-18 08:46:13,191 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:13,672 - INFO - Metrics from the Predictions...
2023-08-18 08:46:13,672 - INFO - {'test_loss': 0.45204398036003113, 'test_accuracy': 0.7716535433070866, 'test_precision': 0.9846153846153847, 'test_recall': 0.6956521739130435, 'test_f1': 0.8152866242038216, 'test_roc_auc': 0.8335403726708074, 'test_matthews_correlation': 0.596284908876864, 'test_runtime': 0.2385, 'test_samples_per_second': 532.582, 'test_steps_per_second': 67.097}
2023-08-18 08:46:13,672 - INFO - {'confusion_matrix': array([[34,  1],
       [28, 64]])}
2023-08-18 08:46:13,673 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	food	2	3e-05	0.45204398036003113	0.7716535433070866	0.9846153846153847	0.6956521739130435	0.8152866242038216	0.8335403726708074	0.596284908876864	0.2385	532.582	67.097
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	food	2	3e-05	[[34  1]
 [28 64]]

2023-08-18 08:46:13,673 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: food iteration: 2
2023-08-18 08:46:13,673 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:13,673 - INFO - ***********************************
2023-08-18 08:46:13,673 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: apparel
2023-08-18 08:46:13,717 - INFO - TEST data count: 262
2023-08-18 08:46:14,890 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:15,545 - INFO - Metrics from the Predictions...
2023-08-18 08:46:15,545 - INFO - {'test_loss': 0.4368017017841339, 'test_accuracy': 0.8206106870229007, 'test_precision': 0.9454545454545454, 'test_recall': 0.7172413793103448, 'test_f1': 0.8156862745098039, 'test_roc_auc': 0.8329796640141468, 'test_matthews_correlation': 0.670820771636739, 'test_runtime': 0.4635, 'test_samples_per_second': 565.211, 'test_steps_per_second': 71.191}
2023-08-18 08:46:15,545 - INFO - {'confusion_matrix': array([[111,   6],
       [ 41, 104]])}
2023-08-18 08:46:15,545 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	apparel	2	3e-05	0.4368017017841339	0.8206106870229007	0.9454545454545454	0.7172413793103448	0.8156862745098039	0.8329796640141468	0.670820771636739	0.4635	565.211	71.191
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	apparel	2	3e-05	[[111   6]
 [ 41 104]]

2023-08-18 08:46:15,545 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:46:15,546 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:15,546 - INFO - ***********************************
2023-08-18 08:46:15,546 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: cars
2023-08-18 08:46:15,585 - INFO - TEST data count: 93
2023-08-18 08:46:16,846 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:17,206 - INFO - Metrics from the Predictions...
2023-08-18 08:46:17,206 - INFO - {'test_loss': 0.41646626591682434, 'test_accuracy': 0.8064516129032258, 'test_precision': 0.890625, 'test_recall': 0.8382352941176471, 'test_f1': 0.8636363636363636, 'test_roc_auc': 0.7791176470588235, 'test_matthews_correlation': 0.534260130382977, 'test_runtime': 0.1828, 'test_samples_per_second': 508.778, 'test_steps_per_second': 65.649}
2023-08-18 08:46:17,206 - INFO - {'confusion_matrix': array([[18,  7],
       [11, 57]])}
2023-08-18 08:46:17,207 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	cars	2	3e-05	0.41646626591682434	0.8064516129032258	0.890625	0.8382352941176471	0.8636363636363636	0.7791176470588235	0.534260130382977	0.1828	508.778	65.649
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	cars	2	3e-05	[[18  7]
 [11 57]]

2023-08-18 08:46:17,207 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: cars iteration: 2
2023-08-18 08:46:17,207 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:17,207 - INFO - ***********************************
2023-08-18 08:46:17,207 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: retail
2023-08-18 08:46:17,250 - INFO - TEST data count: 197
2023-08-18 08:46:18,545 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:19,078 - INFO - Metrics from the Predictions...
2023-08-18 08:46:19,078 - INFO - {'test_loss': 0.44675663113594055, 'test_accuracy': 0.7969543147208121, 'test_precision': 0.9270833333333334, 'test_recall': 0.7295081967213115, 'test_f1': 0.8165137614678899, 'test_roc_auc': 0.818087431693989, 'test_matthews_correlation': 0.6180032355517034, 'test_runtime': 0.3553, 'test_samples_per_second': 554.523, 'test_steps_per_second': 70.371}
2023-08-18 08:46:19,078 - INFO - {'confusion_matrix': array([[68,  7],
       [33, 89]])}
2023-08-18 08:46:19,079 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	retail	2	3e-05	0.44675663113594055	0.7969543147208121	0.9270833333333334	0.7295081967213115	0.8165137614678899	0.818087431693989	0.6180032355517034	0.3553	554.523	70.371
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	retail	2	3e-05	[[68  7]
 [33 89]]

2023-08-18 08:46:19,079 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: retail iteration: 2
2023-08-18 08:46:19,079 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:19,079 - INFO - ***********************************
2023-08-18 08:46:19,079 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: services
2023-08-18 08:46:19,079 - INFO - Train and test domains are the same: services, hence skipping
2023-08-18 08:46:19,079 - INFO - ***********************************
2023-08-18 08:46:19,079 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: software
2023-08-18 08:46:19,120 - INFO - TEST data count: 295
2023-08-18 08:46:20,272 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:20,973 - INFO - Metrics from the Predictions...
2023-08-18 08:46:20,973 - INFO - {'test_loss': 0.4145600497722626, 'test_accuracy': 0.8135593220338984, 'test_precision': 0.9536423841059603, 'test_recall': 0.75, 'test_f1': 0.8396501457725948, 'test_roc_auc': 0.8410194174757283, 'test_matthews_correlation': 0.6504420514533221, 'test_runtime': 0.5283, 'test_samples_per_second': 558.405, 'test_steps_per_second': 70.037}
2023-08-18 08:46:20,973 - INFO - {'confusion_matrix': array([[ 96,   7],
       [ 48, 144]])}
2023-08-18 08:46:20,973 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	software	2	3e-05	0.4145600497722626	0.8135593220338984	0.9536423841059603	0.75	0.8396501457725948	0.8410194174757283	0.6504420514533221	0.5283	558.405	70.037
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	software	2	3e-05	[[ 96   7]
 [ 48 144]]

2023-08-18 08:46:20,973 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: software iteration: 2
2023-08-18 08:46:20,973 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:20,974 - INFO - ***********************************
2023-08-18 08:46:20,974 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: transport
2023-08-18 08:46:21,020 - INFO - TEST data count: 247
2023-08-18 08:46:22,165 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:22,820 - INFO - Metrics from the Predictions...
2023-08-18 08:46:22,820 - INFO - {'test_loss': 0.4472733438014984, 'test_accuracy': 0.8137651821862348, 'test_precision': 0.8484848484848485, 'test_recall': 0.8115942028985508, 'test_f1': 0.8296296296296296, 'test_roc_auc': 0.8140539821832203, 'test_matthews_correlation': 0.6252464097833049, 'test_runtime': 0.4936, 'test_samples_per_second': 500.398, 'test_steps_per_second': 62.803}
2023-08-18 08:46:22,820 - INFO - {'confusion_matrix': array([[ 89,  20],
       [ 26, 112]])}
2023-08-18 08:46:22,820 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	transport	2	3e-05	0.4472733438014984	0.8137651821862348	0.8484848484848485	0.8115942028985508	0.8296296296296296	0.8140539821832203	0.6252464097833049	0.4936	500.398	62.803
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	transport	2	3e-05	[[ 89  20]
 [ 26 112]]

2023-08-18 08:46:22,820 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: transport iteration: 2
2023-08-18 08:46:22,820 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:22,821 - INFO - ***********************************
2023-08-18 08:46:22,821 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: electronics
2023-08-18 08:46:22,861 - INFO - TEST data count: 290
2023-08-18 08:46:23,999 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:24,684 - INFO - Metrics from the Predictions...
2023-08-18 08:46:24,684 - INFO - {'test_loss': 0.4152974784374237, 'test_accuracy': 0.8206896551724138, 'test_precision': 0.8974358974358975, 'test_recall': 0.7954545454545454, 'test_f1': 0.8433734939759037, 'test_roc_auc': 0.8275518341307815, 'test_matthews_correlation': 0.6418064723975481, 'test_runtime': 0.5138, 'test_samples_per_second': 564.417, 'test_steps_per_second': 72.012}
2023-08-18 08:46:24,684 - INFO - {'confusion_matrix': array([[ 98,  16],
       [ 36, 140]])}
2023-08-18 08:46:24,684 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	electronics	2	3e-05	0.4152974784374237	0.8206896551724138	0.8974358974358975	0.7954545454545454	0.8433734939759037	0.8275518341307815	0.6418064723975481	0.5138	564.417	72.012
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	electronics	2	3e-05	[[ 98  16]
 [ 36 140]]

2023-08-18 08:46:24,684 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:46:24,684 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:24,684 - INFO - ***********************************
2023-08-18 08:46:24,684 - INFO - For TRAIN domain: services now testing with TEST DOMAIN: other
2023-08-18 08:46:24,719 - INFO - TEST data count: 128
2023-08-18 08:46:25,819 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:46:26,226 - INFO - Metrics from the Predictions...
2023-08-18 08:46:26,226 - INFO - {'test_loss': 0.3231748938560486, 'test_accuracy': 0.8984375, 'test_precision': 0.9880952380952381, 'test_recall': 0.8736842105263158, 'test_f1': 0.9273743016759777, 'test_roc_auc': 0.9216905901116428, 'test_matthews_correlation': 0.7767418354421017, 'test_runtime': 0.2367, 'test_samples_per_second': 540.786, 'test_steps_per_second': 67.598}
2023-08-18 08:46:26,226 - INFO - {'confusion_matrix': array([[32,  1],
       [12, 83]])}
2023-08-18 08:46:26,227 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	services	other	2	3e-05	0.3231748938560486	0.8984375	0.9880952380952381	0.8736842105263158	0.9273743016759777	0.9216905901116428	0.7767418354421017	0.2367	540.786	67.598
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	services	other	2	3e-05	[[32  1]
 [12 83]]

2023-08-18 08:46:26,227 - INFO - Finished testing for TRAIN DOMAIN: services and TEST DOMAIN: other iteration: 2
2023-08-18 08:46:26,227 - INFO - ----------------------------------------------------------------------
2023-08-18 08:46:26,227 - INFO - Finished all iterations and all testing for TRAIN domain: services
2023-08-18 08:46:26,227 - INFO - Calculating mean of test metrics for TRAIN domain: services
2023-08-18 08:46:26,227 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	food	2	3e-05	0.46267420053482056	0.7611548556430446	0.9754778554778555	0.6884057971014492	0.8040853169522127	0.8203933747412008	0.5776778607696346	0.23726666666666665	535.3403333333332	67.44433333333332
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	food	2	3e-05	33.333333333333336	1.6666666666666667	28.666666666666668	63.333333333333336

2023-08-18 08:46:26,228 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	apparel	2	3e-05	0.4377823273340861	0.8206106870229007	0.9182802271351992	0.7471264367816092	0.821079417682566	0.8294036742312604	0.6620989121864543	0.46986666666666665	557.658	70.23966666666668
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	apparel	2	3e-05	106.66666666666667	10.333333333333334	36.666666666666664	108.33333333333333

2023-08-18 08:46:26,228 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	cars	2	3e-05	0.42218204339345294	0.8028673835125447	0.8960322067423462	0.8284313725490197	0.8597611408199644	0.7808823529411765	0.5352314720166153	0.18426666666666666	504.7703333333333	65.13166666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	cars	2	3e-05	18.333333333333332	6.666666666666667	11.666666666666666	56.333333333333336

2023-08-18 08:46:26,228 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	retail	2	3e-05	0.4478786885738373	0.7952622673434856	0.9176623159303882	0.7431693989071038	0.8165776235061616	0.8115846994535518	0.6126106150725482	0.3542	556.2660000000001	70.592
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	retail	2	3e-05	66.0	9.0	31.333333333333332	90.66666666666667

2023-08-18 08:46:26,228 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	software	2	3e-05	0.40143240491549176	0.824858757062147	0.9230680211568417	0.8038194444444443	0.8560016628413765	0.8339485571736786	0.650021379009328	0.6162666666666666	496.6263333333333	62.288666666666664
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	software	2	3e-05	89.0	14.0	37.666666666666664	154.33333333333334

2023-08-18 08:46:26,229 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	transport	2	3e-05	0.45599594712257385	0.7989203778677464	0.8553807303807304	0.7777777777777778	0.8110863115500234	0.8017329255861366	0.6047580337902323	0.4635	534.5733333333334	67.09233333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	transport	2	3e-05	90.0	19.0	30.666666666666668	107.33333333333333

2023-08-18 08:46:26,229 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	electronics	2	3e-05	0.4089316924413045	0.825287356321839	0.8817522112568774	0.8314393939393939	0.8521764415764191	0.8236144338118022	0.6475774703099716	0.5111666666666667	567.3613333333333	72.38766666666668
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	electronics	2	3e-05	93.0	21.0	29.666666666666668	146.33333333333334

2023-08-18 08:46:26,229 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	services	other	2	3e-05	0.3315766453742981	0.8776041666666666	0.9657287157287158	0.8701754385964913	0.9125207647996133	0.884582668793195	0.7276105575876645	0.2681	488.32699999999994	61.040666666666674
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	services	other	2	3e-05	29.666666666666668	3.3333333333333335	12.333333333333334	82.66666666666667

2023-08-18 08:46:26,229 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:46:26,390 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:46:26,390 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:46:26,391 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:46:26,391 - INFO - ********************************************************************************************************************************************
2023-08-18 08:46:26,391 - INFO - TRAIN DOMAIN: software
2023-08-18 08:46:26,449 - INFO - Overall data count for train and dev: 295
2023-08-18 08:46:26,450 - INFO - **********************************************************************
2023-08-18 08:46:26,450 - INFO - Iteration number: 0 for TRAIN DOMAIN: software
2023-08-18 08:46:26,450 - INFO - Tokenizing the data...
2023-08-18 08:46:38,362 - INFO - TRAIN data count: 196 and DEV data count: 99
2023-08-18 08:46:38,362 - INFO - Finetune and perform evaluation...
2023-08-18 08:46:38,362 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:46:38,362 - INFO - Setting up training args and starting training...
2023-08-18 08:46:57,497 - INFO - Training complete...
2023-08-18 08:46:57,498 - INFO - TrainOutput(global_step=100, training_loss=0.5443822479248047, metrics={'train_runtime': 17.8193, 'train_samples_per_second': 43.997, 'train_steps_per_second': 5.612, 'total_flos': 20144440176000.0, 'train_loss': 0.5443822479248047, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:46:57,498 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:46:58,397 - INFO - Report evaluation results...
2023-08-18 08:46:58,397 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	software	na	0	3e-05	0.6172301769256592	0.6464646464646465	0.6464646464646465	1.0	0.7852760736196319	0.5	0.0	0.2189	452.312	59.394	2.25e-05	1.0	25
vinai/bertweet-base	software	na	0	3e-05	0.5340694189071655	0.6767676767676768	0.6702127659574468	0.984375	0.7974683544303798	0.5493303571428572	0.21538692475548069	0.1919	515.914	67.746	1.5e-05	2.0	50
vinai/bertweet-base	software	na	0	3e-05	0.4771357774734497	0.7171717171717171	0.6956521739130435	1.0	0.8205128205128205	0.6	0.3730019232961255	0.195	507.575	66.651	7.5e-06	3.0	75
vinai/bertweet-base	software	na	0	3e-05	0.4150334894657135	0.8383838383838383	0.8076923076923077	0.984375	0.8873239436619719	0.7779017857142857	0.6499626393078877	0.1914	517.152	67.909	0.0	4.0	100
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	software	na	0	3e-05	17.8193	43.997	5.612	20144440176000.0	0.5443822479248047	0.0	4.0	100

2023-08-18 08:46:58,397 - INFO - Loading the finetuned model
2023-08-18 08:46:59,413 - INFO - ***********************************
2023-08-18 08:46:59,413 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: food
2023-08-18 08:46:59,455 - INFO - TEST data count: 127
2023-08-18 08:47:00,773 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:01,269 - INFO - Metrics from the Predictions...
2023-08-18 08:47:01,269 - INFO - {'test_loss': 0.47242769598960876, 'test_accuracy': 0.7480314960629921, 'test_precision': 0.8125, 'test_recall': 0.8478260869565217, 'test_f1': 0.8297872340425533, 'test_roc_auc': 0.6667701863354037, 'test_matthews_correlation': 0.34694440008472577, 'test_runtime': 0.2318, 'test_samples_per_second': 547.989, 'test_steps_per_second': 69.038}
2023-08-18 08:47:01,269 - INFO - {'confusion_matrix': array([[17, 18],
       [14, 78]])}
2023-08-18 08:47:01,269 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	food	0	3e-05	0.47242769598960876	0.7480314960629921	0.8125	0.8478260869565217	0.8297872340425533	0.6667701863354037	0.34694440008472577	0.2318	547.989	69.038
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	food	0	3e-05	[[17 18]
 [14 78]]

2023-08-18 08:47:01,269 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: food iteration: 0
2023-08-18 08:47:01,269 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:01,269 - INFO - ***********************************
2023-08-18 08:47:01,269 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: apparel
2023-08-18 08:47:01,321 - INFO - TEST data count: 262
2023-08-18 08:47:02,593 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:03,217 - INFO - Metrics from the Predictions...
2023-08-18 08:47:03,217 - INFO - {'test_loss': 0.5597169995307922, 'test_accuracy': 0.6755725190839694, 'test_precision': 0.654639175257732, 'test_recall': 0.8758620689655172, 'test_f1': 0.7492625368731564, 'test_roc_auc': 0.6516062481579723, 'test_matthews_correlation': 0.34384974500260723, 'test_runtime': 0.4719, 'test_samples_per_second': 555.224, 'test_steps_per_second': 69.933}
2023-08-18 08:47:03,217 - INFO - {'confusion_matrix': array([[ 50,  67],
       [ 18, 127]])}
2023-08-18 08:47:03,218 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	apparel	0	3e-05	0.5597169995307922	0.6755725190839694	0.654639175257732	0.8758620689655172	0.7492625368731564	0.6516062481579723	0.34384974500260723	0.4719	555.224	69.933
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	apparel	0	3e-05	[[ 50  67]
 [ 18 127]]

2023-08-18 08:47:03,218 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:47:03,218 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:03,218 - INFO - ***********************************
2023-08-18 08:47:03,218 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: cars
2023-08-18 08:47:03,264 - INFO - TEST data count: 93
2023-08-18 08:47:04,814 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:05,154 - INFO - Metrics from the Predictions...
2023-08-18 08:47:05,154 - INFO - {'test_loss': 0.4249391555786133, 'test_accuracy': 0.7956989247311828, 'test_precision': 0.8024691358024691, 'test_recall': 0.9558823529411765, 'test_f1': 0.87248322147651, 'test_roc_auc': 0.6579411764705883, 'test_matthews_correlation': 0.41775022506835624, 'test_runtime': 0.182, 'test_samples_per_second': 510.95, 'test_steps_per_second': 65.929}
2023-08-18 08:47:05,154 - INFO - {'confusion_matrix': array([[ 9, 16],
       [ 3, 65]])}
2023-08-18 08:47:05,154 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	cars	0	3e-05	0.4249391555786133	0.7956989247311828	0.8024691358024691	0.9558823529411765	0.87248322147651	0.6579411764705883	0.41775022506835624	0.182	510.95	65.929
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	cars	0	3e-05	[[ 9 16]
 [ 3 65]]

2023-08-18 08:47:05,154 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: cars iteration: 0
2023-08-18 08:47:05,154 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:05,154 - INFO - ***********************************
2023-08-18 08:47:05,154 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: retail
2023-08-18 08:47:05,205 - INFO - TEST data count: 197
2023-08-18 08:47:06,656 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:07,165 - INFO - Metrics from the Predictions...
2023-08-18 08:47:07,165 - INFO - {'test_loss': 0.4873395562171936, 'test_accuracy': 0.751269035532995, 'test_precision': 0.7449664429530202, 'test_recall': 0.9098360655737705, 'test_f1': 0.8191881918819188, 'test_roc_auc': 0.7015846994535518, 'test_matthews_correlation': 0.45602048831361486, 'test_runtime': 0.3559, 'test_samples_per_second': 553.591, 'test_steps_per_second': 70.253}
2023-08-18 08:47:07,165 - INFO - {'confusion_matrix': array([[ 37,  38],
       [ 11, 111]])}
2023-08-18 08:47:07,165 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	retail	0	3e-05	0.4873395562171936	0.751269035532995	0.7449664429530202	0.9098360655737705	0.8191881918819188	0.7015846994535518	0.45602048831361486	0.3559	553.591	70.253
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	retail	0	3e-05	[[ 37  38]
 [ 11 111]]

2023-08-18 08:47:07,165 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: retail iteration: 0
2023-08-18 08:47:07,165 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:07,165 - INFO - ***********************************
2023-08-18 08:47:07,165 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: services
2023-08-18 08:47:07,204 - INFO - TEST data count: 335
2023-08-18 08:47:08,351 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:09,183 - INFO - Metrics from the Predictions...
2023-08-18 08:47:09,183 - INFO - {'test_loss': 0.5355509519577026, 'test_accuracy': 0.7283582089552239, 'test_precision': 0.7164750957854407, 'test_recall': 0.9166666666666666, 'test_f1': 0.8043010752688172, 'test_roc_auc': 0.6758905852417302, 'test_matthews_correlation': 0.4137968760134354, 'test_runtime': 0.5979, 'test_samples_per_second': 560.328, 'test_steps_per_second': 70.25}
2023-08-18 08:47:09,183 - INFO - {'confusion_matrix': array([[ 57,  74],
       [ 17, 187]])}
2023-08-18 08:47:09,183 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	services	0	3e-05	0.5355509519577026	0.7283582089552239	0.7164750957854407	0.9166666666666666	0.8043010752688172	0.6758905852417302	0.4137968760134354	0.5979	560.328	70.25
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	services	0	3e-05	[[ 57  74]
 [ 17 187]]

2023-08-18 08:47:09,184 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: services iteration: 0
2023-08-18 08:47:09,184 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:09,184 - INFO - ***********************************
2023-08-18 08:47:09,184 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: software
2023-08-18 08:47:09,184 - INFO - Train and test domains are the same: software, hence skipping
2023-08-18 08:47:09,184 - INFO - ***********************************
2023-08-18 08:47:09,184 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: transport
2023-08-18 08:47:09,229 - INFO - TEST data count: 247
2023-08-18 08:47:10,414 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:11,032 - INFO - Metrics from the Predictions...
2023-08-18 08:47:11,033 - INFO - {'test_loss': 0.5758997201919556, 'test_accuracy': 0.680161943319838, 'test_precision': 0.6544502617801047, 'test_recall': 0.9057971014492754, 'test_f1': 0.7598784194528876, 'test_roc_auc': 0.6501462571466561, 'test_matthews_correlation': 0.3561119941018586, 'test_runtime': 0.4408, 'test_samples_per_second': 560.307, 'test_steps_per_second': 70.322}
2023-08-18 08:47:11,033 - INFO - {'confusion_matrix': array([[ 43,  66],
       [ 13, 125]])}
2023-08-18 08:47:11,033 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	transport	0	3e-05	0.5758997201919556	0.680161943319838	0.6544502617801047	0.9057971014492754	0.7598784194528876	0.6501462571466561	0.3561119941018586	0.4408	560.307	70.322
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	transport	0	3e-05	[[ 43  66]
 [ 13 125]]

2023-08-18 08:47:11,033 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: transport iteration: 0
2023-08-18 08:47:11,033 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:11,033 - INFO - ***********************************
2023-08-18 08:47:11,033 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: electronics
2023-08-18 08:47:11,069 - INFO - TEST data count: 290
2023-08-18 08:47:12,210 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:12,893 - INFO - Metrics from the Predictions...
2023-08-18 08:47:12,893 - INFO - {'test_loss': 0.5103017091751099, 'test_accuracy': 0.7241379310344828, 'test_precision': 0.7123893805309734, 'test_recall': 0.9147727272727273, 'test_f1': 0.8009950248756218, 'test_roc_auc': 0.672298644338118, 'test_matthews_correlation': 0.40586014768541145, 'test_runtime': 0.5214, 'test_samples_per_second': 556.181, 'test_steps_per_second': 70.961}
2023-08-18 08:47:12,893 - INFO - {'confusion_matrix': array([[ 49,  65],
       [ 15, 161]])}
2023-08-18 08:47:12,893 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	electronics	0	3e-05	0.5103017091751099	0.7241379310344828	0.7123893805309734	0.9147727272727273	0.8009950248756218	0.672298644338118	0.40586014768541145	0.5214	556.181	70.961
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	electronics	0	3e-05	[[ 49  65]
 [ 15 161]]

2023-08-18 08:47:12,893 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:47:12,893 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:12,893 - INFO - ***********************************
2023-08-18 08:47:12,893 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: other
2023-08-18 08:47:12,963 - INFO - TEST data count: 128
2023-08-18 08:47:14,172 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:14,577 - INFO - Metrics from the Predictions...
2023-08-18 08:47:14,577 - INFO - {'test_loss': 0.3928793668746948, 'test_accuracy': 0.796875, 'test_precision': 0.8, 'test_recall': 0.968421052631579, 'test_f1': 0.8761904761904761, 'test_roc_auc': 0.635725677830941, 'test_matthews_correlation': 0.3930883666456541, 'test_runtime': 0.2377, 'test_samples_per_second': 538.438, 'test_steps_per_second': 67.305}
2023-08-18 08:47:14,577 - INFO - {'confusion_matrix': array([[10, 23],
       [ 3, 92]])}
2023-08-18 08:47:14,577 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	other	0	3e-05	0.3928793668746948	0.796875	0.8	0.968421052631579	0.8761904761904761	0.635725677830941	0.3930883666456541	0.2377	538.438	67.305
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	other	0	3e-05	[[10 23]
 [ 3 92]]

2023-08-18 08:47:14,577 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: other iteration: 0
2023-08-18 08:47:14,577 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:14,577 - INFO - **********************************************************************
2023-08-18 08:47:14,577 - INFO - Iteration number: 1 for TRAIN DOMAIN: software
2023-08-18 08:47:14,577 - INFO - Tokenizing the data...
2023-08-18 08:47:16,432 - INFO - TRAIN data count: 197 and DEV data count: 98
2023-08-18 08:47:16,432 - INFO - Finetune and perform evaluation...
2023-08-18 08:47:16,432 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:47:16,432 - INFO - Setting up training args and starting training...
2023-08-18 08:47:35,841 - INFO - Training complete...
2023-08-18 08:47:35,841 - INFO - TrainOutput(global_step=100, training_loss=0.39379764556884767, metrics={'train_runtime': 18.303, 'train_samples_per_second': 43.053, 'train_steps_per_second': 5.464, 'total_flos': 20247217932000.0, 'train_loss': 0.39379764556884767, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:47:35,841 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:47:36,696 - INFO - Report evaluation results...
2023-08-18 08:47:36,697 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	software	na	1	3e-05	0.575090765953064	0.6530612244897959	0.6530612244897959	1.0	0.7901234567901235	0.5	0.0	0.1885	519.979	68.977	2.25e-05	1.0	25
vinai/bertweet-base	software	na	1	3e-05	0.42290598154067993	0.8163265306122449	0.8108108108108109	0.9375	0.8695652173913043	0.7628676470588235	0.5819358307200044	0.1879	521.543	69.184	1.5e-05	2.0	50
vinai/bertweet-base	software	na	1	3e-05	0.3992788791656494	0.8571428571428571	0.8571428571428571	0.9375	0.8955223880597014	0.8216911764705881	0.6779076806833005	0.1901	515.483	68.38	7.5e-06	3.0	75
vinai/bertweet-base	software	na	1	3e-05	0.4174160063266754	0.8571428571428571	0.8571428571428571	0.9375	0.8955223880597014	0.8216911764705881	0.6779076806833005	0.1891	518.327	68.758	0.0	4.0	100
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	software	na	1	3e-05	18.303	43.053	5.464	20247217932000.0	0.39379764556884767	0.0	4.0	100

2023-08-18 08:47:36,697 - INFO - Loading the finetuned model
2023-08-18 08:47:38,096 - INFO - ***********************************
2023-08-18 08:47:38,096 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: food
2023-08-18 08:47:38,148 - INFO - TEST data count: 127
2023-08-18 08:47:39,313 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:39,798 - INFO - Metrics from the Predictions...
2023-08-18 08:47:39,798 - INFO - {'test_loss': 0.42522433400154114, 'test_accuracy': 0.7874015748031497, 'test_precision': 0.9710144927536232, 'test_recall': 0.7282608695652174, 'test_f1': 0.8322981366459627, 'test_roc_auc': 0.8355590062111801, 'test_matthews_correlation': 0.6019886303375275, 'test_runtime': 0.2363, 'test_samples_per_second': 537.476, 'test_steps_per_second': 67.713}
2023-08-18 08:47:39,798 - INFO - {'confusion_matrix': array([[33,  2],
       [25, 67]])}
2023-08-18 08:47:39,798 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	food	1	3e-05	0.42522433400154114	0.7874015748031497	0.9710144927536232	0.7282608695652174	0.8322981366459627	0.8355590062111801	0.6019886303375275	0.2363	537.476	67.713
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	food	1	3e-05	[[33  2]
 [25 67]]

2023-08-18 08:47:39,798 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: food iteration: 1
2023-08-18 08:47:39,798 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:39,798 - INFO - ***********************************
2023-08-18 08:47:39,798 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: apparel
2023-08-18 08:47:39,855 - INFO - TEST data count: 262
2023-08-18 08:47:41,106 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:41,796 - INFO - Metrics from the Predictions...
2023-08-18 08:47:41,796 - INFO - {'test_loss': 0.4601282477378845, 'test_accuracy': 0.8244274809160306, 'test_precision': 0.8367346938775511, 'test_recall': 0.8482758620689655, 'test_f1': 0.8424657534246576, 'test_roc_auc': 0.8215738284703803, 'test_matthews_correlation': 0.6442879905612576, 'test_runtime': 0.4751, 'test_samples_per_second': 551.411, 'test_steps_per_second': 69.452}
2023-08-18 08:47:41,796 - INFO - {'confusion_matrix': array([[ 93,  24],
       [ 22, 123]])}
2023-08-18 08:47:41,797 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	apparel	1	3e-05	0.4601282477378845	0.8244274809160306	0.8367346938775511	0.8482758620689655	0.8424657534246576	0.8215738284703803	0.6442879905612576	0.4751	551.411	69.452
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	apparel	1	3e-05	[[ 93  24]
 [ 22 123]]

2023-08-18 08:47:41,797 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:47:41,797 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:41,797 - INFO - ***********************************
2023-08-18 08:47:41,797 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: cars
2023-08-18 08:47:41,888 - INFO - TEST data count: 93
2023-08-18 08:47:43,089 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:43,459 - INFO - Metrics from the Predictions...
2023-08-18 08:47:43,459 - INFO - {'test_loss': 0.3383815586566925, 'test_accuracy': 0.8494623655913979, 'test_precision': 0.8648648648648649, 'test_recall': 0.9411764705882353, 'test_f1': 0.9014084507042254, 'test_roc_auc': 0.7705882352941176, 'test_matthews_correlation': 0.5950736312074725, 'test_runtime': 0.1879, 'test_samples_per_second': 494.831, 'test_steps_per_second': 63.849}
2023-08-18 08:47:43,460 - INFO - {'confusion_matrix': array([[15, 10],
       [ 4, 64]])}
2023-08-18 08:47:43,460 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	cars	1	3e-05	0.3383815586566925	0.8494623655913979	0.8648648648648649	0.9411764705882353	0.9014084507042254	0.7705882352941176	0.5950736312074725	0.1879	494.831	63.849
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	cars	1	3e-05	[[15 10]
 [ 4 64]]

2023-08-18 08:47:43,460 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: cars iteration: 1
2023-08-18 08:47:43,460 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:43,460 - INFO - ***********************************
2023-08-18 08:47:43,460 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: retail
2023-08-18 08:47:43,524 - INFO - TEST data count: 197
2023-08-18 08:47:44,721 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:45,218 - INFO - Metrics from the Predictions...
2023-08-18 08:47:45,218 - INFO - {'test_loss': 0.4267001748085022, 'test_accuracy': 0.8375634517766497, 'test_precision': 0.8688524590163934, 'test_recall': 0.8688524590163934, 'test_f1': 0.8688524590163934, 'test_roc_auc': 0.82775956284153, 'test_matthews_correlation': 0.6555191256830601, 'test_runtime': 0.3496, 'test_samples_per_second': 563.492, 'test_steps_per_second': 71.509}
2023-08-18 08:47:45,218 - INFO - {'confusion_matrix': array([[ 59,  16],
       [ 16, 106]])}
2023-08-18 08:47:45,218 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	retail	1	3e-05	0.4267001748085022	0.8375634517766497	0.8688524590163934	0.8688524590163934	0.8688524590163934	0.82775956284153	0.6555191256830601	0.3496	563.492	71.509
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	retail	1	3e-05	[[ 59  16]
 [ 16 106]]

2023-08-18 08:47:45,219 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: retail iteration: 1
2023-08-18 08:47:45,219 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:45,219 - INFO - ***********************************
2023-08-18 08:47:45,219 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: services
2023-08-18 08:47:45,279 - INFO - TEST data count: 335
2023-08-18 08:47:46,462 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:47,200 - INFO - Metrics from the Predictions...
2023-08-18 08:47:47,201 - INFO - {'test_loss': 0.526382327079773, 'test_accuracy': 0.7970149253731343, 'test_precision': 0.7764227642276422, 'test_recall': 0.9362745098039216, 'test_f1': 0.8488888888888888, 'test_roc_auc': 0.7582135907798234, 'test_matthews_correlation': 0.5705546739844589, 'test_runtime': 0.5815, 'test_samples_per_second': 576.09, 'test_steps_per_second': 72.226}
2023-08-18 08:47:47,201 - INFO - {'confusion_matrix': array([[ 76,  55],
       [ 13, 191]])}
2023-08-18 08:47:47,201 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	services	1	3e-05	0.526382327079773	0.7970149253731343	0.7764227642276422	0.9362745098039216	0.8488888888888888	0.7582135907798234	0.5705546739844589	0.5815	576.09	72.226
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	services	1	3e-05	[[ 76  55]
 [ 13 191]]

2023-08-18 08:47:47,201 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: services iteration: 1
2023-08-18 08:47:47,201 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:47,201 - INFO - ***********************************
2023-08-18 08:47:47,201 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: software
2023-08-18 08:47:47,201 - INFO - Train and test domains are the same: software, hence skipping
2023-08-18 08:47:47,201 - INFO - ***********************************
2023-08-18 08:47:47,201 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: transport
2023-08-18 08:47:47,235 - INFO - TEST data count: 247
2023-08-18 08:47:48,410 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:49,000 - INFO - Metrics from the Predictions...
2023-08-18 08:47:49,000 - INFO - {'test_loss': 0.5295161604881287, 'test_accuracy': 0.7935222672064778, 'test_precision': 0.7668711656441718, 'test_recall': 0.9057971014492754, 'test_f1': 0.8305647840531561, 'test_roc_auc': 0.778586624119133, 'test_matthews_correlation': 0.5839956379652994, 'test_runtime': 0.4379, 'test_samples_per_second': 564.104, 'test_steps_per_second': 70.798}
2023-08-18 08:47:49,000 - INFO - {'confusion_matrix': array([[ 71,  38],
       [ 13, 125]])}
2023-08-18 08:47:49,000 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	transport	1	3e-05	0.5295161604881287	0.7935222672064778	0.7668711656441718	0.9057971014492754	0.8305647840531561	0.778586624119133	0.5839956379652994	0.4379	564.104	70.798
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	transport	1	3e-05	[[ 71  38]
 [ 13 125]]

2023-08-18 08:47:49,000 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: transport iteration: 1
2023-08-18 08:47:49,000 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:49,000 - INFO - ***********************************
2023-08-18 08:47:49,000 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: electronics
2023-08-18 08:47:49,038 - INFO - TEST data count: 290
2023-08-18 08:47:50,248 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:50,983 - INFO - Metrics from the Predictions...
2023-08-18 08:47:50,983 - INFO - {'test_loss': 0.4702332615852356, 'test_accuracy': 0.8172413793103448, 'test_precision': 0.8090452261306532, 'test_recall': 0.9147727272727273, 'test_f1': 0.8586666666666666, 'test_roc_auc': 0.790719696969697, 'test_matthews_correlation': 0.6120205124089458, 'test_runtime': 0.5194, 'test_samples_per_second': 558.283, 'test_steps_per_second': 71.229}
2023-08-18 08:47:50,983 - INFO - {'confusion_matrix': array([[ 76,  38],
       [ 15, 161]])}
2023-08-18 08:47:50,983 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	electronics	1	3e-05	0.4702332615852356	0.8172413793103448	0.8090452261306532	0.9147727272727273	0.8586666666666666	0.790719696969697	0.6120205124089458	0.5194	558.283	71.229
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	electronics	1	3e-05	[[ 76  38]
 [ 15 161]]

2023-08-18 08:47:50,983 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:47:50,983 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:50,983 - INFO - ***********************************
2023-08-18 08:47:50,983 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: other
2023-08-18 08:47:51,028 - INFO - TEST data count: 128
2023-08-18 08:47:52,214 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:47:52,685 - INFO - Metrics from the Predictions...
2023-08-18 08:47:52,685 - INFO - {'test_loss': 0.29032567143440247, 'test_accuracy': 0.875, 'test_precision': 0.8910891089108911, 'test_recall': 0.9473684210526315, 'test_f1': 0.9183673469387755, 'test_roc_auc': 0.8070175438596492, 'test_matthews_correlation': 0.6583690285290694, 'test_runtime': 0.2406, 'test_samples_per_second': 531.989, 'test_steps_per_second': 66.499}
2023-08-18 08:47:52,685 - INFO - {'confusion_matrix': array([[22, 11],
       [ 5, 90]])}
2023-08-18 08:47:52,686 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	other	1	3e-05	0.29032567143440247	0.875	0.8910891089108911	0.9473684210526315	0.9183673469387755	0.8070175438596492	0.6583690285290694	0.2406	531.989	66.499
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	other	1	3e-05	[[22 11]
 [ 5 90]]

2023-08-18 08:47:52,686 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: other iteration: 1
2023-08-18 08:47:52,686 - INFO - ----------------------------------------------------------------------
2023-08-18 08:47:52,686 - INFO - **********************************************************************
2023-08-18 08:47:52,686 - INFO - Iteration number: 2 for TRAIN DOMAIN: software
2023-08-18 08:47:52,686 - INFO - Tokenizing the data...
2023-08-18 08:47:59,560 - INFO - TRAIN data count: 197 and DEV data count: 98
2023-08-18 08:47:59,560 - INFO - Finetune and perform evaluation...
2023-08-18 08:47:59,560 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:47:59,560 - INFO - Setting up training args and starting training...
2023-08-18 08:48:19,313 - INFO - Training complete...
2023-08-18 08:48:19,314 - INFO - TrainOutput(global_step=100, training_loss=0.4005317687988281, metrics={'train_runtime': 18.5212, 'train_samples_per_second': 42.546, 'train_steps_per_second': 5.399, 'total_flos': 20247217932000.0, 'train_loss': 0.4005317687988281, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:48:19,314 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:48:20,304 - INFO - Report evaluation results...
2023-08-18 08:48:20,304 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	software	na	2	3e-05	0.5854976177215576	0.6530612244897959	0.6530612244897959	1.0	0.7901234567901235	0.5	0.0	0.1913	512.292	67.957	2.25e-05	1.0	25
vinai/bertweet-base	software	na	2	3e-05	0.4492715001106262	0.826530612244898	0.8309859154929577	0.921875	0.874074074074074	0.7844669117647058	0.6061500463846287	0.1868	524.713	69.605	1.5e-05	2.0	50
vinai/bertweet-base	software	na	2	3e-05	0.4008651375770569	0.8469387755102041	0.8888888888888888	0.875	0.8818897637795274	0.8345588235294118	0.6647029903343877	0.1874	523.026	69.381	7.5e-06	3.0	75
vinai/bertweet-base	software	na	2	3e-05	0.4533182382583618	0.826530612244898	0.8615384615384616	0.875	0.8682170542635659	0.8051470588235295	0.6146883487402865	0.1912	512.59	67.997	0.0	4.0	100
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	software	na	2	3e-05	18.5212	42.546	5.399	20247217932000.0	0.4005317687988281	0.0	4.0	100

2023-08-18 08:48:20,304 - INFO - Loading the finetuned model
2023-08-18 08:48:21,721 - INFO - ***********************************
2023-08-18 08:48:21,721 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: food
2023-08-18 08:48:21,794 - INFO - TEST data count: 127
2023-08-18 08:48:22,952 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:23,444 - INFO - Metrics from the Predictions...
2023-08-18 08:48:23,444 - INFO - {'test_loss': 0.38555821776390076, 'test_accuracy': 0.84251968503937, 'test_precision': 0.9615384615384616, 'test_recall': 0.8152173913043478, 'test_f1': 0.8823529411764706, 'test_roc_auc': 0.8647515527950309, 'test_matthews_correlation': 0.6695912033862832, 'test_runtime': 0.2496, 'test_samples_per_second': 508.868, 'test_steps_per_second': 64.109}
2023-08-18 08:48:23,444 - INFO - {'confusion_matrix': array([[32,  3],
       [17, 75]])}
2023-08-18 08:48:23,444 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	food	2	3e-05	0.38555821776390076	0.84251968503937	0.9615384615384616	0.8152173913043478	0.8823529411764706	0.8647515527950309	0.6695912033862832	0.2496	508.868	64.109
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	food	2	3e-05	[[32  3]
 [17 75]]

2023-08-18 08:48:23,444 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: food iteration: 2
2023-08-18 08:48:23,444 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:23,444 - INFO - ***********************************
2023-08-18 08:48:23,444 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: apparel
2023-08-18 08:48:23,506 - INFO - TEST data count: 262
2023-08-18 08:48:24,679 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:25,371 - INFO - Metrics from the Predictions...
2023-08-18 08:48:25,372 - INFO - {'test_loss': 0.453605592250824, 'test_accuracy': 0.8129770992366412, 'test_precision': 0.82, 'test_recall': 0.8482758620689655, 'test_f1': 0.8338983050847457, 'test_roc_auc': 0.8087533156498674, 'test_matthews_correlation': 0.6205316206543435, 'test_runtime': 0.4696, 'test_samples_per_second': 557.906, 'test_steps_per_second': 70.271}
2023-08-18 08:48:25,372 - INFO - {'confusion_matrix': array([[ 90,  27],
       [ 22, 123]])}
2023-08-18 08:48:25,372 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	apparel	2	3e-05	0.453605592250824	0.8129770992366412	0.82	0.8482758620689655	0.8338983050847457	0.8087533156498674	0.6205316206543435	0.4696	557.906	70.271
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	apparel	2	3e-05	[[ 90  27]
 [ 22 123]]

2023-08-18 08:48:25,372 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:48:25,372 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:25,372 - INFO - ***********************************
2023-08-18 08:48:25,372 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: cars
2023-08-18 08:48:25,452 - INFO - TEST data count: 93
2023-08-18 08:48:26,902 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:27,260 - INFO - Metrics from the Predictions...
2023-08-18 08:48:27,260 - INFO - {'test_loss': 0.3216867744922638, 'test_accuracy': 0.8924731182795699, 'test_precision': 0.881578947368421, 'test_recall': 0.9852941176470589, 'test_f1': 0.9305555555555556, 'test_roc_auc': 0.8126470588235295, 'test_matthews_correlation': 0.7172615444247269, 'test_runtime': 0.1872, 'test_samples_per_second': 496.84, 'test_steps_per_second': 64.108}
2023-08-18 08:48:27,260 - INFO - {'confusion_matrix': array([[16,  9],
       [ 1, 67]])}
2023-08-18 08:48:27,260 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	cars	2	3e-05	0.3216867744922638	0.8924731182795699	0.881578947368421	0.9852941176470589	0.9305555555555556	0.8126470588235295	0.7172615444247269	0.1872	496.84	64.108
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	cars	2	3e-05	[[16  9]
 [ 1 67]]

2023-08-18 08:48:27,260 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: cars iteration: 2
2023-08-18 08:48:27,261 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:27,261 - INFO - ***********************************
2023-08-18 08:48:27,261 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: retail
2023-08-18 08:48:27,302 - INFO - TEST data count: 197
2023-08-18 08:48:28,439 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:28,968 - INFO - Metrics from the Predictions...
2023-08-18 08:48:28,968 - INFO - {'test_loss': 0.38949304819107056, 'test_accuracy': 0.8375634517766497, 'test_precision': 0.8688524590163934, 'test_recall': 0.8688524590163934, 'test_f1': 0.8688524590163934, 'test_roc_auc': 0.82775956284153, 'test_matthews_correlation': 0.6555191256830601, 'test_runtime': 0.3636, 'test_samples_per_second': 541.795, 'test_steps_per_second': 68.756}
2023-08-18 08:48:28,968 - INFO - {'confusion_matrix': array([[ 59,  16],
       [ 16, 106]])}
2023-08-18 08:48:28,968 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	retail	2	3e-05	0.38949304819107056	0.8375634517766497	0.8688524590163934	0.8688524590163934	0.8688524590163934	0.82775956284153	0.6555191256830601	0.3636	541.795	68.756
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	retail	2	3e-05	[[ 59  16]
 [ 16 106]]

2023-08-18 08:48:28,968 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: retail iteration: 2
2023-08-18 08:48:28,968 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:28,968 - INFO - ***********************************
2023-08-18 08:48:28,968 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: services
2023-08-18 08:48:29,006 - INFO - TEST data count: 335
2023-08-18 08:48:30,163 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:36,489 - INFO - Metrics from the Predictions...
2023-08-18 08:48:36,489 - INFO - {'test_loss': 0.5016207098960876, 'test_accuracy': 0.8149253731343283, 'test_precision': 0.7958333333333333, 'test_recall': 0.9362745098039216, 'test_f1': 0.8603603603603603, 'test_roc_auc': 0.7811143541386019, 'test_matthews_correlation': 0.6086902224645169, 'test_runtime': 0.5836, 'test_samples_per_second': 574.027, 'test_steps_per_second': 71.968}
2023-08-18 08:48:36,489 - INFO - {'confusion_matrix': array([[ 82,  49],
       [ 13, 191]])}
2023-08-18 08:48:36,490 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	services	2	3e-05	0.5016207098960876	0.8149253731343283	0.7958333333333333	0.9362745098039216	0.8603603603603603	0.7811143541386019	0.6086902224645169	0.5836	574.027	71.968
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	services	2	3e-05	[[ 82  49]
 [ 13 191]]

2023-08-18 08:48:36,490 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: services iteration: 2
2023-08-18 08:48:36,490 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:36,490 - INFO - ***********************************
2023-08-18 08:48:36,490 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: software
2023-08-18 08:48:36,490 - INFO - Train and test domains are the same: software, hence skipping
2023-08-18 08:48:36,490 - INFO - ***********************************
2023-08-18 08:48:36,490 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: transport
2023-08-18 08:48:36,528 - INFO - TEST data count: 247
2023-08-18 08:48:37,634 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:38,269 - INFO - Metrics from the Predictions...
2023-08-18 08:48:38,270 - INFO - {'test_loss': 0.5204214453697205, 'test_accuracy': 0.7935222672064778, 'test_precision': 0.7735849056603774, 'test_recall': 0.8913043478260869, 'test_f1': 0.8282828282828283, 'test_roc_auc': 0.7805145592341444, 'test_matthews_correlation': 0.5816989722422925, 'test_runtime': 0.4407, 'test_samples_per_second': 560.44, 'test_steps_per_second': 70.339}
2023-08-18 08:48:38,270 - INFO - {'confusion_matrix': array([[ 73,  36],
       [ 15, 123]])}
2023-08-18 08:48:38,270 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	transport	2	3e-05	0.5204214453697205	0.7935222672064778	0.7735849056603774	0.8913043478260869	0.8282828282828283	0.7805145592341444	0.5816989722422925	0.4407	560.44	70.339
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	transport	2	3e-05	[[ 73  36]
 [ 15 123]]

2023-08-18 08:48:38,270 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: transport iteration: 2
2023-08-18 08:48:38,270 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:38,270 - INFO - ***********************************
2023-08-18 08:48:38,270 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: electronics
2023-08-18 08:48:38,310 - INFO - TEST data count: 290
2023-08-18 08:48:44,466 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:45,361 - INFO - Metrics from the Predictions...
2023-08-18 08:48:45,362 - INFO - {'test_loss': 0.4587458670139313, 'test_accuracy': 0.8379310344827586, 'test_precision': 0.8146341463414634, 'test_recall': 0.9488636363636364, 'test_f1': 0.8766404199475065, 'test_roc_auc': 0.8077651515151516, 'test_matthews_correlation': 0.660498452810413, 'test_runtime': 0.7172, 'test_samples_per_second': 404.363, 'test_steps_per_second': 51.591}
2023-08-18 08:48:45,362 - INFO - {'confusion_matrix': array([[ 76,  38],
       [  9, 167]])}
2023-08-18 08:48:45,362 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	electronics	2	3e-05	0.4587458670139313	0.8379310344827586	0.8146341463414634	0.9488636363636364	0.8766404199475065	0.8077651515151516	0.660498452810413	0.7172	404.363	51.591
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	electronics	2	3e-05	[[ 76  38]
 [  9 167]]

2023-08-18 08:48:45,362 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:48:45,362 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:45,362 - INFO - ***********************************
2023-08-18 08:48:45,362 - INFO - For TRAIN domain: software now testing with TEST DOMAIN: other
2023-08-18 08:48:45,402 - INFO - TEST data count: 128
2023-08-18 08:48:47,562 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:48:47,963 - INFO - Metrics from the Predictions...
2023-08-18 08:48:47,963 - INFO - {'test_loss': 0.32066836953163147, 'test_accuracy': 0.8828125, 'test_precision': 0.8846153846153846, 'test_recall': 0.968421052631579, 'test_f1': 0.9246231155778896, 'test_roc_auc': 0.8023923444976075, 'test_matthews_correlation': 0.6777932975034471, 'test_runtime': 0.238, 'test_samples_per_second': 537.793, 'test_steps_per_second': 67.224}
2023-08-18 08:48:47,963 - INFO - {'confusion_matrix': array([[21, 12],
       [ 3, 92]])}
2023-08-18 08:48:47,963 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	software	other	2	3e-05	0.32066836953163147	0.8828125	0.8846153846153846	0.968421052631579	0.9246231155778896	0.8023923444976075	0.6777932975034471	0.238	537.793	67.224
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	software	other	2	3e-05	[[21 12]
 [ 3 92]]

2023-08-18 08:48:47,963 - INFO - Finished testing for TRAIN DOMAIN: software and TEST DOMAIN: other iteration: 2
2023-08-18 08:48:47,963 - INFO - ----------------------------------------------------------------------
2023-08-18 08:48:47,963 - INFO - Finished all iterations and all testing for TRAIN domain: software
2023-08-18 08:48:47,963 - INFO - Calculating mean of test metrics for TRAIN domain: software
2023-08-18 08:48:47,964 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	food	2	3e-05	0.42773674925168353	0.7926509186351706	0.9150176514306949	0.7971014492753623	0.8481461039549956	0.7890269151138716	0.5395080779361788	0.23923333333333333	531.4443333333334	66.95333333333332
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	food	2	3e-05	27.333333333333332	7.666666666666667	18.666666666666668	73.33333333333333

2023-08-18 08:48:47,964 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	apparel	2	3e-05	0.49115027983983356	0.7709923664122137	0.7704579563784276	0.8574712643678161	0.8085421984608532	0.76064446409274	0.5362231187394028	0.4722	554.847	69.88533333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	apparel	2	3e-05	77.66666666666667	39.333333333333336	20.666666666666668	124.33333333333333

2023-08-18 08:48:47,964 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	cars	2	3e-05	0.3616691629091899	0.8458781362007168	0.8496376493452518	0.9607843137254902	0.9014824092454304	0.7470588235294118	0.5766951335668519	0.1857	500.8736666666666	64.62866666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	cars	2	3e-05	13.333333333333334	11.666666666666666	2.6666666666666665	65.33333333333333

2023-08-18 08:48:47,965 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	retail	2	3e-05	0.4345109264055888	0.8087986463620981	0.8275571203286023	0.8825136612021858	0.8522977033049018	0.7857012750455373	0.589019579893245	0.35636666666666666	552.9593333333333	70.17266666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	retail	2	3e-05	51.666666666666664	23.333333333333332	14.333333333333334	107.66666666666667

2023-08-18 08:48:47,965 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	services	2	3e-05	0.5211846629778544	0.7800995024875622	0.7629103977821386	0.9297385620915032	0.8378501081726887	0.7384061767200518	0.5310139241541371	0.5876666666666667	570.1483333333334	71.48133333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	services	2	3e-05	71.66666666666667	59.333333333333336	14.333333333333334	189.66666666666666

2023-08-18 08:48:47,965 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	transport	2	3e-05	0.5419457753499349	0.7557354925775979	0.7316354443615513	0.9009661835748792	0.8062420105962906	0.7364158134999778	0.5072688681031502	0.43979999999999997	561.6170000000001	70.48633333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	transport	2	3e-05	62.333333333333336	46.666666666666664	13.666666666666666	124.33333333333333

2023-08-18 08:48:47,965 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	electronics	2	3e-05	0.4797602792580922	0.7931034482758621	0.7786895843343634	0.9261363636363636	0.8454340371632649	0.7569278309409889	0.5594597043015901	0.586	506.27566666666667	64.59366666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	electronics	2	3e-05	67.0	47.0	13.0	163.0

2023-08-18 08:48:47,966 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	software	other	2	3e-05	0.3346244692802429	0.8515625	0.8585681645087586	0.9614035087719298	0.9063936462357137	0.7483785220627327	0.5764168975593902	0.23876666666666665	536.0733333333334	67.00933333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	software	other	2	3e-05	17.666666666666668	15.333333333333334	3.6666666666666665	91.33333333333333

2023-08-18 08:48:47,966 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:48:48,175 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:48:48,175 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:48:48,176 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:48:48,176 - INFO - ********************************************************************************************************************************************
2023-08-18 08:48:48,176 - INFO - TRAIN DOMAIN: transport
2023-08-18 08:48:48,212 - INFO - Overall data count for train and dev: 247
2023-08-18 08:48:48,213 - INFO - **********************************************************************
2023-08-18 08:48:48,213 - INFO - Iteration number: 0 for TRAIN DOMAIN: transport
2023-08-18 08:48:48,213 - INFO - Tokenizing the data...
2023-08-18 08:49:00,092 - INFO - TRAIN data count: 164 and DEV data count: 83
2023-08-18 08:49:00,092 - INFO - Finetune and perform evaluation...
2023-08-18 08:49:00,092 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:49:00,092 - INFO - Setting up training args and starting training...
2023-08-18 08:49:19,892 - INFO - Training complete...
2023-08-18 08:49:19,892 - INFO - TrainOutput(global_step=84, training_loss=0.49771458762032644, metrics={'train_runtime': 17.7557, 'train_samples_per_second': 36.946, 'train_steps_per_second': 4.731, 'total_flos': 16855551984000.0, 'train_loss': 0.49771458762032644, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:49:19,892 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:49:20,770 - INFO - Report evaluation results...
2023-08-18 08:49:20,771 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	transport	na	0	3e-05	0.6665566563606262	0.5542168674698795	0.5542168674698795	1.0	0.7131782945736435	0.5	0.0	0.1592	521.433	69.106	2.25e-05	1.0	21
vinai/bertweet-base	transport	na	0	3e-05	0.5657369494438171	0.7831325301204819	0.75	0.9130434782608695	0.8235294117647057	0.7673325499412457	0.5672646476600077	0.1574	527.2	69.87	1.5e-05	2.0	42
vinai/bertweet-base	transport	na	0	3e-05	0.44300970435142517	0.8554216867469879	0.8695652173913043	0.8695652173913043	0.8695652173913043	0.8537015276145711	0.7074030552291422	0.1613	514.699	68.213	7.5e-06	3.0	63
vinai/bertweet-base	transport	na	0	3e-05	0.41245752573013306	0.8554216867469879	0.8541666666666666	0.8913043478260869	0.8723404255319149	0.8510575793184488	0.7066973886674974	0.1639	506.279	67.097	0.0	4.0	84
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	transport	na	0	3e-05	17.7557	36.946	4.731	16855551984000.0	0.49771458762032644	0.0	4.0	84

2023-08-18 08:49:20,771 - INFO - Loading the finetuned model
2023-08-18 08:49:21,742 - INFO - ***********************************
2023-08-18 08:49:21,742 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: food
2023-08-18 08:49:21,796 - INFO - TEST data count: 127
2023-08-18 08:49:22,994 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:23,474 - INFO - Metrics from the Predictions...
2023-08-18 08:49:23,474 - INFO - {'test_loss': 0.37710678577423096, 'test_accuracy': 0.84251968503937, 'test_precision': 0.9864864864864865, 'test_recall': 0.7934782608695652, 'test_f1': 0.8795180722891566, 'test_roc_auc': 0.8824534161490682, 'test_matthews_correlation': 0.6930789061907789, 'test_runtime': 0.233, 'test_samples_per_second': 544.992, 'test_steps_per_second': 68.66}
2023-08-18 08:49:23,474 - INFO - {'confusion_matrix': array([[34,  1],
       [19, 73]])}
2023-08-18 08:49:23,474 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	food	0	3e-05	0.37710678577423096	0.84251968503937	0.9864864864864865	0.7934782608695652	0.8795180722891566	0.8824534161490682	0.6930789061907789	0.233	544.992	68.66
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	food	0	3e-05	[[34  1]
 [19 73]]

2023-08-18 08:49:23,474 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: food iteration: 0
2023-08-18 08:49:23,474 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:23,474 - INFO - ***********************************
2023-08-18 08:49:23,474 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: apparel
2023-08-18 08:49:23,518 - INFO - TEST data count: 262
2023-08-18 08:49:29,758 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:30,414 - INFO - Metrics from the Predictions...
2023-08-18 08:49:30,414 - INFO - {'test_loss': 0.3819177746772766, 'test_accuracy': 0.8587786259541985, 'test_precision': 0.9153846153846154, 'test_recall': 0.8206896551724138, 'test_f1': 0.8654545454545454, 'test_roc_auc': 0.8633362805776599, 'test_matthews_correlation': 0.7225319430563322, 'test_runtime': 0.458, 'test_samples_per_second': 572.061, 'test_steps_per_second': 72.053}
2023-08-18 08:49:30,414 - INFO - {'confusion_matrix': array([[106,  11],
       [ 26, 119]])}
2023-08-18 08:49:30,414 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	apparel	0	3e-05	0.3819177746772766	0.8587786259541985	0.9153846153846154	0.8206896551724138	0.8654545454545454	0.8633362805776599	0.7225319430563322	0.458	572.061	72.053
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	apparel	0	3e-05	[[106  11]
 [ 26 119]]

2023-08-18 08:49:30,414 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:49:30,414 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:30,414 - INFO - ***********************************
2023-08-18 08:49:30,414 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: cars
2023-08-18 08:49:30,451 - INFO - TEST data count: 93
2023-08-18 08:49:31,611 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:31,957 - INFO - Metrics from the Predictions...
2023-08-18 08:49:31,957 - INFO - {'test_loss': 0.3790757656097412, 'test_accuracy': 0.8494623655913979, 'test_precision': 0.8970588235294118, 'test_recall': 0.8970588235294118, 'test_f1': 0.8970588235294118, 'test_roc_auc': 0.8085294117647058, 'test_matthews_correlation': 0.6170588235294118, 'test_runtime': 0.1847, 'test_samples_per_second': 503.463, 'test_steps_per_second': 64.963}
2023-08-18 08:49:31,957 - INFO - {'confusion_matrix': array([[18,  7],
       [ 7, 61]])}
2023-08-18 08:49:31,957 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	cars	0	3e-05	0.3790757656097412	0.8494623655913979	0.8970588235294118	0.8970588235294118	0.8970588235294118	0.8085294117647058	0.6170588235294118	0.1847	503.463	64.963
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	cars	0	3e-05	[[18  7]
 [ 7 61]]

2023-08-18 08:49:31,957 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: cars iteration: 0
2023-08-18 08:49:31,957 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:31,957 - INFO - ***********************************
2023-08-18 08:49:31,957 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: retail
2023-08-18 08:49:32,004 - INFO - TEST data count: 197
2023-08-18 08:49:33,115 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:33,624 - INFO - Metrics from the Predictions...
2023-08-18 08:49:33,624 - INFO - {'test_loss': 0.3827870190143585, 'test_accuracy': 0.8730964467005076, 'test_precision': 0.944954128440367, 'test_recall': 0.8442622950819673, 'test_f1': 0.8917748917748918, 'test_roc_auc': 0.8821311475409838, 'test_matthews_correlation': 0.7464460017990396, 'test_runtime': 0.3466, 'test_samples_per_second': 568.433, 'test_steps_per_second': 72.136}
2023-08-18 08:49:33,624 - INFO - {'confusion_matrix': array([[ 69,   6],
       [ 19, 103]])}
2023-08-18 08:49:33,624 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	retail	0	3e-05	0.3827870190143585	0.8730964467005076	0.944954128440367	0.8442622950819673	0.8917748917748918	0.8821311475409838	0.7464460017990396	0.3466	568.433	72.136
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	retail	0	3e-05	[[ 69   6]
 [ 19 103]]

2023-08-18 08:49:33,624 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: retail iteration: 0
2023-08-18 08:49:33,624 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:33,624 - INFO - ***********************************
2023-08-18 08:49:33,624 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: services
2023-08-18 08:49:33,668 - INFO - TEST data count: 335
2023-08-18 08:49:34,784 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:35,524 - INFO - Metrics from the Predictions...
2023-08-18 08:49:35,524 - INFO - {'test_loss': 0.3884078860282898, 'test_accuracy': 0.8567164179104477, 'test_precision': 0.8679245283018868, 'test_recall': 0.9019607843137255, 'test_f1': 0.8846153846153846, 'test_roc_auc': 0.844110163149229, 'test_matthews_correlation': 0.6967191385033065, 'test_runtime': 0.5944, 'test_samples_per_second': 563.587, 'test_steps_per_second': 70.659}
2023-08-18 08:49:35,524 - INFO - {'confusion_matrix': array([[103,  28],
       [ 20, 184]])}
2023-08-18 08:49:35,524 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	services	0	3e-05	0.3884078860282898	0.8567164179104477	0.8679245283018868	0.9019607843137255	0.8846153846153846	0.844110163149229	0.6967191385033065	0.5944	563.587	70.659
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	services	0	3e-05	[[103  28]
 [ 20 184]]

2023-08-18 08:49:35,524 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: services iteration: 0
2023-08-18 08:49:35,524 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:35,524 - INFO - ***********************************
2023-08-18 08:49:35,524 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: software
2023-08-18 08:49:35,563 - INFO - TEST data count: 295
2023-08-18 08:49:36,709 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:39,385 - INFO - Metrics from the Predictions...
2023-08-18 08:49:39,385 - INFO - {'test_loss': 0.37868532538414, 'test_accuracy': 0.8576271186440678, 'test_precision': 0.8947368421052632, 'test_recall': 0.8854166666666666, 'test_f1': 0.8900523560209423, 'test_roc_auc': 0.8456209546925566, 'test_matthews_correlation': 0.6882208693269682, 'test_runtime': 0.5213, 'test_samples_per_second': 565.843, 'test_steps_per_second': 70.97}
2023-08-18 08:49:39,385 - INFO - {'confusion_matrix': array([[ 83,  20],
       [ 22, 170]])}
2023-08-18 08:49:39,386 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	software	0	3e-05	0.37868532538414	0.8576271186440678	0.8947368421052632	0.8854166666666666	0.8900523560209423	0.8456209546925566	0.6882208693269682	0.5213	565.843	70.97
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	software	0	3e-05	[[ 83  20]
 [ 22 170]]

2023-08-18 08:49:39,386 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: software iteration: 0
2023-08-18 08:49:39,386 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:39,386 - INFO - ***********************************
2023-08-18 08:49:39,386 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: transport
2023-08-18 08:49:39,386 - INFO - Train and test domains are the same: transport, hence skipping
2023-08-18 08:49:39,386 - INFO - ***********************************
2023-08-18 08:49:39,386 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: electronics
2023-08-18 08:49:39,425 - INFO - TEST data count: 290
2023-08-18 08:49:40,587 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:41,282 - INFO - Metrics from the Predictions...
2023-08-18 08:49:41,282 - INFO - {'test_loss': 0.44155779480934143, 'test_accuracy': 0.7965517241379311, 'test_precision': 0.8232044198895028, 'test_recall': 0.8465909090909091, 'test_f1': 0.8347338935574229, 'test_roc_auc': 0.7829445773524721, 'test_matthews_correlation': 0.5706733527594356, 'test_runtime': 0.5087, 'test_samples_per_second': 570.078, 'test_steps_per_second': 72.734}
2023-08-18 08:49:41,282 - INFO - {'confusion_matrix': array([[ 82,  32],
       [ 27, 149]])}
2023-08-18 08:49:41,282 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	electronics	0	3e-05	0.44155779480934143	0.7965517241379311	0.8232044198895028	0.8465909090909091	0.8347338935574229	0.7829445773524721	0.5706733527594356	0.5087	570.078	72.734
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	electronics	0	3e-05	[[ 82  32]
 [ 27 149]]

2023-08-18 08:49:41,282 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:49:41,282 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:41,283 - INFO - ***********************************
2023-08-18 08:49:41,283 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: other
2023-08-18 08:49:41,333 - INFO - TEST data count: 128
2023-08-18 08:49:42,436 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:49:42,836 - INFO - Metrics from the Predictions...
2023-08-18 08:49:42,836 - INFO - {'test_loss': 0.31654858589172363, 'test_accuracy': 0.875, 'test_precision': 0.9647058823529412, 'test_recall': 0.8631578947368421, 'test_f1': 0.9111111111111111, 'test_roc_auc': 0.8861244019138755, 'test_matthews_correlation': 0.7152079383602832, 'test_runtime': 0.2469, 'test_samples_per_second': 518.454, 'test_steps_per_second': 64.807}
2023-08-18 08:49:42,836 - INFO - {'confusion_matrix': array([[30,  3],
       [13, 82]])}
2023-08-18 08:49:42,836 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	other	0	3e-05	0.31654858589172363	0.875	0.9647058823529412	0.8631578947368421	0.9111111111111111	0.8861244019138755	0.7152079383602832	0.2469	518.454	64.807
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	other	0	3e-05	[[30  3]
 [13 82]]

2023-08-18 08:49:42,836 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: other iteration: 0
2023-08-18 08:49:42,836 - INFO - ----------------------------------------------------------------------
2023-08-18 08:49:42,836 - INFO - **********************************************************************
2023-08-18 08:49:42,836 - INFO - Iteration number: 1 for TRAIN DOMAIN: transport
2023-08-18 08:49:42,836 - INFO - Tokenizing the data...
2023-08-18 08:49:44,659 - INFO - TRAIN data count: 165 and DEV data count: 82
2023-08-18 08:49:44,659 - INFO - Finetune and perform evaluation...
2023-08-18 08:49:44,659 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:49:44,659 - INFO - Setting up training args and starting training...
2023-08-18 08:50:03,607 - INFO - Training complete...
2023-08-18 08:50:03,607 - INFO - TrainOutput(global_step=84, training_loss=0.6172718320574079, metrics={'train_runtime': 17.7521, 'train_samples_per_second': 37.179, 'train_steps_per_second': 4.732, 'total_flos': 16958329740000.0, 'train_loss': 0.6172718320574079, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:50:03,607 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:50:04,502 - INFO - Report evaluation results...
2023-08-18 08:50:04,502 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	transport	na	1	3e-05	0.6600962281227112	0.573170731707317	0.5714285714285714	0.9565217391304348	0.7154471544715447	0.5199275362318841	0.08265771673985413	0.1599	512.888	68.802	2.25e-05	1.0	21
vinai/bertweet-base	transport	na	1	3e-05	0.6159352660179138	0.6585365853658537	0.6323529411764706	0.9347826086956522	0.7543859649122806	0.6201690821256038	0.316981876208274	0.1604	511.092	68.561	1.5e-05	2.0	42
vinai/bertweet-base	transport	na	1	3e-05	0.5734381079673767	0.6585365853658537	0.6666666666666666	0.782608695652174	0.72	0.6413043478260869	0.2957602408756385	0.1605	510.817	68.524	7.5e-06	3.0	63
vinai/bertweet-base	transport	na	1	3e-05	0.5411209464073181	0.7317073170731707	0.75	0.782608695652174	0.7659574468085107	0.7246376811594204	0.45256680091718243	0.1621	505.717	67.84	0.0	4.0	84
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	transport	na	1	3e-05	17.7521	37.179	4.732	16958329740000.0	0.6172718320574079	0.0	4.0	84

2023-08-18 08:50:04,503 - INFO - Loading the finetuned model
2023-08-18 08:50:05,652 - INFO - ***********************************
2023-08-18 08:50:05,652 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: food
2023-08-18 08:50:05,845 - INFO - TEST data count: 127
2023-08-18 08:50:07,273 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:07,785 - INFO - Metrics from the Predictions...
2023-08-18 08:50:07,785 - INFO - {'test_loss': 0.5646011829376221, 'test_accuracy': 0.7637795275590551, 'test_precision': 0.9305555555555556, 'test_recall': 0.7282608695652174, 'test_f1': 0.8170731707317073, 'test_roc_auc': 0.7927018633540373, 'test_matthews_correlation': 0.5278807508159395, 'test_runtime': 0.2353, 'test_samples_per_second': 539.712, 'test_steps_per_second': 67.995}
2023-08-18 08:50:07,785 - INFO - {'confusion_matrix': array([[30,  5],
       [25, 67]])}
2023-08-18 08:50:07,785 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	food	1	3e-05	0.5646011829376221	0.7637795275590551	0.9305555555555556	0.7282608695652174	0.8170731707317073	0.7927018633540373	0.5278807508159395	0.2353	539.712	67.995
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	food	1	3e-05	[[30  5]
 [25 67]]

2023-08-18 08:50:07,785 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: food iteration: 1
2023-08-18 08:50:07,785 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:07,785 - INFO - ***********************************
2023-08-18 08:50:07,785 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: apparel
2023-08-18 08:50:07,826 - INFO - TEST data count: 262
2023-08-18 08:50:13,949 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:14,571 - INFO - Metrics from the Predictions...
2023-08-18 08:50:14,571 - INFO - {'test_loss': 0.5768523812294006, 'test_accuracy': 0.7251908396946565, 'test_precision': 0.7664233576642335, 'test_recall': 0.7241379310344828, 'test_f1': 0.7446808510638298, 'test_roc_auc': 0.7253168287651046, 'test_matthews_correlation': 0.4485235673530995, 'test_runtime': 0.4709, 'test_samples_per_second': 556.399, 'test_steps_per_second': 70.081}
2023-08-18 08:50:14,571 - INFO - {'confusion_matrix': array([[ 85,  32],
       [ 40, 105]])}
2023-08-18 08:50:14,571 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	apparel	1	3e-05	0.5768523812294006	0.7251908396946565	0.7664233576642335	0.7241379310344828	0.7446808510638298	0.7253168287651046	0.4485235673530995	0.4709	556.399	70.081
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	apparel	1	3e-05	[[ 85  32]
 [ 40 105]]

2023-08-18 08:50:14,571 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:50:14,571 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:14,571 - INFO - ***********************************
2023-08-18 08:50:14,571 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: cars
2023-08-18 08:50:14,614 - INFO - TEST data count: 93
2023-08-18 08:50:20,764 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:21,107 - INFO - Metrics from the Predictions...
2023-08-18 08:50:21,108 - INFO - {'test_loss': 0.5343453288078308, 'test_accuracy': 0.8064516129032258, 'test_precision': 0.8472222222222222, 'test_recall': 0.8970588235294118, 'test_f1': 0.8714285714285713, 'test_roc_auc': 0.728529411764706, 'test_matthews_correlation': 0.48464156959591503, 'test_runtime': 0.1869, 'test_samples_per_second': 497.681, 'test_steps_per_second': 64.217}
2023-08-18 08:50:21,108 - INFO - {'confusion_matrix': array([[14, 11],
       [ 7, 61]])}
2023-08-18 08:50:21,108 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	cars	1	3e-05	0.5343453288078308	0.8064516129032258	0.8472222222222222	0.8970588235294118	0.8714285714285713	0.728529411764706	0.48464156959591503	0.1869	497.681	64.217
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	cars	1	3e-05	[[14 11]
 [ 7 61]]

2023-08-18 08:50:21,108 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: cars iteration: 1
2023-08-18 08:50:21,108 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:21,108 - INFO - ***********************************
2023-08-18 08:50:21,108 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: retail
2023-08-18 08:50:21,146 - INFO - TEST data count: 197
2023-08-18 08:50:22,270 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:27,783 - INFO - Metrics from the Predictions...
2023-08-18 08:50:27,783 - INFO - {'test_loss': 0.5506793856620789, 'test_accuracy': 0.7614213197969543, 'test_precision': 0.8260869565217391, 'test_recall': 0.7786885245901639, 'test_f1': 0.8016877637130801, 'test_roc_auc': 0.7560109289617487, 'test_matthews_correlation': 0.5043629797178002, 'test_runtime': 0.3514, 'test_samples_per_second': 560.579, 'test_steps_per_second': 71.139}
2023-08-18 08:50:27,783 - INFO - {'confusion_matrix': array([[55, 20],
       [27, 95]])}
2023-08-18 08:50:27,783 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	retail	1	3e-05	0.5506793856620789	0.7614213197969543	0.8260869565217391	0.7786885245901639	0.8016877637130801	0.7560109289617487	0.5043629797178002	0.3514	560.579	71.139
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	retail	1	3e-05	[[55 20]
 [27 95]]

2023-08-18 08:50:27,783 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: retail iteration: 1
2023-08-18 08:50:27,783 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:27,783 - INFO - ***********************************
2023-08-18 08:50:27,783 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: services
2023-08-18 08:50:27,831 - INFO - TEST data count: 335
2023-08-18 08:50:29,034 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:29,802 - INFO - Metrics from the Predictions...
2023-08-18 08:50:29,803 - INFO - {'test_loss': 0.5586898326873779, 'test_accuracy': 0.7432835820895523, 'test_precision': 0.780952380952381, 'test_recall': 0.803921568627451, 'test_f1': 0.7922705314009661, 'test_roc_auc': 0.7263882652297562, 'test_matthews_correlation': 0.4568461664003216, 'test_runtime': 0.5896, 'test_samples_per_second': 568.149, 'test_steps_per_second': 71.231}
2023-08-18 08:50:29,803 - INFO - {'confusion_matrix': array([[ 85,  46],
       [ 40, 164]])}
2023-08-18 08:50:29,803 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	services	1	3e-05	0.5586898326873779	0.7432835820895523	0.780952380952381	0.803921568627451	0.7922705314009661	0.7263882652297562	0.4568461664003216	0.5896	568.149	71.231
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	services	1	3e-05	[[ 85  46]
 [ 40 164]]

2023-08-18 08:50:29,803 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: services iteration: 1
2023-08-18 08:50:29,803 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:29,803 - INFO - ***********************************
2023-08-18 08:50:29,803 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: software
2023-08-18 08:50:29,862 - INFO - TEST data count: 295
2023-08-18 08:50:31,162 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:31,842 - INFO - Metrics from the Predictions...
2023-08-18 08:50:31,842 - INFO - {'test_loss': 0.547263503074646, 'test_accuracy': 0.7966101694915254, 'test_precision': 0.8793103448275862, 'test_recall': 0.796875, 'test_f1': 0.8360655737704917, 'test_roc_auc': 0.7964957524271845, 'test_matthews_correlation': 0.5747121638813258, 'test_runtime': 0.5196, 'test_samples_per_second': 567.727, 'test_steps_per_second': 71.206}
2023-08-18 08:50:31,842 - INFO - {'confusion_matrix': array([[ 82,  21],
       [ 39, 153]])}
2023-08-18 08:50:31,842 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	software	1	3e-05	0.547263503074646	0.7966101694915254	0.8793103448275862	0.796875	0.8360655737704917	0.7964957524271845	0.5747121638813258	0.5196	567.727	71.206
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	software	1	3e-05	[[ 82  21]
 [ 39 153]]

2023-08-18 08:50:31,842 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: software iteration: 1
2023-08-18 08:50:31,842 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:31,842 - INFO - ***********************************
2023-08-18 08:50:31,842 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: transport
2023-08-18 08:50:31,842 - INFO - Train and test domains are the same: transport, hence skipping
2023-08-18 08:50:31,842 - INFO - ***********************************
2023-08-18 08:50:31,842 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: electronics
2023-08-18 08:50:31,884 - INFO - TEST data count: 290
2023-08-18 08:50:33,017 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:33,700 - INFO - Metrics from the Predictions...
2023-08-18 08:50:33,700 - INFO - {'test_loss': 0.5698144435882568, 'test_accuracy': 0.7586206896551724, 'test_precision': 0.8192771084337349, 'test_recall': 0.7727272727272727, 'test_f1': 0.7953216374269007, 'test_roc_auc': 0.7547846889952153, 'test_matthews_correlation': 0.5030917489283504, 'test_runtime': 0.5076, 'test_samples_per_second': 571.328, 'test_steps_per_second': 72.894}
2023-08-18 08:50:33,700 - INFO - {'confusion_matrix': array([[ 84,  30],
       [ 40, 136]])}
2023-08-18 08:50:33,700 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	electronics	1	3e-05	0.5698144435882568	0.7586206896551724	0.8192771084337349	0.7727272727272727	0.7953216374269007	0.7547846889952153	0.5030917489283504	0.5076	571.328	72.894
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	electronics	1	3e-05	[[ 84  30]
 [ 40 136]]

2023-08-18 08:50:33,700 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:50:33,701 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:33,701 - INFO - ***********************************
2023-08-18 08:50:33,701 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: other
2023-08-18 08:50:33,746 - INFO - TEST data count: 128
2023-08-18 08:50:34,997 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:35,474 - INFO - Metrics from the Predictions...
2023-08-18 08:50:35,474 - INFO - {'test_loss': 0.48831623792648315, 'test_accuracy': 0.8203125, 'test_precision': 0.8913043478260869, 'test_recall': 0.8631578947368421, 'test_f1': 0.8770053475935828, 'test_roc_auc': 0.7800637958532697, 'test_matthews_correlation': 0.5449549163190056, 'test_runtime': 0.3193, 'test_samples_per_second': 400.898, 'test_steps_per_second': 50.112}
2023-08-18 08:50:35,474 - INFO - {'confusion_matrix': array([[23, 10],
       [13, 82]])}
2023-08-18 08:50:35,474 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	other	1	3e-05	0.48831623792648315	0.8203125	0.8913043478260869	0.8631578947368421	0.8770053475935828	0.7800637958532697	0.5449549163190056	0.3193	400.898	50.112
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	other	1	3e-05	[[23 10]
 [13 82]]

2023-08-18 08:50:35,474 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: other iteration: 1
2023-08-18 08:50:35,474 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:35,475 - INFO - **********************************************************************
2023-08-18 08:50:35,475 - INFO - Iteration number: 2 for TRAIN DOMAIN: transport
2023-08-18 08:50:35,475 - INFO - Tokenizing the data...
2023-08-18 08:50:37,351 - INFO - TRAIN data count: 165 and DEV data count: 82
2023-08-18 08:50:37,351 - INFO - Finetune and perform evaluation...
2023-08-18 08:50:37,351 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:50:37,351 - INFO - Setting up training args and starting training...
2023-08-18 08:50:56,313 - INFO - Training complete...
2023-08-18 08:50:56,313 - INFO - TrainOutput(global_step=84, training_loss=0.5361549286615281, metrics={'train_runtime': 17.8893, 'train_samples_per_second': 36.893, 'train_steps_per_second': 4.696, 'total_flos': 16958329740000.0, 'train_loss': 0.5361549286615281, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:50:56,313 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:50:57,201 - INFO - Report evaluation results...
2023-08-18 08:50:57,202 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	transport	na	2	3e-05	0.670548677444458	0.6707317073170732	0.7209302325581395	0.6739130434782609	0.6966292134831461	0.6702898550724639	0.3384405611474175	0.2026	404.653	54.283	2.25e-05	1.0	21
vinai/bertweet-base	transport	na	2	3e-05	0.5953704714775085	0.7439024390243902	0.7659574468085106	0.782608695652174	0.7741935483870968	0.7385265700483091	0.47864549304252946	0.1645	498.615	66.887	1.5e-05	2.0	42
vinai/bertweet-base	transport	na	2	3e-05	0.47540032863616943	0.7926829268292683	0.7636363636363637	0.9130434782608695	0.8316831683168316	0.7759661835748791	0.582844634295617	0.1594	514.576	69.029	7.5e-06	3.0	63
vinai/bertweet-base	transport	na	2	3e-05	0.39658838510513306	0.8658536585365854	0.8723404255319149	0.8913043478260869	0.8817204301075269	0.8623188405797102	0.7270564451278929	0.164	499.911	67.061	0.0	4.0	84
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	transport	na	2	3e-05	17.8893	36.893	4.696	16958329740000.0	0.5361549286615281	0.0	4.0	84

2023-08-18 08:50:57,202 - INFO - Loading the finetuned model
2023-08-18 08:50:58,150 - INFO - ***********************************
2023-08-18 08:50:58,151 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: food
2023-08-18 08:50:58,196 - INFO - TEST data count: 127
2023-08-18 08:50:59,323 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:50:59,798 - INFO - Metrics from the Predictions...
2023-08-18 08:50:59,798 - INFO - {'test_loss': 0.3922576904296875, 'test_accuracy': 0.84251968503937, 'test_precision': 0.9864864864864865, 'test_recall': 0.7934782608695652, 'test_f1': 0.8795180722891566, 'test_roc_auc': 0.8824534161490682, 'test_matthews_correlation': 0.6930789061907789, 'test_runtime': 0.2463, 'test_samples_per_second': 515.566, 'test_steps_per_second': 64.953}
2023-08-18 08:50:59,798 - INFO - {'confusion_matrix': array([[34,  1],
       [19, 73]])}
2023-08-18 08:50:59,798 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	food	2	3e-05	0.3922576904296875	0.84251968503937	0.9864864864864865	0.7934782608695652	0.8795180722891566	0.8824534161490682	0.6930789061907789	0.2463	515.566	64.953
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	food	2	3e-05	[[34  1]
 [19 73]]

2023-08-18 08:50:59,798 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: food iteration: 2
2023-08-18 08:50:59,798 - INFO - ----------------------------------------------------------------------
2023-08-18 08:50:59,798 - INFO - ***********************************
2023-08-18 08:50:59,798 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: apparel
2023-08-18 08:50:59,838 - INFO - TEST data count: 262
2023-08-18 08:51:00,968 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:01,592 - INFO - Metrics from the Predictions...
2023-08-18 08:51:01,592 - INFO - {'test_loss': 0.40815719962120056, 'test_accuracy': 0.8435114503816794, 'test_precision': 0.9193548387096774, 'test_recall': 0.7862068965517242, 'test_f1': 0.8475836431226766, 'test_roc_auc': 0.8503684055408194, 'test_matthews_correlation': 0.6977204924505712, 'test_runtime': 0.4648, 'test_samples_per_second': 563.651, 'test_steps_per_second': 70.994}
2023-08-18 08:51:01,592 - INFO - {'confusion_matrix': array([[107,  10],
       [ 31, 114]])}
2023-08-18 08:51:01,593 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	apparel	2	3e-05	0.40815719962120056	0.8435114503816794	0.9193548387096774	0.7862068965517242	0.8475836431226766	0.8503684055408194	0.6977204924505712	0.4648	563.651	70.994
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	apparel	2	3e-05	[[107  10]
 [ 31 114]]

2023-08-18 08:51:01,593 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:51:01,593 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:01,593 - INFO - ***********************************
2023-08-18 08:51:01,593 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: cars
2023-08-18 08:51:01,630 - INFO - TEST data count: 93
2023-08-18 08:51:02,841 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:03,189 - INFO - Metrics from the Predictions...
2023-08-18 08:51:03,190 - INFO - {'test_loss': 0.3422470986843109, 'test_accuracy': 0.8924731182795699, 'test_precision': 0.9264705882352942, 'test_recall': 0.9264705882352942, 'test_f1': 0.9264705882352942, 'test_roc_auc': 0.8632352941176471, 'test_matthews_correlation': 0.7264705882352941, 'test_runtime': 0.1847, 'test_samples_per_second': 503.398, 'test_steps_per_second': 64.955}
2023-08-18 08:51:03,190 - INFO - {'confusion_matrix': array([[20,  5],
       [ 5, 63]])}
2023-08-18 08:51:03,190 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	cars	2	3e-05	0.3422470986843109	0.8924731182795699	0.9264705882352942	0.9264705882352942	0.9264705882352942	0.8632352941176471	0.7264705882352941	0.1847	503.398	64.955
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	cars	2	3e-05	[[20  5]
 [ 5 63]]

2023-08-18 08:51:03,190 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: cars iteration: 2
2023-08-18 08:51:03,190 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:03,190 - INFO - ***********************************
2023-08-18 08:51:03,190 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: retail
2023-08-18 08:51:03,228 - INFO - TEST data count: 197
2023-08-18 08:51:09,384 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:09,919 - INFO - Metrics from the Predictions...
2023-08-18 08:51:09,919 - INFO - {'test_loss': 0.3924885094165802, 'test_accuracy': 0.8527918781725888, 'test_precision': 0.926605504587156, 'test_recall': 0.8278688524590164, 'test_f1': 0.8744588744588746, 'test_roc_auc': 0.8606010928961748, 'test_matthews_correlation': 0.7043896991093755, 'test_runtime': 0.3622, 'test_samples_per_second': 543.834, 'test_steps_per_second': 69.014}
2023-08-18 08:51:09,919 - INFO - {'confusion_matrix': array([[ 67,   8],
       [ 21, 101]])}
2023-08-18 08:51:09,919 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	retail	2	3e-05	0.3924885094165802	0.8527918781725888	0.926605504587156	0.8278688524590164	0.8744588744588746	0.8606010928961748	0.7043896991093755	0.3622	543.834	69.014
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	retail	2	3e-05	[[ 67   8]
 [ 21 101]]

2023-08-18 08:51:09,919 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: retail iteration: 2
2023-08-18 08:51:09,919 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:09,919 - INFO - ***********************************
2023-08-18 08:51:09,919 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: services
2023-08-18 08:51:09,959 - INFO - TEST data count: 335
2023-08-18 08:51:11,131 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:11,870 - INFO - Metrics from the Predictions...
2023-08-18 08:51:11,870 - INFO - {'test_loss': 0.38237491250038147, 'test_accuracy': 0.8597014925373134, 'test_precision': 0.8755980861244019, 'test_recall': 0.8970588235294118, 'test_f1': 0.8861985472154964, 'test_roc_auc': 0.8492927705433317, 'test_matthews_correlation': 0.7037394683085627, 'test_runtime': 0.58, 'test_samples_per_second': 577.596, 'test_steps_per_second': 72.415}
2023-08-18 08:51:11,870 - INFO - {'confusion_matrix': array([[105,  26],
       [ 21, 183]])}
2023-08-18 08:51:11,871 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	services	2	3e-05	0.38237491250038147	0.8597014925373134	0.8755980861244019	0.8970588235294118	0.8861985472154964	0.8492927705433317	0.7037394683085627	0.58	577.596	72.415
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	services	2	3e-05	[[105  26]
 [ 21 183]]

2023-08-18 08:51:11,871 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: services iteration: 2
2023-08-18 08:51:11,871 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:11,871 - INFO - ***********************************
2023-08-18 08:51:11,871 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: software
2023-08-18 08:51:11,918 - INFO - TEST data count: 295
2023-08-18 08:51:14,085 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:14,943 - INFO - Metrics from the Predictions...
2023-08-18 08:51:14,943 - INFO - {'test_loss': 0.36761152744293213, 'test_accuracy': 0.8779661016949153, 'test_precision': 0.9333333333333333, 'test_recall': 0.875, 'test_f1': 0.9032258064516129, 'test_roc_auc': 0.879247572815534, 'test_matthews_correlation': 0.7413731607637101, 'test_runtime': 0.6767, 'test_samples_per_second': 435.954, 'test_steps_per_second': 54.679}
2023-08-18 08:51:14,943 - INFO - {'confusion_matrix': array([[ 91,  12],
       [ 24, 168]])}
2023-08-18 08:51:14,943 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	software	2	3e-05	0.36761152744293213	0.8779661016949153	0.9333333333333333	0.875	0.9032258064516129	0.879247572815534	0.7413731607637101	0.6767	435.954	54.679
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	software	2	3e-05	[[ 91  12]
 [ 24 168]]

2023-08-18 08:51:14,944 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: software iteration: 2
2023-08-18 08:51:14,944 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:14,944 - INFO - ***********************************
2023-08-18 08:51:14,944 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: transport
2023-08-18 08:51:14,944 - INFO - Train and test domains are the same: transport, hence skipping
2023-08-18 08:51:14,944 - INFO - ***********************************
2023-08-18 08:51:14,944 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: electronics
2023-08-18 08:51:15,307 - INFO - TEST data count: 290
2023-08-18 08:51:16,522 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:17,205 - INFO - Metrics from the Predictions...
2023-08-18 08:51:17,205 - INFO - {'test_loss': 0.43337303400039673, 'test_accuracy': 0.8068965517241379, 'test_precision': 0.8296703296703297, 'test_recall': 0.8579545454545454, 'test_f1': 0.8435754189944134, 'test_roc_auc': 0.793012360446571, 'test_matthews_correlation': 0.5920755465320788, 'test_runtime': 0.5119, 'test_samples_per_second': 566.483, 'test_steps_per_second': 72.275}
2023-08-18 08:51:17,205 - INFO - {'confusion_matrix': array([[ 83,  31],
       [ 25, 151]])}
2023-08-18 08:51:17,205 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	electronics	2	3e-05	0.43337303400039673	0.8068965517241379	0.8296703296703297	0.8579545454545454	0.8435754189944134	0.793012360446571	0.5920755465320788	0.5119	566.483	72.275
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	electronics	2	3e-05	[[ 83  31]
 [ 25 151]]

2023-08-18 08:51:17,205 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:51:17,205 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:17,205 - INFO - ***********************************
2023-08-18 08:51:17,205 - INFO - For TRAIN domain: transport now testing with TEST DOMAIN: other
2023-08-18 08:51:17,279 - INFO - TEST data count: 128
2023-08-18 08:51:18,459 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:18,905 - INFO - Metrics from the Predictions...
2023-08-18 08:51:18,905 - INFO - {'test_loss': 0.2800019085407257, 'test_accuracy': 0.9375, 'test_precision': 0.9887640449438202, 'test_recall': 0.9263157894736842, 'test_f1': 0.9565217391304348, 'test_roc_auc': 0.9480063795853271, 'test_matthews_correlation': 0.8515411893448154, 'test_runtime': 0.2369, 'test_samples_per_second': 540.24, 'test_steps_per_second': 67.53}
2023-08-18 08:51:18,905 - INFO - {'confusion_matrix': array([[32,  1],
       [ 7, 88]])}
2023-08-18 08:51:18,905 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	transport	other	2	3e-05	0.2800019085407257	0.9375	0.9887640449438202	0.9263157894736842	0.9565217391304348	0.9480063795853271	0.8515411893448154	0.2369	540.24	67.53
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	transport	other	2	3e-05	[[32  1]
 [ 7 88]]

2023-08-18 08:51:18,905 - INFO - Finished testing for TRAIN DOMAIN: transport and TEST DOMAIN: other iteration: 2
2023-08-18 08:51:18,905 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:18,905 - INFO - Finished all iterations and all testing for TRAIN domain: transport
2023-08-18 08:51:18,905 - INFO - Calculating mean of test metrics for TRAIN domain: transport
2023-08-18 08:51:18,906 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	food	2	3e-05	0.44465521971384686	0.816272965879265	0.9678428428428428	0.7717391304347826	0.8587031051033401	0.8525362318840579	0.6380128543991658	0.2382	533.4233333333333	67.20266666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	food	2	3e-05	32.666666666666664	2.3333333333333335	21.0	71.0

2023-08-18 08:51:18,906 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	apparel	2	3e-05	0.4556424518426259	0.8091603053435114	0.8670542705861753	0.7770114942528735	0.8192396798803506	0.8130071716278614	0.6229253342866676	0.46456666666666663	564.0369999999999	71.04266666666668
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	apparel	2	3e-05	99.33333333333333	17.666666666666668	32.333333333333336	112.66666666666667

2023-08-18 08:51:18,906 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	cars	2	3e-05	0.4185560643672943	0.8494623655913979	0.8902505446623094	0.9068627450980392	0.8983193277310925	0.8000980392156863	0.6093903271202069	0.18543333333333334	501.51399999999995	64.71166666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	cars	2	3e-05	17.333333333333332	7.666666666666667	6.333333333333333	61.666666666666664

2023-08-18 08:51:18,907 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	retail	2	3e-05	0.4419849713643392	0.8291032148900168	0.8992155298497541	0.8169398907103825	0.8559738433156155	0.8329143897996357	0.6517328935420719	0.3534	557.6153333333333	70.76299999999999
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	retail	2	3e-05	63.666666666666664	11.333333333333334	22.333333333333332	99.66666666666667

2023-08-18 08:51:18,907 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	services	2	3e-05	0.44315754373868305	0.8199004975124379	0.8414916651262233	0.8676470588235294	0.854361487743949	0.806597066307439	0.6191015910707303	0.5880000000000001	569.7773333333333	71.435
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	services	2	3e-05	97.66666666666667	33.333333333333336	27.0	177.0

2023-08-18 08:51:18,907 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	software	2	3e-05	0.4311867853005727	0.8440677966101696	0.9024601734220609	0.8524305555555555	0.8764479120810157	0.840454759978425	0.6681020646573348	0.5725333333333333	523.1746666666667	65.61833333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	software	2	3e-05	85.33333333333333	17.666666666666668	28.333333333333332	163.66666666666666

2023-08-18 08:51:18,908 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	electronics	2	3e-05	0.48158175746599835	0.7873563218390806	0.8240506193311892	0.8257575757575757	0.8245436499929123	0.7769138755980861	0.5552802160732883	0.5094000000000001	569.2963333333333	72.63433333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	electronics	2	3e-05	83.0	31.0	30.666666666666668	145.33333333333334

2023-08-18 08:51:18,908 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	transport	other	2	3e-05	0.36162224411964417	0.8776041666666666	0.9482580917076161	0.8842105263157896	0.9148793992783762	0.8713981924508242	0.7039013480080348	0.2677	486.5306666666667	60.81633333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	transport	other	2	3e-05	28.333333333333332	4.666666666666667	11.0	84.0

2023-08-18 08:51:18,908 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:51:19,066 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:51:19,066 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:51:19,066 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:51:19,066 - INFO - ********************************************************************************************************************************************
2023-08-18 08:51:19,066 - INFO - TRAIN DOMAIN: electronics
2023-08-18 08:51:19,106 - INFO - Overall data count for train and dev: 290
2023-08-18 08:51:19,108 - INFO - **********************************************************************
2023-08-18 08:51:19,108 - INFO - Iteration number: 0 for TRAIN DOMAIN: electronics
2023-08-18 08:51:19,108 - INFO - Tokenizing the data...
2023-08-18 08:51:20,940 - INFO - TRAIN data count: 193 and DEV data count: 97
2023-08-18 08:51:20,941 - INFO - Finetune and perform evaluation...
2023-08-18 08:51:20,941 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:51:20,941 - INFO - Setting up training args and starting training...
2023-08-18 08:51:41,631 - INFO - Training complete...
2023-08-18 08:51:41,631 - INFO - TrainOutput(global_step=100, training_loss=0.43017589569091796, metrics={'train_runtime': 18.9868, 'train_samples_per_second': 40.66, 'train_steps_per_second': 5.267, 'total_flos': 19836106908000.0, 'train_loss': 0.43017589569091796, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:51:41,631 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:51:42,526 - INFO - Report evaluation results...
2023-08-18 08:51:42,527 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	electronics	na	0	3e-05	0.6115137338638306	0.6494845360824743	0.6373626373626373	0.9830508474576272	0.7733333333333333	0.5573148974130241	0.23228384047610093	0.1955	496.097	66.487	2.25e-05	1.0	25
vinai/bertweet-base	electronics	na	0	3e-05	0.4881887435913086	0.8041237113402062	0.8125	0.8813559322033898	0.8455284552845529	0.7827832292595897	0.5827127120894512	0.1954	496.331	66.519	1.5e-05	2.0	50
vinai/bertweet-base	electronics	na	0	3e-05	0.4173286557197571	0.8247422680412371	0.8387096774193549	0.8813559322033898	0.859504132231405	0.809099018733274	0.6283701688428064	0.1886	514.346	68.933	7.5e-06	3.0	75
vinai/bertweet-base	electronics	na	0	3e-05	0.4090418219566345	0.8350515463917526	0.8412698412698413	0.8983050847457628	0.8688524590163935	0.8175735950044605	0.6498041070083521	0.1902	509.869	68.333	0.0	4.0	100
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	electronics	na	0	3e-05	18.9868	40.66	5.267	19836106908000.0	0.43017589569091796	0.0	4.0	100

2023-08-18 08:51:42,527 - INFO - Loading the finetuned model
2023-08-18 08:51:44,172 - INFO - ***********************************
2023-08-18 08:51:44,172 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: food
2023-08-18 08:51:44,213 - INFO - TEST data count: 127
2023-08-18 08:51:45,422 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:45,959 - INFO - Metrics from the Predictions...
2023-08-18 08:51:45,959 - INFO - {'test_loss': 0.378474622964859, 'test_accuracy': 0.8661417322834646, 'test_precision': 0.9213483146067416, 'test_recall': 0.8913043478260869, 'test_f1': 0.9060773480662982, 'test_roc_auc': 0.8456521739130436, 'test_matthews_correlation': 0.6745442157142401, 'test_runtime': 0.2611, 'test_samples_per_second': 486.367, 'test_steps_per_second': 61.275}
2023-08-18 08:51:45,959 - INFO - {'confusion_matrix': array([[28,  7],
       [10, 82]])}
2023-08-18 08:51:45,959 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	food	0	3e-05	0.378474622964859	0.8661417322834646	0.9213483146067416	0.8913043478260869	0.9060773480662982	0.8456521739130436	0.6745442157142401	0.2611	486.367	61.275
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	food	0	3e-05	[[28  7]
 [10 82]]

2023-08-18 08:51:45,960 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: food iteration: 0
2023-08-18 08:51:45,960 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:45,960 - INFO - ***********************************
2023-08-18 08:51:45,960 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: apparel
2023-08-18 08:51:46,027 - INFO - TEST data count: 262
2023-08-18 08:51:47,183 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:47,814 - INFO - Metrics from the Predictions...
2023-08-18 08:51:47,814 - INFO - {'test_loss': 0.42205989360809326, 'test_accuracy': 0.8396946564885496, 'test_precision': 0.8705035971223022, 'test_recall': 0.8344827586206897, 'test_f1': 0.852112676056338, 'test_roc_auc': 0.840318302387268, 'test_matthews_correlation': 0.6780040342020929, 'test_runtime': 0.4593, 'test_samples_per_second': 570.429, 'test_steps_per_second': 71.848}
2023-08-18 08:51:47,814 - INFO - {'confusion_matrix': array([[ 99,  18],
       [ 24, 121]])}
2023-08-18 08:51:47,814 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	apparel	0	3e-05	0.42205989360809326	0.8396946564885496	0.8705035971223022	0.8344827586206897	0.852112676056338	0.840318302387268	0.6780040342020929	0.4593	570.429	71.848
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	apparel	0	3e-05	[[ 99  18]
 [ 24 121]]

2023-08-18 08:51:47,814 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:51:47,814 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:47,814 - INFO - ***********************************
2023-08-18 08:51:47,814 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: cars
2023-08-18 08:51:47,869 - INFO - TEST data count: 93
2023-08-18 08:51:49,038 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:49,378 - INFO - Metrics from the Predictions...
2023-08-18 08:51:49,378 - INFO - {'test_loss': 0.3798639476299286, 'test_accuracy': 0.8279569892473119, 'test_precision': 0.8714285714285714, 'test_recall': 0.8970588235294118, 'test_f1': 0.8840579710144928, 'test_roc_auc': 0.7685294117647059, 'test_matthews_correlation': 0.5518656701946132, 'test_runtime': 0.184, 'test_samples_per_second': 505.505, 'test_steps_per_second': 65.226}
2023-08-18 08:51:49,378 - INFO - {'confusion_matrix': array([[16,  9],
       [ 7, 61]])}
2023-08-18 08:51:49,378 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	cars	0	3e-05	0.3798639476299286	0.8279569892473119	0.8714285714285714	0.8970588235294118	0.8840579710144928	0.7685294117647059	0.5518656701946132	0.184	505.505	65.226
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	cars	0	3e-05	[[16  9]
 [ 7 61]]

2023-08-18 08:51:49,378 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: cars iteration: 0
2023-08-18 08:51:49,378 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:49,378 - INFO - ***********************************
2023-08-18 08:51:49,378 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: retail
2023-08-18 08:51:49,443 - INFO - TEST data count: 197
2023-08-18 08:51:50,578 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:51,089 - INFO - Metrics from the Predictions...
2023-08-18 08:51:51,089 - INFO - {'test_loss': 0.3945651650428772, 'test_accuracy': 0.817258883248731, 'test_precision': 0.8909090909090909, 'test_recall': 0.8032786885245902, 'test_f1': 0.8448275862068965, 'test_roc_auc': 0.8216393442622951, 'test_matthews_correlation': 0.6290044846078738, 'test_runtime': 0.3593, 'test_samples_per_second': 548.291, 'test_steps_per_second': 69.58}
2023-08-18 08:51:51,089 - INFO - {'confusion_matrix': array([[63, 12],
       [24, 98]])}
2023-08-18 08:51:51,089 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	retail	0	3e-05	0.3945651650428772	0.817258883248731	0.8909090909090909	0.8032786885245902	0.8448275862068965	0.8216393442622951	0.6290044846078738	0.3593	548.291	69.58
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	retail	0	3e-05	[[63 12]
 [24 98]]

2023-08-18 08:51:51,089 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: retail iteration: 0
2023-08-18 08:51:51,089 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:51,089 - INFO - ***********************************
2023-08-18 08:51:51,089 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: services
2023-08-18 08:51:51,128 - INFO - TEST data count: 335
2023-08-18 08:51:52,313 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:53,083 - INFO - Metrics from the Predictions...
2023-08-18 08:51:53,083 - INFO - {'test_loss': 0.4049109220504761, 'test_accuracy': 0.844776119402985, 'test_precision': 0.8333333333333334, 'test_recall': 0.9313725490196079, 'test_f1': 0.8796296296296297, 'test_roc_auc': 0.8206481065708726, 'test_matthews_correlation': 0.6711971358798263, 'test_runtime': 0.6079, 'test_samples_per_second': 551.091, 'test_steps_per_second': 69.092}
2023-08-18 08:51:53,083 - INFO - {'confusion_matrix': array([[ 93,  38],
       [ 14, 190]])}
2023-08-18 08:51:53,083 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	services	0	3e-05	0.4049109220504761	0.844776119402985	0.8333333333333334	0.9313725490196079	0.8796296296296297	0.8206481065708726	0.6711971358798263	0.6079	551.091	69.092
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	services	0	3e-05	[[ 93  38]
 [ 14 190]]

2023-08-18 08:51:53,083 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: services iteration: 0
2023-08-18 08:51:53,083 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:53,083 - INFO - ***********************************
2023-08-18 08:51:53,083 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: software
2023-08-18 08:51:53,122 - INFO - TEST data count: 295
2023-08-18 08:51:54,502 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:55,185 - INFO - Metrics from the Predictions...
2023-08-18 08:51:55,185 - INFO - {'test_loss': 0.3471091091632843, 'test_accuracy': 0.847457627118644, 'test_precision': 0.8769230769230769, 'test_recall': 0.890625, 'test_f1': 0.883720930232558, 'test_roc_auc': 0.8288076456310679, 'test_matthews_correlation': 0.6622528319910826, 'test_runtime': 0.5286, 'test_samples_per_second': 558.06, 'test_steps_per_second': 69.994}
2023-08-18 08:51:55,185 - INFO - {'confusion_matrix': array([[ 79,  24],
       [ 21, 171]])}
2023-08-18 08:51:55,186 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	software	0	3e-05	0.3471091091632843	0.847457627118644	0.8769230769230769	0.890625	0.883720930232558	0.8288076456310679	0.6622528319910826	0.5286	558.06	69.994
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	software	0	3e-05	[[ 79  24]
 [ 21 171]]

2023-08-18 08:51:55,186 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: software iteration: 0
2023-08-18 08:51:55,186 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:55,186 - INFO - ***********************************
2023-08-18 08:51:55,186 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: transport
2023-08-18 08:51:55,266 - INFO - TEST data count: 247
2023-08-18 08:51:56,486 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:57,075 - INFO - Metrics from the Predictions...
2023-08-18 08:51:57,075 - INFO - {'test_loss': 0.5065304040908813, 'test_accuracy': 0.7813765182186235, 'test_precision': 0.7692307692307693, 'test_recall': 0.8695652173913043, 'test_f1': 0.8163265306122449, 'test_roc_auc': 0.769644994016753, 'test_matthews_correlation': 0.5551267489931626, 'test_runtime': 0.4382, 'test_samples_per_second': 563.675, 'test_steps_per_second': 70.745}
2023-08-18 08:51:57,075 - INFO - {'confusion_matrix': array([[ 73,  36],
       [ 18, 120]])}
2023-08-18 08:51:57,076 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	transport	0	3e-05	0.5065304040908813	0.7813765182186235	0.7692307692307693	0.8695652173913043	0.8163265306122449	0.769644994016753	0.5551267489931626	0.4382	563.675	70.745
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	transport	0	3e-05	[[ 73  36]
 [ 18 120]]

2023-08-18 08:51:57,076 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: transport iteration: 0
2023-08-18 08:51:57,076 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:57,076 - INFO - ***********************************
2023-08-18 08:51:57,076 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: electronics
2023-08-18 08:51:57,076 - INFO - Train and test domains are the same: electronics, hence skipping
2023-08-18 08:51:57,076 - INFO - ***********************************
2023-08-18 08:51:57,076 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: other
2023-08-18 08:51:57,116 - INFO - TEST data count: 128
2023-08-18 08:51:58,214 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:51:58,722 - INFO - Metrics from the Predictions...
2023-08-18 08:51:58,722 - INFO - {'test_loss': 0.313718318939209, 'test_accuracy': 0.8828125, 'test_precision': 0.8921568627450981, 'test_recall': 0.9578947368421052, 'test_f1': 0.9238578680203046, 'test_roc_auc': 0.812280701754386, 'test_matthews_correlation': 0.6790584456256185, 'test_runtime': 0.3085, 'test_samples_per_second': 414.948, 'test_steps_per_second': 51.869}
2023-08-18 08:51:58,722 - INFO - {'confusion_matrix': array([[22, 11],
       [ 4, 91]])}
2023-08-18 08:51:58,722 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	other	0	3e-05	0.313718318939209	0.8828125	0.8921568627450981	0.9578947368421052	0.9238578680203046	0.812280701754386	0.6790584456256185	0.3085	414.948	51.869
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	other	0	3e-05	[[22 11]
 [ 4 91]]

2023-08-18 08:51:58,722 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: other iteration: 0
2023-08-18 08:51:58,722 - INFO - ----------------------------------------------------------------------
2023-08-18 08:51:58,722 - INFO - **********************************************************************
2023-08-18 08:51:58,722 - INFO - Iteration number: 1 for TRAIN DOMAIN: electronics
2023-08-18 08:51:58,722 - INFO - Tokenizing the data...
2023-08-18 08:52:00,630 - INFO - TRAIN data count: 193 and DEV data count: 97
2023-08-18 08:52:00,630 - INFO - Finetune and perform evaluation...
2023-08-18 08:52:00,630 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:52:00,631 - INFO - Setting up training args and starting training...
2023-08-18 08:52:20,539 - INFO - Training complete...
2023-08-18 08:52:20,539 - INFO - TrainOutput(global_step=100, training_loss=0.4253065490722656, metrics={'train_runtime': 18.6519, 'train_samples_per_second': 41.39, 'train_steps_per_second': 5.361, 'total_flos': 19836106908000.0, 'train_loss': 0.4253065490722656, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:52:20,539 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:52:21,399 - INFO - Report evaluation results...
2023-08-18 08:52:21,400 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	electronics	na	1	3e-05	0.6104822754859924	0.7628865979381443	0.8913043478260869	0.6949152542372882	0.780952380952381	0.7816681534344335	0.5507081992358728	0.1898	510.961	68.479	2.25e-05	1.0	25
vinai/bertweet-base	electronics	na	1	3e-05	0.46776053309440613	0.8144329896907216	0.7733333333333333	0.9830508474576272	0.8656716417910447	0.7678412132024978	0.6244292395617266	0.1903	509.595	68.296	1.5e-05	2.0	50
vinai/bertweet-base	electronics	na	1	3e-05	0.36569201946258545	0.8247422680412371	0.85	0.864406779661017	0.8571428571428572	0.8137823371989296	0.6306665631765437	0.1928	502.989	67.411	7.5e-06	3.0	75
vinai/bertweet-base	electronics	na	1	3e-05	0.38799360394477844	0.8556701030927835	0.835820895522388	0.9491525423728814	0.888888888888889	0.8298394290811776	0.6967104765756078	0.1913	507.146	67.968	0.0	4.0	100
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	electronics	na	1	3e-05	18.6519	41.39	5.361	19836106908000.0	0.4253065490722656	0.0	4.0	100

2023-08-18 08:52:21,400 - INFO - Loading the finetuned model
2023-08-18 08:52:22,937 - INFO - ***********************************
2023-08-18 08:52:22,938 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: food
2023-08-18 08:52:22,986 - INFO - TEST data count: 127
2023-08-18 08:52:24,322 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:24,809 - INFO - Metrics from the Predictions...
2023-08-18 08:52:24,810 - INFO - {'test_loss': 0.41672050952911377, 'test_accuracy': 0.7874015748031497, 'test_precision': 0.9452054794520548, 'test_recall': 0.75, 'test_f1': 0.8363636363636364, 'test_roc_auc': 0.8178571428571427, 'test_matthews_correlation': 0.5745549847106857, 'test_runtime': 0.2323, 'test_samples_per_second': 546.812, 'test_steps_per_second': 68.89}
2023-08-18 08:52:24,810 - INFO - {'confusion_matrix': array([[31,  4],
       [23, 69]])}
2023-08-18 08:52:24,810 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	food	1	3e-05	0.41672050952911377	0.7874015748031497	0.9452054794520548	0.75	0.8363636363636364	0.8178571428571427	0.5745549847106857	0.2323	546.812	68.89
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	food	1	3e-05	[[31  4]
 [23 69]]

2023-08-18 08:52:24,810 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: food iteration: 1
2023-08-18 08:52:24,810 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:24,810 - INFO - ***********************************
2023-08-18 08:52:24,810 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: apparel
2023-08-18 08:52:24,857 - INFO - TEST data count: 262
2023-08-18 08:52:26,014 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:26,664 - INFO - Metrics from the Predictions...
2023-08-18 08:52:26,664 - INFO - {'test_loss': 0.39127641916275024, 'test_accuracy': 0.8396946564885496, 'test_precision': 0.905511811023622, 'test_recall': 0.7931034482758621, 'test_f1': 0.8455882352941176, 'test_roc_auc': 0.8452696728558797, 'test_matthews_correlation': 0.6869049028668931, 'test_runtime': 0.4808, 'test_samples_per_second': 544.978, 'test_steps_per_second': 68.642}
2023-08-18 08:52:26,664 - INFO - {'confusion_matrix': array([[105,  12],
       [ 30, 115]])}
2023-08-18 08:52:26,665 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	apparel	1	3e-05	0.39127641916275024	0.8396946564885496	0.905511811023622	0.7931034482758621	0.8455882352941176	0.8452696728558797	0.6869049028668931	0.4808	544.978	68.642
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	apparel	1	3e-05	[[105  12]
 [ 30 115]]

2023-08-18 08:52:26,665 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:52:26,665 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:26,665 - INFO - ***********************************
2023-08-18 08:52:26,665 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: cars
2023-08-18 08:52:26,705 - INFO - TEST data count: 93
2023-08-18 08:52:27,973 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:28,315 - INFO - Metrics from the Predictions...
2023-08-18 08:52:28,315 - INFO - {'test_loss': 0.36651405692100525, 'test_accuracy': 0.8279569892473119, 'test_precision': 0.90625, 'test_recall': 0.8529411764705882, 'test_f1': 0.8787878787878787, 'test_roc_auc': 0.806470588235294, 'test_matthews_correlation': 0.586616497217136, 'test_runtime': 0.182, 'test_samples_per_second': 511.128, 'test_steps_per_second': 65.952}
2023-08-18 08:52:28,315 - INFO - {'confusion_matrix': array([[19,  6],
       [10, 58]])}
2023-08-18 08:52:28,316 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	cars	1	3e-05	0.36651405692100525	0.8279569892473119	0.90625	0.8529411764705882	0.8787878787878787	0.806470588235294	0.586616497217136	0.182	511.128	65.952
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	cars	1	3e-05	[[19  6]
 [10 58]]

2023-08-18 08:52:28,316 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: cars iteration: 1
2023-08-18 08:52:28,316 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:28,316 - INFO - ***********************************
2023-08-18 08:52:28,316 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: retail
2023-08-18 08:52:28,352 - INFO - TEST data count: 197
2023-08-18 08:52:29,523 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:30,037 - INFO - Metrics from the Predictions...
2023-08-18 08:52:30,037 - INFO - {'test_loss': 0.3815760612487793, 'test_accuracy': 0.8477157360406091, 'test_precision': 0.96, 'test_recall': 0.7868852459016393, 'test_f1': 0.8648648648648649, 'test_roc_auc': 0.866775956284153, 'test_matthews_correlation': 0.7124518748195298, 'test_runtime': 0.364, 'test_samples_per_second': 541.198, 'test_steps_per_second': 68.68}
2023-08-18 08:52:30,037 - INFO - {'confusion_matrix': array([[71,  4],
       [26, 96]])}
2023-08-18 08:52:30,037 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	retail	1	3e-05	0.3815760612487793	0.8477157360406091	0.96	0.7868852459016393	0.8648648648648649	0.866775956284153	0.7124518748195298	0.364	541.198	68.68
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	retail	1	3e-05	[[71  4]
 [26 96]]

2023-08-18 08:52:30,037 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: retail iteration: 1
2023-08-18 08:52:30,037 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:30,037 - INFO - ***********************************
2023-08-18 08:52:30,037 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: services
2023-08-18 08:52:30,074 - INFO - TEST data count: 335
2023-08-18 08:52:31,202 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:31,948 - INFO - Metrics from the Predictions...
2023-08-18 08:52:31,948 - INFO - {'test_loss': 0.3788623511791229, 'test_accuracy': 0.8537313432835821, 'test_precision': 0.863849765258216, 'test_recall': 0.9019607843137255, 'test_f1': 0.8824940047961631, 'test_roc_auc': 0.8402933692560993, 'test_matthews_correlation': 0.6901833798522014, 'test_runtime': 0.5917, 'test_samples_per_second': 566.203, 'test_steps_per_second': 70.987}
2023-08-18 08:52:31,948 - INFO - {'confusion_matrix': array([[102,  29],
       [ 20, 184]])}
2023-08-18 08:52:31,948 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	services	1	3e-05	0.3788623511791229	0.8537313432835821	0.863849765258216	0.9019607843137255	0.8824940047961631	0.8402933692560993	0.6901833798522014	0.5917	566.203	70.987
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	services	1	3e-05	[[102  29]
 [ 20 184]]

2023-08-18 08:52:31,948 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: services iteration: 1
2023-08-18 08:52:31,948 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:31,948 - INFO - ***********************************
2023-08-18 08:52:31,948 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: software
2023-08-18 08:52:32,006 - INFO - TEST data count: 295
2023-08-18 08:52:33,151 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:33,825 - INFO - Metrics from the Predictions...
2023-08-18 08:52:33,825 - INFO - {'test_loss': 0.3509913384914398, 'test_accuracy': 0.864406779661017, 'test_precision': 0.9086021505376344, 'test_recall': 0.8802083333333334, 'test_f1': 0.8941798941798942, 'test_roc_auc': 0.8575798948220065, 'test_matthews_correlation': 0.7063217723776595, 'test_runtime': 0.5119, 'test_samples_per_second': 576.257, 'test_steps_per_second': 72.276}
2023-08-18 08:52:33,825 - INFO - {'confusion_matrix': array([[ 86,  17],
       [ 23, 169]])}
2023-08-18 08:52:33,825 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	software	1	3e-05	0.3509913384914398	0.864406779661017	0.9086021505376344	0.8802083333333334	0.8941798941798942	0.8575798948220065	0.7063217723776595	0.5119	576.257	72.276
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	software	1	3e-05	[[ 86  17]
 [ 23 169]]

2023-08-18 08:52:33,825 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: software iteration: 1
2023-08-18 08:52:33,825 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:33,825 - INFO - ***********************************
2023-08-18 08:52:33,825 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: transport
2023-08-18 08:52:33,862 - INFO - TEST data count: 247
2023-08-18 08:52:34,992 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:35,585 - INFO - Metrics from the Predictions...
2023-08-18 08:52:35,585 - INFO - {'test_loss': 0.4461083710193634, 'test_accuracy': 0.8097165991902834, 'test_precision': 0.8421052631578947, 'test_recall': 0.8115942028985508, 'test_f1': 0.8265682656826568, 'test_roc_auc': 0.8094668262199176, 'test_matthews_correlation': 0.6164795045809064, 'test_runtime': 0.442, 'test_samples_per_second': 558.838, 'test_steps_per_second': 70.138}
2023-08-18 08:52:35,585 - INFO - {'confusion_matrix': array([[ 88,  21],
       [ 26, 112]])}
2023-08-18 08:52:35,585 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	transport	1	3e-05	0.4461083710193634	0.8097165991902834	0.8421052631578947	0.8115942028985508	0.8265682656826568	0.8094668262199176	0.6164795045809064	0.442	558.838	70.138
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	transport	1	3e-05	[[ 88  21]
 [ 26 112]]

2023-08-18 08:52:35,585 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: transport iteration: 1
2023-08-18 08:52:35,585 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:35,585 - INFO - ***********************************
2023-08-18 08:52:35,585 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: electronics
2023-08-18 08:52:35,585 - INFO - Train and test domains are the same: electronics, hence skipping
2023-08-18 08:52:35,585 - INFO - ***********************************
2023-08-18 08:52:35,585 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: other
2023-08-18 08:52:35,621 - INFO - TEST data count: 128
2023-08-18 08:52:36,758 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:52:37,180 - INFO - Metrics from the Predictions...
2023-08-18 08:52:37,180 - INFO - {'test_loss': 0.28370746970176697, 'test_accuracy': 0.890625, 'test_precision': 0.9354838709677419, 'test_recall': 0.9157894736842105, 'test_f1': 0.925531914893617, 'test_roc_auc': 0.8669856459330143, 'test_matthews_correlation': 0.7203148190769032, 'test_runtime': 0.2609, 'test_samples_per_second': 490.611, 'test_steps_per_second': 61.326}
2023-08-18 08:52:37,180 - INFO - {'confusion_matrix': array([[27,  6],
       [ 8, 87]])}
2023-08-18 08:52:37,180 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	other	1	3e-05	0.28370746970176697	0.890625	0.9354838709677419	0.9157894736842105	0.925531914893617	0.8669856459330143	0.7203148190769032	0.2609	490.611	61.326
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	other	1	3e-05	[[27  6]
 [ 8 87]]

2023-08-18 08:52:37,180 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: other iteration: 1
2023-08-18 08:52:37,180 - INFO - ----------------------------------------------------------------------
2023-08-18 08:52:37,180 - INFO - **********************************************************************
2023-08-18 08:52:37,180 - INFO - Iteration number: 2 for TRAIN DOMAIN: electronics
2023-08-18 08:52:37,180 - INFO - Tokenizing the data...
2023-08-18 08:52:39,057 - INFO - TRAIN data count: 194 and DEV data count: 96
2023-08-18 08:52:39,057 - INFO - Finetune and perform evaluation...
2023-08-18 08:52:39,057 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:52:39,057 - INFO - Setting up training args and starting training...
2023-08-18 08:52:59,412 - INFO - Training complete...
2023-08-18 08:52:59,412 - INFO - TrainOutput(global_step=100, training_loss=0.4421629333496094, metrics={'train_runtime': 18.651, 'train_samples_per_second': 41.606, 'train_steps_per_second': 5.362, 'total_flos': 19938884664000.0, 'train_loss': 0.4421629333496094, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:52:59,412 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:53:00,370 - INFO - Report evaluation results...
2023-08-18 08:53:00,371 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	electronics	na	2	3e-05	0.6311141848564148	0.6354166666666666	0.6263736263736264	0.9827586206896551	0.7651006711409395	0.544010889292196	0.19372703718088405	0.1817	528.438	66.055	2.25e-05	1.0	25
vinai/bertweet-base	electronics	na	2	3e-05	0.5261613726615906	0.71875	0.691358024691358	0.9655172413793104	0.8057553956834532	0.6538112522686026	0.4143198681564238	0.1866	514.358	64.295	1.5e-05	2.0	50
vinai/bertweet-base	electronics	na	2	3e-05	0.4920056164264679	0.8020833333333334	0.782608695652174	0.9310344827586207	0.8503937007874016	0.7681488203266786	0.5833178333584929	0.1858	516.549	64.569	7.5e-06	3.0	75
vinai/bertweet-base	electronics	na	2	3e-05	0.44615134596824646	0.8229166666666666	0.8360655737704918	0.8793103448275862	0.8571428571428572	0.8080762250453721	0.6260298408998275	0.1858	516.758	64.595	0.0	4.0	100
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	electronics	na	2	3e-05	18.651	41.606	5.362	19938884664000.0	0.4421629333496094	0.0	4.0	100

2023-08-18 08:53:00,371 - INFO - Loading the finetuned model
2023-08-18 08:53:01,429 - INFO - ***********************************
2023-08-18 08:53:01,429 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: food
2023-08-18 08:53:01,477 - INFO - TEST data count: 127
2023-08-18 08:53:02,609 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:03,074 - INFO - Metrics from the Predictions...
2023-08-18 08:53:03,074 - INFO - {'test_loss': 0.5378623604774475, 'test_accuracy': 0.7401574803149606, 'test_precision': 0.9836065573770492, 'test_recall': 0.6521739130434783, 'test_f1': 0.7843137254901961, 'test_roc_auc': 0.8118012422360248, 'test_matthews_correlation': 0.5576977435666236, 'test_runtime': 0.2344, 'test_samples_per_second': 541.711, 'test_steps_per_second': 68.247}
2023-08-18 08:53:03,074 - INFO - {'confusion_matrix': array([[34,  1],
       [32, 60]])}
2023-08-18 08:53:03,074 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	food	2	3e-05	0.5378623604774475	0.7401574803149606	0.9836065573770492	0.6521739130434783	0.7843137254901961	0.8118012422360248	0.5576977435666236	0.2344	541.711	68.247
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	food	2	3e-05	[[34  1]
 [32 60]]

2023-08-18 08:53:03,074 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: food iteration: 2
2023-08-18 08:53:03,074 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:03,074 - INFO - ***********************************
2023-08-18 08:53:03,074 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: apparel
2023-08-18 08:53:03,114 - INFO - TEST data count: 262
2023-08-18 08:53:04,244 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:04,912 - INFO - Metrics from the Predictions...
2023-08-18 08:53:04,912 - INFO - {'test_loss': 0.43611517548561096, 'test_accuracy': 0.8129770992366412, 'test_precision': 0.875, 'test_recall': 0.7724137931034483, 'test_f1': 0.8205128205128206, 'test_roc_auc': 0.8178308281756558, 'test_matthews_correlation': 0.632187003244789, 'test_runtime': 0.5096, 'test_samples_per_second': 514.128, 'test_steps_per_second': 64.757}
2023-08-18 08:53:04,912 - INFO - {'confusion_matrix': array([[101,  16],
       [ 33, 112]])}
2023-08-18 08:53:04,913 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	apparel	2	3e-05	0.43611517548561096	0.8129770992366412	0.875	0.7724137931034483	0.8205128205128206	0.8178308281756558	0.632187003244789	0.5096	514.128	64.757
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	apparel	2	3e-05	[[101  16]
 [ 33 112]]

2023-08-18 08:53:04,913 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:53:04,913 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:04,913 - INFO - ***********************************
2023-08-18 08:53:04,913 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: cars
2023-08-18 08:53:04,954 - INFO - TEST data count: 93
2023-08-18 08:53:07,081 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:07,420 - INFO - Metrics from the Predictions...
2023-08-18 08:53:07,420 - INFO - {'test_loss': 0.3428172469139099, 'test_accuracy': 0.8924731182795699, 'test_precision': 0.9264705882352942, 'test_recall': 0.9264705882352942, 'test_f1': 0.9264705882352942, 'test_roc_auc': 0.8632352941176471, 'test_matthews_correlation': 0.7264705882352941, 'test_runtime': 0.1938, 'test_samples_per_second': 480.0, 'test_steps_per_second': 61.935}
2023-08-18 08:53:07,420 - INFO - {'confusion_matrix': array([[20,  5],
       [ 5, 63]])}
2023-08-18 08:53:07,420 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	cars	2	3e-05	0.3428172469139099	0.8924731182795699	0.9264705882352942	0.9264705882352942	0.9264705882352942	0.8632352941176471	0.7264705882352941	0.1938	480.0	61.935
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	cars	2	3e-05	[[20  5]
 [ 5 63]]

2023-08-18 08:53:07,420 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: cars iteration: 2
2023-08-18 08:53:07,420 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:07,420 - INFO - ***********************************
2023-08-18 08:53:07,420 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: retail
2023-08-18 08:53:07,460 - INFO - TEST data count: 197
2023-08-18 08:53:08,806 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:09,324 - INFO - Metrics from the Predictions...
2023-08-18 08:53:09,324 - INFO - {'test_loss': 0.3863673806190491, 'test_accuracy': 0.8375634517766497, 'test_precision': 0.9411764705882353, 'test_recall': 0.7868852459016393, 'test_f1': 0.8571428571428571, 'test_roc_auc': 0.8534426229508197, 'test_matthews_correlation': 0.6869064204033261, 'test_runtime': 0.3704, 'test_samples_per_second': 531.905, 'test_steps_per_second': 67.501}
2023-08-18 08:53:09,324 - INFO - {'confusion_matrix': array([[69,  6],
       [26, 96]])}
2023-08-18 08:53:09,324 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	retail	2	3e-05	0.3863673806190491	0.8375634517766497	0.9411764705882353	0.7868852459016393	0.8571428571428571	0.8534426229508197	0.6869064204033261	0.3704	531.905	67.501
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	retail	2	3e-05	[[69  6]
 [26 96]]

2023-08-18 08:53:09,324 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: retail iteration: 2
2023-08-18 08:53:09,324 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:09,324 - INFO - ***********************************
2023-08-18 08:53:09,324 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: services
2023-08-18 08:53:09,592 - INFO - TEST data count: 335
2023-08-18 08:53:10,737 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:11,487 - INFO - Metrics from the Predictions...
2023-08-18 08:53:11,488 - INFO - {'test_loss': 0.4198687672615051, 'test_accuracy': 0.8328358208955224, 'test_precision': 0.8394495412844036, 'test_recall': 0.8970588235294118, 'test_f1': 0.8672985781990522, 'test_roc_auc': 0.8149416255051639, 'test_matthews_correlation': 0.644747421858583, 'test_runtime': 0.5851, 'test_samples_per_second': 572.51, 'test_steps_per_second': 71.777}
2023-08-18 08:53:11,488 - INFO - {'confusion_matrix': array([[ 96,  35],
       [ 21, 183]])}
2023-08-18 08:53:11,488 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	services	2	3e-05	0.4198687672615051	0.8328358208955224	0.8394495412844036	0.8970588235294118	0.8672985781990522	0.8149416255051639	0.644747421858583	0.5851	572.51	71.777
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	services	2	3e-05	[[ 96  35]
 [ 21 183]]

2023-08-18 08:53:11,488 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: services iteration: 2
2023-08-18 08:53:11,488 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:11,488 - INFO - ***********************************
2023-08-18 08:53:11,488 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: software
2023-08-18 08:53:11,559 - INFO - TEST data count: 295
2023-08-18 08:53:12,719 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:13,426 - INFO - Metrics from the Predictions...
2023-08-18 08:53:13,426 - INFO - {'test_loss': 0.3300258219242096, 'test_accuracy': 0.8677966101694915, 'test_precision': 0.9322033898305084, 'test_recall': 0.859375, 'test_f1': 0.8943089430894309, 'test_roc_auc': 0.871435072815534, 'test_matthews_correlation': 0.7228605023275533, 'test_runtime': 0.5319, 'test_samples_per_second': 554.657, 'test_steps_per_second': 69.567}
2023-08-18 08:53:13,426 - INFO - {'confusion_matrix': array([[ 91,  12],
       [ 27, 165]])}
2023-08-18 08:53:13,426 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	software	2	3e-05	0.3300258219242096	0.8677966101694915	0.9322033898305084	0.859375	0.8943089430894309	0.871435072815534	0.7228605023275533	0.5319	554.657	69.567
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	software	2	3e-05	[[ 91  12]
 [ 27 165]]

2023-08-18 08:53:13,426 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: software iteration: 2
2023-08-18 08:53:13,426 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:13,426 - INFO - ***********************************
2023-08-18 08:53:13,426 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: transport
2023-08-18 08:53:13,494 - INFO - TEST data count: 247
2023-08-18 08:53:14,616 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:15,242 - INFO - Metrics from the Predictions...
2023-08-18 08:53:15,242 - INFO - {'test_loss': 0.5145126581192017, 'test_accuracy': 0.7854251012145749, 'test_precision': 0.8571428571428571, 'test_recall': 0.7391304347826086, 'test_f1': 0.7937743190661479, 'test_roc_auc': 0.7915835660151576, 'test_matthews_correlation': 0.5795185811143108, 'test_runtime': 0.4442, 'test_samples_per_second': 556.074, 'test_steps_per_second': 69.791}
2023-08-18 08:53:15,242 - INFO - {'confusion_matrix': array([[ 92,  17],
       [ 36, 102]])}
2023-08-18 08:53:15,242 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	transport	2	3e-05	0.5145126581192017	0.7854251012145749	0.8571428571428571	0.7391304347826086	0.7937743190661479	0.7915835660151576	0.5795185811143108	0.4442	556.074	69.791
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	transport	2	3e-05	[[ 92  17]
 [ 36 102]]

2023-08-18 08:53:15,243 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: transport iteration: 2
2023-08-18 08:53:15,243 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:15,243 - INFO - ***********************************
2023-08-18 08:53:15,243 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: electronics
2023-08-18 08:53:15,243 - INFO - Train and test domains are the same: electronics, hence skipping
2023-08-18 08:53:15,243 - INFO - ***********************************
2023-08-18 08:53:15,243 - INFO - For TRAIN domain: electronics now testing with TEST DOMAIN: other
2023-08-18 08:53:15,286 - INFO - TEST data count: 128
2023-08-18 08:53:21,439 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:21,832 - INFO - Metrics from the Predictions...
2023-08-18 08:53:21,832 - INFO - {'test_loss': 0.30063197016716003, 'test_accuracy': 0.8671875, 'test_precision': 0.9333333333333333, 'test_recall': 0.8842105263157894, 'test_f1': 0.9081081081081082, 'test_roc_auc': 0.8511961722488038, 'test_matthews_correlation': 0.672489470902538, 'test_runtime': 0.2332, 'test_samples_per_second': 548.779, 'test_steps_per_second': 68.597}
2023-08-18 08:53:21,832 - INFO - {'confusion_matrix': array([[27,  6],
       [11, 84]])}
2023-08-18 08:53:21,832 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	electronics	other	2	3e-05	0.30063197016716003	0.8671875	0.9333333333333333	0.8842105263157894	0.9081081081081082	0.8511961722488038	0.672489470902538	0.2332	548.779	68.597
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	electronics	other	2	3e-05	[[27  6]
 [11 84]]

2023-08-18 08:53:21,832 - INFO - Finished testing for TRAIN DOMAIN: electronics and TEST DOMAIN: other iteration: 2
2023-08-18 08:53:21,832 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:21,833 - INFO - Finished all iterations and all testing for TRAIN domain: electronics
2023-08-18 08:53:21,833 - INFO - Calculating mean of test metrics for TRAIN domain: electronics
2023-08-18 08:53:21,833 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	food	2	3e-05	0.4443524976571401	0.7979002624671917	0.9500534504786152	0.7644927536231885	0.8422515699733769	0.8251035196687372	0.6022656479971831	0.2426	524.9633333333334	66.13733333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	food	2	3e-05	31.0	4.0	21.666666666666668	70.33333333333333

2023-08-18 08:53:21,833 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	apparel	2	3e-05	0.4164838294188182	0.8307888040712467	0.8836718027153081	0.8000000000000002	0.8394045772877589	0.8344729344729345	0.6656986467712583	0.48323333333333335	543.1783333333333	68.41566666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	apparel	2	3e-05	101.66666666666667	15.333333333333334	29.0	116.0

2023-08-18 08:53:21,834 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	cars	2	3e-05	0.36306508382161456	0.8494623655913979	0.9013830532212884	0.8921568627450981	0.8964388126792219	0.8127450980392158	0.6216509185490144	0.1866	498.8776666666667	64.371
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	cars	2	3e-05	18.333333333333332	6.666666666666667	7.333333333333333	60.666666666666664

2023-08-18 08:53:21,834 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	retail	2	3e-05	0.38750286897023517	0.8341793570219966	0.9306951871657754	0.7923497267759562	0.8556117694048728	0.8472859744990893	0.6761209266102433	0.3645666666666667	540.4646666666666	68.587
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	retail	2	3e-05	67.66666666666667	7.333333333333333	25.333333333333332	96.66666666666667

2023-08-18 08:53:21,834 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	services	2	3e-05	0.4012140134970347	0.8437810945273632	0.8455442132919844	0.9101307189542484	0.8764740708749482	0.8252943671107119	0.6687093125302036	0.5949	563.2679999999999	70.61866666666667
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	services	2	3e-05	97.0	34.0	18.333333333333332	185.66666666666666

2023-08-18 08:53:21,834 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	software	2	3e-05	0.3427087565263112	0.8598870056497175	0.9059095390970734	0.8767361111111112	0.8907365891672944	0.8526075377562027	0.6971450355654318	0.5241333333333333	562.9913333333334	70.61233333333332
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	software	2	3e-05	85.33333333333333	17.666666666666668	23.666666666666668	168.33333333333334

2023-08-18 08:53:21,835 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	transport	2	3e-05	0.4890504777431488	0.7921727395411606	0.822826296510507	0.8067632850241546	0.8122230384536833	0.7902317954172761	0.5837082782294599	0.4414666666666667	559.529	70.22466666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	transport	2	3e-05	84.33333333333333	24.666666666666668	26.666666666666668	111.33333333333333

2023-08-18 08:53:21,835 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	electronics	other	2	3e-05	0.29935258626937866	0.8802083333333334	0.920324689015391	0.9192982456140352	0.9191659636740099	0.8434875066454014	0.6906209118683533	0.26753333333333335	484.77933333333334	60.597333333333324
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	electronics	other	2	3e-05	25.333333333333332	7.666666666666667	7.666666666666667	87.33333333333333

2023-08-18 08:53:21,835 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:53:22,126 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:53:22,126 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:53:22,126 - INFO - The path /notebooks/test_trainer does not exist.
2023-08-18 08:53:22,126 - INFO - ********************************************************************************************************************************************
2023-08-18 08:53:22,126 - INFO - TRAIN DOMAIN: other
2023-08-18 08:53:22,167 - INFO - Overall data count for train and dev: 128
2023-08-18 08:53:22,168 - INFO - **********************************************************************
2023-08-18 08:53:22,168 - INFO - Iteration number: 0 for TRAIN DOMAIN: other
2023-08-18 08:53:22,168 - INFO - Tokenizing the data...
2023-08-18 08:53:29,301 - INFO - TRAIN data count: 85 and DEV data count: 43
2023-08-18 08:53:29,301 - INFO - Finetune and perform evaluation...
2023-08-18 08:53:29,302 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:53:29,302 - INFO - Setting up training args and starting training...
2023-08-18 08:53:53,795 - INFO - Training complete...
2023-08-18 08:53:53,795 - INFO - TrainOutput(global_step=44, training_loss=0.5514303987676447, metrics={'train_runtime': 13.4239, 'train_samples_per_second': 25.328, 'train_steps_per_second': 3.278, 'total_flos': 8736109260000.0, 'train_loss': 0.5514303987676447, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:53:53,795 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:53:54,688 - INFO - Report evaluation results...
2023-08-18 08:53:54,689 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	other	na	0	3e-05	0.5650038719177246	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0951	452.297	63.111	2.25e-05	1.0	11
vinai/bertweet-base	other	na	0	3e-05	0.5604553818702698	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0987	435.467	60.763	1.5e-05	2.0	22
vinai/bertweet-base	other	na	0	3e-05	0.5445395112037659	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0977	440.262	61.432	7.5e-06	3.0	33
vinai/bertweet-base	other	na	0	3e-05	0.5366790294647217	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0968	444.082	61.965	0.0	4.0	44
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	other	na	0	3e-05	13.4239	25.328	3.278	8736109260000.0	0.5514303987676447	0.0	4.0	44

2023-08-18 08:53:54,689 - INFO - Loading the finetuned model
2023-08-18 08:53:56,185 - INFO - ***********************************
2023-08-18 08:53:56,186 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: food
2023-08-18 08:53:56,239 - INFO - TEST data count: 127
2023-08-18 08:53:57,419 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:53:57,895 - INFO - Metrics from the Predictions...
2023-08-18 08:53:57,895 - INFO - {'test_loss': 0.5473405122756958, 'test_accuracy': 0.7244094488188977, 'test_precision': 0.7244094488188977, 'test_recall': 1.0, 'test_f1': 0.8401826484018265, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.24, 'test_samples_per_second': 529.07, 'test_steps_per_second': 66.654}
2023-08-18 08:53:57,895 - INFO - {'confusion_matrix': array([[ 0, 35],
       [ 0, 92]])}
2023-08-18 08:53:57,895 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	food	0	3e-05	0.5473405122756958	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.24	529.07	66.654
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	food	0	3e-05	[[ 0 35]
 [ 0 92]]

2023-08-18 08:53:57,895 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: food iteration: 0
2023-08-18 08:53:57,895 - INFO - ----------------------------------------------------------------------
2023-08-18 08:53:57,895 - INFO - ***********************************
2023-08-18 08:53:57,895 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: apparel
2023-08-18 08:53:57,934 - INFO - TEST data count: 262
2023-08-18 08:54:01,218 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:01,867 - INFO - Metrics from the Predictions...
2023-08-18 08:54:01,867 - INFO - {'test_loss': 0.7307736873626709, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.476, 'test_samples_per_second': 550.42, 'test_steps_per_second': 69.328}
2023-08-18 08:54:01,867 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:54:01,867 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	apparel	0	3e-05	0.7307736873626709	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.476	550.42	69.328
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	apparel	0	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:54:01,867 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: apparel iteration: 0
2023-08-18 08:54:01,868 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:01,868 - INFO - ***********************************
2023-08-18 08:54:01,868 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: cars
2023-08-18 08:54:01,905 - INFO - TEST data count: 93
2023-08-18 08:54:03,133 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:03,497 - INFO - Metrics from the Predictions...
2023-08-18 08:54:03,497 - INFO - {'test_loss': 0.5455568432807922, 'test_accuracy': 0.7311827956989247, 'test_precision': 0.7311827956989247, 'test_recall': 1.0, 'test_f1': 0.84472049689441, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.1889, 'test_samples_per_second': 492.412, 'test_steps_per_second': 63.537}
2023-08-18 08:54:03,497 - INFO - {'confusion_matrix': array([[ 0, 25],
       [ 0, 68]])}
2023-08-18 08:54:03,498 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	cars	0	3e-05	0.5455568432807922	0.7311827956989247	0.7311827956989247	1.0	0.84472049689441	0.5	0.0	0.1889	492.412	63.537
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	cars	0	3e-05	[[ 0 25]
 [ 0 68]]

2023-08-18 08:54:03,498 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: cars iteration: 0
2023-08-18 08:54:03,498 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:03,498 - INFO - ***********************************
2023-08-18 08:54:03,498 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: retail
2023-08-18 08:54:03,541 - INFO - TEST data count: 197
2023-08-18 08:54:04,648 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:05,181 - INFO - Metrics from the Predictions...
2023-08-18 08:54:05,181 - INFO - {'test_loss': 0.6617592573165894, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.3531, 'test_samples_per_second': 557.966, 'test_steps_per_second': 70.808}
2023-08-18 08:54:05,181 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:54:05,181 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	retail	0	3e-05	0.6617592573165894	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3531	557.966	70.808
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	retail	0	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:54:05,181 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: retail iteration: 0
2023-08-18 08:54:05,181 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:05,181 - INFO - ***********************************
2023-08-18 08:54:05,181 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: services
2023-08-18 08:54:05,227 - INFO - TEST data count: 335
2023-08-18 08:54:06,525 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:07,268 - INFO - Metrics from the Predictions...
2023-08-18 08:54:07,268 - INFO - {'test_loss': 0.6760042309761047, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.595, 'test_samples_per_second': 563.001, 'test_steps_per_second': 70.585}
2023-08-18 08:54:07,268 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:54:07,268 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	services	0	3e-05	0.6760042309761047	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.595	563.001	70.585
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	services	0	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:54:07,268 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: services iteration: 0
2023-08-18 08:54:07,268 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:07,268 - INFO - ***********************************
2023-08-18 08:54:07,268 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: software
2023-08-18 08:54:07,305 - INFO - TEST data count: 295
2023-08-18 08:54:13,470 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:14,178 - INFO - Metrics from the Predictions...
2023-08-18 08:54:14,178 - INFO - {'test_loss': 0.6208682060241699, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5352, 'test_samples_per_second': 551.213, 'test_steps_per_second': 69.135}
2023-08-18 08:54:14,178 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:54:14,179 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	software	0	3e-05	0.6208682060241699	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5352	551.213	69.135
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	software	0	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:54:14,179 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: software iteration: 0
2023-08-18 08:54:14,179 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:14,179 - INFO - ***********************************
2023-08-18 08:54:14,179 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: transport
2023-08-18 08:54:14,218 - INFO - TEST data count: 247
2023-08-18 08:54:20,355 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:20,959 - INFO - Metrics from the Predictions...
2023-08-18 08:54:20,960 - INFO - {'test_loss': 0.7360354065895081, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4352, 'test_samples_per_second': 567.598, 'test_steps_per_second': 71.237}
2023-08-18 08:54:20,960 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:54:20,960 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	transport	0	3e-05	0.7360354065895081	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4352	567.598	71.237
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	transport	0	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:54:20,960 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: transport iteration: 0
2023-08-18 08:54:20,960 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:20,960 - INFO - ***********************************
2023-08-18 08:54:20,960 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: electronics
2023-08-18 08:54:20,997 - INFO - TEST data count: 290
2023-08-18 08:54:22,149 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:22,859 - INFO - Metrics from the Predictions...
2023-08-18 08:54:22,859 - INFO - {'test_loss': 0.6745797991752625, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5206, 'test_samples_per_second': 557.056, 'test_steps_per_second': 71.073}
2023-08-18 08:54:22,860 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:54:22,860 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	electronics	0	3e-05	0.6745797991752625	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5206	557.056	71.073
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	electronics	0	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:54:22,860 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: electronics iteration: 0
2023-08-18 08:54:22,860 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:22,860 - INFO - ***********************************
2023-08-18 08:54:22,860 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: other
2023-08-18 08:54:22,860 - INFO - Train and test domains are the same: other, hence skipping
2023-08-18 08:54:22,860 - INFO - **********************************************************************
2023-08-18 08:54:22,860 - INFO - Iteration number: 1 for TRAIN DOMAIN: other
2023-08-18 08:54:22,860 - INFO - Tokenizing the data...
2023-08-18 08:54:25,014 - INFO - TRAIN data count: 85 and DEV data count: 43
2023-08-18 08:54:25,014 - INFO - Finetune and perform evaluation...
2023-08-18 08:54:25,014 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:54:25,014 - INFO - Setting up training args and starting training...
2023-08-18 08:54:41,428 - INFO - Training complete...
2023-08-18 08:54:41,428 - INFO - TrainOutput(global_step=44, training_loss=0.5486981218511408, metrics={'train_runtime': 15.0404, 'train_samples_per_second': 22.606, 'train_steps_per_second': 2.925, 'total_flos': 8736109260000.0, 'train_loss': 0.5486981218511408, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:54:41,428 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:54:42,296 - INFO - Report evaluation results...
2023-08-18 08:54:42,297 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	other	na	1	3e-05	0.5625117421150208	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.1006	427.436	59.642	2.25e-05	1.0	11
vinai/bertweet-base	other	na	1	3e-05	0.5508435964584351	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0943	455.928	63.618	1.5e-05	2.0	22
vinai/bertweet-base	other	na	1	3e-05	0.5397911071777344	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0964	445.841	62.21	7.5e-06	3.0	33
vinai/bertweet-base	other	na	1	3e-05	0.5327293276786804	0.7441860465116279	0.7441860465116279	1.0	0.8533333333333333	0.5	0.0	0.0985	436.769	60.945	0.0	4.0	44
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	other	na	1	3e-05	15.0404	22.606	2.925	8736109260000.0	0.5486981218511408	0.0	4.0	44

2023-08-18 08:54:42,297 - INFO - Loading the finetuned model
2023-08-18 08:54:43,719 - INFO - ***********************************
2023-08-18 08:54:43,719 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: food
2023-08-18 08:54:43,794 - INFO - TEST data count: 127
2023-08-18 08:54:45,010 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:45,476 - INFO - Metrics from the Predictions...
2023-08-18 08:54:45,476 - INFO - {'test_loss': 0.5292456150054932, 'test_accuracy': 0.7244094488188977, 'test_precision': 0.7244094488188977, 'test_recall': 1.0, 'test_f1': 0.8401826484018265, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.2386, 'test_samples_per_second': 532.164, 'test_steps_per_second': 67.044}
2023-08-18 08:54:45,476 - INFO - {'confusion_matrix': array([[ 0, 35],
       [ 0, 92]])}
2023-08-18 08:54:45,476 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	food	1	3e-05	0.5292456150054932	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.2386	532.164	67.044
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	food	1	3e-05	[[ 0 35]
 [ 0 92]]

2023-08-18 08:54:45,476 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: food iteration: 1
2023-08-18 08:54:45,476 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:45,476 - INFO - ***********************************
2023-08-18 08:54:45,476 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: apparel
2023-08-18 08:54:45,520 - INFO - TEST data count: 262
2023-08-18 08:54:51,723 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:54:52,335 - INFO - Metrics from the Predictions...
2023-08-18 08:54:52,335 - INFO - {'test_loss': 0.7013944983482361, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4578, 'test_samples_per_second': 572.364, 'test_steps_per_second': 72.092}
2023-08-18 08:54:52,335 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:54:52,335 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	apparel	1	3e-05	0.7013944983482361	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.4578	572.364	72.092
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	apparel	1	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:54:52,335 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: apparel iteration: 1
2023-08-18 08:54:52,335 - INFO - ----------------------------------------------------------------------
2023-08-18 08:54:52,335 - INFO - ***********************************
2023-08-18 08:54:52,335 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: cars
2023-08-18 08:54:52,392 - INFO - TEST data count: 93
2023-08-18 08:55:03,717 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:04,051 - INFO - Metrics from the Predictions...
2023-08-18 08:55:04,051 - INFO - {'test_loss': 0.5410393476486206, 'test_accuracy': 0.7311827956989247, 'test_precision': 0.7311827956989247, 'test_recall': 1.0, 'test_f1': 0.84472049689441, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.1829, 'test_samples_per_second': 508.487, 'test_steps_per_second': 65.611}
2023-08-18 08:55:04,051 - INFO - {'confusion_matrix': array([[ 0, 25],
       [ 0, 68]])}
2023-08-18 08:55:04,051 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	cars	1	3e-05	0.5410393476486206	0.7311827956989247	0.7311827956989247	1.0	0.84472049689441	0.5	0.0	0.1829	508.487	65.611
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	cars	1	3e-05	[[ 0 25]
 [ 0 68]]

2023-08-18 08:55:04,051 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: cars iteration: 1
2023-08-18 08:55:04,051 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:04,051 - INFO - ***********************************
2023-08-18 08:55:04,051 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: retail
2023-08-18 08:55:04,099 - INFO - TEST data count: 197
2023-08-18 08:55:05,277 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:05,797 - INFO - Metrics from the Predictions...
2023-08-18 08:55:05,797 - INFO - {'test_loss': 0.6345341205596924, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.3505, 'test_samples_per_second': 562.011, 'test_steps_per_second': 71.321}
2023-08-18 08:55:05,797 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:55:05,797 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	retail	1	3e-05	0.6345341205596924	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3505	562.011	71.321
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	retail	1	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:55:05,798 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: retail iteration: 1
2023-08-18 08:55:05,798 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:05,798 - INFO - ***********************************
2023-08-18 08:55:05,798 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: services
2023-08-18 08:55:05,952 - INFO - TEST data count: 335
2023-08-18 08:55:13,220 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:13,981 - INFO - Metrics from the Predictions...
2023-08-18 08:55:13,981 - INFO - {'test_loss': 0.6516099572181702, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5841, 'test_samples_per_second': 573.571, 'test_steps_per_second': 71.91}
2023-08-18 08:55:13,982 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:55:13,982 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	services	1	3e-05	0.6516099572181702	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5841	573.571	71.91
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	services	1	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:55:13,982 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: services iteration: 1
2023-08-18 08:55:13,982 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:13,982 - INFO - ***********************************
2023-08-18 08:55:13,982 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: software
2023-08-18 08:55:14,032 - INFO - TEST data count: 295
2023-08-18 08:55:15,200 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:15,911 - INFO - Metrics from the Predictions...
2023-08-18 08:55:15,911 - INFO - {'test_loss': 0.6032397150993347, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5286, 'test_samples_per_second': 558.113, 'test_steps_per_second': 70.001}
2023-08-18 08:55:15,911 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:55:15,912 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	software	1	3e-05	0.6032397150993347	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5286	558.113	70.001
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	software	1	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:55:15,912 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: software iteration: 1
2023-08-18 08:55:15,912 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:15,912 - INFO - ***********************************
2023-08-18 08:55:15,912 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: transport
2023-08-18 08:55:15,975 - INFO - TEST data count: 247
2023-08-18 08:55:17,180 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:17,771 - INFO - Metrics from the Predictions...
2023-08-18 08:55:17,771 - INFO - {'test_loss': 0.7090110778808594, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4385, 'test_samples_per_second': 563.264, 'test_steps_per_second': 70.693}
2023-08-18 08:55:17,771 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:55:17,771 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	transport	1	3e-05	0.7090110778808594	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4385	563.264	70.693
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	transport	1	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:55:17,771 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: transport iteration: 1
2023-08-18 08:55:17,771 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:17,771 - INFO - ***********************************
2023-08-18 08:55:17,771 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: electronics
2023-08-18 08:55:17,811 - INFO - TEST data count: 290
2023-08-18 08:55:18,966 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:19,632 - INFO - Metrics from the Predictions...
2023-08-18 08:55:19,633 - INFO - {'test_loss': 0.6500105261802673, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5152, 'test_samples_per_second': 562.902, 'test_steps_per_second': 71.819}
2023-08-18 08:55:19,633 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:55:19,633 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	electronics	1	3e-05	0.6500105261802673	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5152	562.902	71.819
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	electronics	1	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:55:19,633 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: electronics iteration: 1
2023-08-18 08:55:19,633 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:19,633 - INFO - ***********************************
2023-08-18 08:55:19,633 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: other
2023-08-18 08:55:19,633 - INFO - Train and test domains are the same: other, hence skipping
2023-08-18 08:55:19,633 - INFO - **********************************************************************
2023-08-18 08:55:19,633 - INFO - Iteration number: 2 for TRAIN DOMAIN: other
2023-08-18 08:55:19,633 - INFO - Tokenizing the data...
2023-08-18 08:55:21,495 - INFO - TRAIN data count: 86 and DEV data count: 42
2023-08-18 08:55:21,495 - INFO - Finetune and perform evaluation...
2023-08-18 08:55:21,495 - INFO - Function finetune_and_evaluate() received model: vinai/bertweet-base, lr: 3e-05
2023-08-18 08:55:21,495 - INFO - Setting up training args and starting training...
2023-08-18 08:55:38,228 - INFO - Training complete...
2023-08-18 08:55:38,229 - INFO - TrainOutput(global_step=44, training_loss=0.5389513969421387, metrics={'train_runtime': 14.8644, 'train_samples_per_second': 23.143, 'train_steps_per_second': 2.96, 'total_flos': 8838887016000.0, 'train_loss': 0.5389513969421387, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-18 08:55:38,229 - INFO - Saving model at /notebooks/complaints/outputs/ft_vinai-bertweet-base
2023-08-18 08:55:39,250 - INFO - Report evaluation results...
2023-08-18 08:55:39,251 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Eval metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
vinai/bertweet-base	other	na	2	3e-05	0.5663743615150452	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0965	435.168	62.167	2.25e-05	1.0	11
vinai/bertweet-base	other	na	2	3e-05	0.5642899870872498	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.1008	416.579	59.511	1.5e-05	2.0	22
vinai/bertweet-base	other	na	2	3e-05	0.5353870987892151	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0996	421.577	60.225	7.5e-06	3.0	33
vinai/bertweet-base	other	na	2	3e-05	0.5283743739128113	0.7380952380952381	0.7380952380952381	1.0	0.8493150684931507	0.5	0.0	0.0925	453.873	64.839	0.0	4.0	44
--*--*--
***** Train metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	train_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
vinai/bertweet-base	other	na	2	3e-05	14.8644	23.143	2.96	8838887016000.0	0.5389513969421387	0.0	4.0	44

2023-08-18 08:55:39,251 - INFO - Loading the finetuned model
2023-08-18 08:55:40,229 - INFO - ***********************************
2023-08-18 08:55:40,229 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: food
2023-08-18 08:55:40,268 - INFO - TEST data count: 127
2023-08-18 08:55:41,519 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:43,994 - INFO - Metrics from the Predictions...
2023-08-18 08:55:43,994 - INFO - {'test_loss': 0.5307886004447937, 'test_accuracy': 0.7244094488188977, 'test_precision': 0.7244094488188977, 'test_recall': 1.0, 'test_f1': 0.8401826484018265, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.25, 'test_samples_per_second': 507.947, 'test_steps_per_second': 63.993}
2023-08-18 08:55:43,994 - INFO - {'confusion_matrix': array([[ 0, 35],
       [ 0, 92]])}
2023-08-18 08:55:43,994 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	food	2	3e-05	0.5307886004447937	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.25	507.947	63.993
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	food	2	3e-05	[[ 0 35]
 [ 0 92]]

2023-08-18 08:55:43,994 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: food iteration: 2
2023-08-18 08:55:43,994 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:43,994 - INFO - ***********************************
2023-08-18 08:55:43,994 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: apparel
2023-08-18 08:55:44,062 - INFO - TEST data count: 262
2023-08-18 08:55:45,363 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:46,014 - INFO - Metrics from the Predictions...
2023-08-18 08:55:46,015 - INFO - {'test_loss': 0.7314713597297668, 'test_accuracy': 0.5534351145038168, 'test_precision': 0.5534351145038168, 'test_recall': 1.0, 'test_f1': 0.7125307125307125, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4672, 'test_samples_per_second': 560.763, 'test_steps_per_second': 70.63}
2023-08-18 08:55:46,015 - INFO - {'confusion_matrix': array([[  0, 117],
       [  0, 145]])}
2023-08-18 08:55:46,015 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	apparel	2	3e-05	0.7314713597297668	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307125	0.5	0.0	0.4672	560.763	70.63
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	apparel	2	3e-05	[[  0 117]
 [  0 145]]

2023-08-18 08:55:46,015 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: apparel iteration: 2
2023-08-18 08:55:46,015 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:46,015 - INFO - ***********************************
2023-08-18 08:55:46,015 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: cars
2023-08-18 08:55:46,054 - INFO - TEST data count: 93
2023-08-18 08:55:47,203 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:47,553 - INFO - Metrics from the Predictions...
2023-08-18 08:55:47,553 - INFO - {'test_loss': 0.5393764972686768, 'test_accuracy': 0.7311827956989247, 'test_precision': 0.7311827956989247, 'test_recall': 1.0, 'test_f1': 0.84472049689441, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.1837, 'test_samples_per_second': 506.163, 'test_steps_per_second': 65.311}
2023-08-18 08:55:47,554 - INFO - {'confusion_matrix': array([[ 0, 25],
       [ 0, 68]])}
2023-08-18 08:55:47,554 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	cars	2	3e-05	0.5393764972686768	0.7311827956989247	0.7311827956989247	1.0	0.84472049689441	0.5	0.0	0.1837	506.163	65.311
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	cars	2	3e-05	[[ 0 25]
 [ 0 68]]

2023-08-18 08:55:47,554 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: cars iteration: 2
2023-08-18 08:55:47,554 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:47,554 - INFO - ***********************************
2023-08-18 08:55:47,554 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: retail
2023-08-18 08:55:47,601 - INFO - TEST data count: 197
2023-08-18 08:55:48,755 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:49,278 - INFO - Metrics from the Predictions...
2023-08-18 08:55:49,279 - INFO - {'test_loss': 0.6543325781822205, 'test_accuracy': 0.6192893401015228, 'test_precision': 0.6192893401015228, 'test_recall': 1.0, 'test_f1': 0.7648902821316614, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.3596, 'test_samples_per_second': 547.856, 'test_steps_per_second': 69.525}
2023-08-18 08:55:49,279 - INFO - {'confusion_matrix': array([[  0,  75],
       [  0, 122]])}
2023-08-18 08:55:49,279 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	retail	2	3e-05	0.6543325781822205	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3596	547.856	69.525
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	retail	2	3e-05	[[  0  75]
 [  0 122]]

2023-08-18 08:55:49,279 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: retail iteration: 2
2023-08-18 08:55:49,279 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:49,279 - INFO - ***********************************
2023-08-18 08:55:49,279 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: services
2023-08-18 08:55:49,354 - INFO - TEST data count: 335
2023-08-18 08:55:51,568 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:52,291 - INFO - Metrics from the Predictions...
2023-08-18 08:55:52,291 - INFO - {'test_loss': 0.6713659167289734, 'test_accuracy': 0.608955223880597, 'test_precision': 0.608955223880597, 'test_recall': 1.0, 'test_f1': 0.7569573283858997, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5746, 'test_samples_per_second': 583.038, 'test_steps_per_second': 73.097}
2023-08-18 08:55:52,291 - INFO - {'confusion_matrix': array([[  0, 131],
       [  0, 204]])}
2023-08-18 08:55:52,291 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	services	2	3e-05	0.6713659167289734	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5746	583.038	73.097
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	services	2	3e-05	[[  0 131]
 [  0 204]]

2023-08-18 08:55:52,291 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: services iteration: 2
2023-08-18 08:55:52,291 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:52,291 - INFO - ***********************************
2023-08-18 08:55:52,291 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: software
2023-08-18 08:55:52,333 - INFO - TEST data count: 295
2023-08-18 08:55:54,496 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:55,175 - INFO - Metrics from the Predictions...
2023-08-18 08:55:55,175 - INFO - {'test_loss': 0.6135371327400208, 'test_accuracy': 0.6508474576271186, 'test_precision': 0.6508474576271186, 'test_recall': 1.0, 'test_f1': 0.7885010266940451, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5184, 'test_samples_per_second': 569.015, 'test_steps_per_second': 71.368}
2023-08-18 08:55:55,175 - INFO - {'confusion_matrix': array([[  0, 103],
       [  0, 192]])}
2023-08-18 08:55:55,175 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	software	2	3e-05	0.6135371327400208	0.6508474576271186	0.6508474576271186	1.0	0.7885010266940451	0.5	0.0	0.5184	569.015	71.368
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	software	2	3e-05	[[  0 103]
 [  0 192]]

2023-08-18 08:55:55,176 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: software iteration: 2
2023-08-18 08:55:55,176 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:55,176 - INFO - ***********************************
2023-08-18 08:55:55,176 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: transport
2023-08-18 08:55:55,220 - INFO - TEST data count: 247
2023-08-18 08:55:56,398 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:56,999 - INFO - Metrics from the Predictions...
2023-08-18 08:55:57,000 - INFO - {'test_loss': 0.7329767346382141, 'test_accuracy': 0.5587044534412956, 'test_precision': 0.5587044534412956, 'test_recall': 1.0, 'test_f1': 0.7168831168831169, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.4434, 'test_samples_per_second': 557.026, 'test_steps_per_second': 69.91}
2023-08-18 08:55:57,000 - INFO - {'confusion_matrix': array([[  0, 109],
       [  0, 138]])}
2023-08-18 08:55:57,000 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	transport	2	3e-05	0.7329767346382141	0.5587044534412956	0.5587044534412956	1.0	0.7168831168831169	0.5	0.0	0.4434	557.026	69.91
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	transport	2	3e-05	[[  0 109]
 [  0 138]]

2023-08-18 08:55:57,000 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: transport iteration: 2
2023-08-18 08:55:57,000 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:57,000 - INFO - ***********************************
2023-08-18 08:55:57,000 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: electronics
2023-08-18 08:55:57,067 - INFO - TEST data count: 290
2023-08-18 08:55:58,263 - INFO - **TRACE** Running predictions with test data
2023-08-18 08:55:58,930 - INFO - Metrics from the Predictions...
2023-08-18 08:55:58,930 - INFO - {'test_loss': 0.6682696342468262, 'test_accuracy': 0.6068965517241379, 'test_precision': 0.6068965517241379, 'test_recall': 1.0, 'test_f1': 0.7553648068669528, 'test_roc_auc': 0.5, 'test_matthews_correlation': 0.0, 'test_runtime': 0.5124, 'test_samples_per_second': 566.003, 'test_steps_per_second': 72.214}
2023-08-18 08:55:58,930 - INFO - {'confusion_matrix': array([[  0, 114],
       [  0, 176]])}
2023-08-18 08:55:58,930 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
vinai/bertweet-base	other	electronics	2	3e-05	0.6682696342468262	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5124	566.003	72.214
***** Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	confusion_matrix
vinai/bertweet-base	other	electronics	2	3e-05	[[  0 114]
 [  0 176]]

2023-08-18 08:55:58,930 - INFO - Finished testing for TRAIN DOMAIN: other and TEST DOMAIN: electronics iteration: 2
2023-08-18 08:55:58,930 - INFO - ----------------------------------------------------------------------
2023-08-18 08:55:58,930 - INFO - ***********************************
2023-08-18 08:55:58,930 - INFO - For TRAIN domain: other now testing with TEST DOMAIN: other
2023-08-18 08:55:58,930 - INFO - Train and test domains are the same: other, hence skipping
2023-08-18 08:55:58,930 - INFO - Finished all iterations and all testing for TRAIN domain: other
2023-08-18 08:55:58,930 - INFO - Calculating mean of test metrics for TRAIN domain: other
2023-08-18 08:55:58,931 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	food	2	3e-05	0.5357915759086609	0.7244094488188977	0.7244094488188977	1.0	0.8401826484018265	0.5	0.0	0.24286666666666668	523.0603333333333	65.89699999999999
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	food	2	3e-05	0.0	35.0	0.0	92.0

2023-08-18 08:55:58,931 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	apparel	2	3e-05	0.721213181813558	0.5534351145038168	0.5534351145038168	1.0	0.7125307125307124	0.5	0.0	0.467	561.1823333333333	70.68333333333334
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	apparel	2	3e-05	0.0	117.0	0.0	145.0

2023-08-18 08:55:58,932 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	cars	2	3e-05	0.5419908960660299	0.7311827956989246	0.7311827956989246	1.0	0.8447204968944101	0.5	0.0	0.18516666666666667	502.354	64.81966666666666
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	cars	2	3e-05	0.0	25.0	0.0	68.0

2023-08-18 08:55:58,932 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	retail	2	3e-05	0.6502086520195007	0.6192893401015228	0.6192893401015228	1.0	0.7648902821316614	0.5	0.0	0.3544	555.9443333333332	70.55133333333335
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	retail	2	3e-05	0.0	75.0	0.0	122.0

2023-08-18 08:55:58,932 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	services	2	3e-05	0.6663267016410828	0.608955223880597	0.608955223880597	1.0	0.7569573283858997	0.5	0.0	0.5845666666666667	573.2033333333334	71.86399999999999
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	services	2	3e-05	0.0	131.0	0.0	204.0

2023-08-18 08:55:58,932 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	software	2	3e-05	0.6125483512878418	0.6508474576271186	0.6508474576271186	1.0	0.788501026694045	0.5	0.0	0.5274	559.447	70.168
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	software	2	3e-05	0.0	103.0	0.0	192.0

2023-08-18 08:55:58,933 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	transport	2	3e-05	0.7260077397028605	0.5587044534412956	0.5587044534412956	1.0	0.716883116883117	0.5	0.0	0.43903333333333333	562.6293333333333	70.61333333333333
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	transport	2	3e-05	0.0	109.0	0.0	138.0

2023-08-18 08:55:58,933 - INFO - 

Results as of 202308-18_08-3449 for vinai/bertweet-base
***** Mean Test(predict) metrics *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
vinai/bertweet-base	other	electronics	2	3e-05	0.6642866532007853	0.6068965517241379	0.6068965517241379	1.0	0.7553648068669528	0.5	0.0	0.5160666666666667	561.9870000000001	71.702
***** Mean Confusion Matrix(predict) *****
model	train_domain	test_domain	iter.	hp_set_lr	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
vinai/bertweet-base	other	electronics	2	3e-05	0.0	114.0	0.0	176.0

2023-08-18 08:55:58,933 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-18 08:55:59,124 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-18 08:55:59,125 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-18 08:55:59,125 - INFO - The path /notebooks/test_trainer does not exist.
