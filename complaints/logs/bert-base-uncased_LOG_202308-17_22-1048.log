2023-08-17 22:10:48,666 - INFO - Training Params - NO_OF_EPOCHS: 4 OUTER_CV_NO: 6 INNER_CV_NO: 4 MAX_LENGTH: 50 LR_SPACE: [1e-05, 5e-06, 5e-05, 3e-05] SEED: 2023

2023-08-17 22:10:48,666 - INFO - Total no. of tweets: 3449
2023-08-17 22:10:48,667 - INFO - ----------------------------------------------------------------------
2023-08-17 22:10:48,667 - INFO - ----------------------------------------------------------------------
2023-08-17 22:10:48,667 - INFO - **TRACE** Outer Fold:0
2023-08-17 22:10:48,667 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-17 22:10:49,319 - INFO - -----------------------------------
2023-08-17 22:10:49,319 - INFO - -----------------------------------
2023-08-17 22:10:49,319 - INFO - **TRACE** Inner Fold: 0 for outer fold: 0
2023-08-17 22:10:49,319 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-17 22:10:49,319 - INFO - **TRACE** Create dataset...
2023-08-17 22:10:49,320 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:10:49,323 - INFO - **TRACE** Tokenise data...
2023-08-17 22:10:49,863 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:10:49,863 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 1e-05
2023-08-17 22:10:49,863 - INFO - Setting up training args and starting training...
2023-08-17 22:12:14,976 - INFO - Training complete...
2023-08-17 22:12:14,976 - INFO - TrainOutput(global_step=1080, training_loss=0.2918239611166495, metrics={'train_runtime': 83.9276, 'train_samples_per_second': 102.708, 'train_steps_per_second': 12.868, 'total_flos': 221486064180000.0, 'train_loss': 0.2918239611166495, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:12:14,976 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:12:15,642 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:12:15,643 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	0	0	1e-05	0.4061053991317749	0.8344923504867872	0.8571428571428571	0.6971830985915493	0.7689320388349514	0.810660514813016	0.6504350721273591	1.2089	594.75	74.447	7.500000000000001e-06	1.0	270
bert-base-uncased	0	0	1e-05	0.34000781178474426	0.885952712100139	0.8506944444444444	0.8626760563380281	0.8566433566433566	0.8819127408126922	0.7620141959633301	1.2166	590.997	73.977	5e-06	2.0	540
bert-base-uncased	0	0	1e-05	0.39247074723243713	0.885952712100139	0.8796992481203008	0.823943661971831	0.850909090909091	0.8751902217905132	0.7597931715299432	1.2048	596.791	74.703	2.5e-06	3.0	810
bert-base-uncased	0	0	1e-05	0.4318726658821106	0.8831710709318498	0.8448275862068966	0.8626760563380281	0.8536585365853658	0.8796138902379795	0.7565684806048477	1.2167	590.941	73.97	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	0	0	1e-05	83.9276	102.708	12.868	221486064180000.0	0.2918239611166495	0.0	4.0	1080

2023-08-17 22:12:15,643 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:12:15,643 - INFO - **TRACE** Appending...0.4061053991317749
2023-08-17 22:12:15,643 - INFO - **TRACE** Appending...0.34000781178474426
2023-08-17 22:12:15,643 - INFO - **TRACE** Appending...0.39247074723243713
2023-08-17 22:12:15,643 - INFO - **TRACE** Appending...0.4318726658821106
2023-08-17 22:12:15,643 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.34000781178474426 < 1000 LR: 1e-05
2023-08-17 22:12:16,304 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-17 22:12:16,304 - INFO - -----------------------------------
2023-08-17 22:12:16,304 - INFO - -----------------------------------
2023-08-17 22:12:16,304 - INFO - **TRACE** Inner Fold: 1 for outer fold: 0
2023-08-17 22:12:16,304 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-17 22:12:16,304 - INFO - **TRACE** Create dataset...
2023-08-17 22:12:16,305 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:12:16,309 - INFO - **TRACE** Tokenise data...
2023-08-17 22:12:16,907 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:12:16,907 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-06
2023-08-17 22:12:16,907 - INFO - Setting up training args and starting training...
2023-08-17 22:13:43,855 - INFO - Training complete...
2023-08-17 22:13:43,855 - INFO - TrainOutput(global_step=1080, training_loss=0.3558005898087113, metrics={'train_runtime': 85.8995, 'train_samples_per_second': 100.35, 'train_steps_per_second': 12.573, 'total_flos': 221486064180000.0, 'train_loss': 0.3558005898087113, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:13:43,855 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:13:44,537 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:13:44,537 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	0	1	5e-06	0.43340152502059937	0.8331015299026425	0.8215962441314554	0.6809338521400778	0.7446808510638299	0.7993413849444978	0.6283755069655197	1.2356	581.885	72.837	3.7500000000000005e-06	1.0	270
bert-base-uncased	0	1	5e-06	0.3803347051143646	0.8567454798331016	0.826271186440678	0.7587548638132295	0.7910750507099392	0.8350051375343204	0.6838162948985282	1.2239	587.472	73.536	2.5e-06	2.0	540
bert-base-uncased	0	1	5e-06	0.43030446767807007	0.8539638386648123	0.8140495867768595	0.7665369649805448	0.7895791583166333	0.8345671837889738	0.6786314982718273	1.2245	587.172	73.499	1.25e-06	3.0	810
bert-base-uncased	0	1	5e-06	0.45006000995635986	0.8567454798331016	0.8130081300813008	0.7782101167315175	0.7952286282306164	0.839321508582209	0.6855368590658629	1.2475	576.343	72.143	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	0	1	5e-06	85.8995	100.35	12.573	221486064180000.0	0.3558005898087113	0.0	4.0	1080

2023-08-17 22:13:44,537 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:13:44,537 - INFO - **TRACE** Appending...0.43340152502059937
2023-08-17 22:13:44,537 - INFO - **TRACE** Appending...0.3803347051143646
2023-08-17 22:13:44,537 - INFO - **TRACE** Appending...0.43030446767807007
2023-08-17 22:13:44,537 - INFO - **TRACE** Appending...0.45006000995635986
2023-08-17 22:13:44,537 - INFO - **TRACE** Model not saved since current innr cross fold(1) has higher loss...0.3803347051143646 >= 0.34000781178474426 LR: 5e-06
2023-08-17 22:13:44,537 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-17 22:13:44,537 - INFO - -----------------------------------
2023-08-17 22:13:44,537 - INFO - -----------------------------------
2023-08-17 22:13:44,538 - INFO - **TRACE** Inner Fold: 2 for outer fold: 0
2023-08-17 22:13:44,538 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-17 22:13:44,538 - INFO - **TRACE** Create dataset...
2023-08-17 22:13:44,538 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:13:44,542 - INFO - **TRACE** Tokenise data...
2023-08-17 22:13:45,464 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:13:45,464 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-05
2023-08-17 22:13:45,464 - INFO - Setting up training args and starting training...
2023-08-17 22:15:13,803 - INFO - Training complete...
2023-08-17 22:15:13,803 - INFO - TrainOutput(global_step=1080, training_loss=0.26013367065676934, metrics={'train_runtime': 87.2876, 'train_samples_per_second': 98.8, 'train_steps_per_second': 12.373, 'total_flos': 221588841936000.0, 'train_loss': 0.26013367065676934, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:15:13,803 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:15:14,445 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:15:14,445 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	0	2	5e-05	0.5606489181518555	0.7841225626740947	0.6493150684931507	0.8977272727272727	0.7535771065182831	0.8078944733680417	0.5939200600271826	1.1983	599.17	75.105	3.7500000000000003e-05	1.0	270
bert-base-uncased	0	2	5e-05	0.5424731373786926	0.8565459610027855	0.8709677419354839	0.7159090909090909	0.7858627858627858	0.827117541049259	0.6869339623301791	1.2217	587.698	73.667	2.5e-05	2.0	540
bert-base-uncased	0	2	5e-05	0.5911913514137268	0.8635097493036211	0.7985611510791367	0.8409090909090909	0.8191881918819188	0.8587805366439728	0.7102970720535359	1.2442	577.064	72.334	1.25e-05	3.0	810
bert-base-uncased	0	2	5e-05	0.780800998210907	0.8551532033426184	0.8053435114503816	0.7992424242424242	0.8022813688212928	0.843453811240155	0.6880106462698384	1.201	597.842	74.938	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	0	2	5e-05	87.2876	98.8	12.373	221588841936000.0	0.26013367065676934	0.0	4.0	1080

2023-08-17 22:15:14,445 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:15:14,445 - INFO - **TRACE** Appending...0.5606489181518555
2023-08-17 22:15:14,445 - INFO - **TRACE** Appending...0.5424731373786926
2023-08-17 22:15:14,445 - INFO - **TRACE** Appending...0.5911913514137268
2023-08-17 22:15:14,445 - INFO - **TRACE** Appending...0.780800998210907
2023-08-17 22:15:14,445 - INFO - **TRACE** Model not saved since current innr cross fold(2) has higher loss...0.5424731373786926 >= 0.3803347051143646 LR: 5e-05
2023-08-17 22:15:14,445 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-17 22:15:14,445 - INFO - -----------------------------------
2023-08-17 22:15:14,445 - INFO - -----------------------------------
2023-08-17 22:15:14,445 - INFO - **TRACE** Inner Fold: 3 for outer fold: 0
2023-08-17 22:15:14,445 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-17 22:15:14,445 - INFO - **TRACE** Create dataset...
2023-08-17 22:15:14,446 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:15:14,450 - INFO - **TRACE** Tokenise data...
2023-08-17 22:15:20,105 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:15:20,106 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 3e-05
2023-08-17 22:15:20,106 - INFO - Setting up training args and starting training...
2023-08-17 22:16:50,855 - INFO - Training complete...
2023-08-17 22:16:50,858 - INFO - TrainOutput(global_step=1080, training_loss=0.2063912084809056, metrics={'train_runtime': 87.6973, 'train_samples_per_second': 98.338, 'train_steps_per_second': 12.315, 'total_flos': 221588841936000.0, 'train_loss': 0.2063912084809056, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:16:50,858 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:16:51,451 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:16:51,452 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	0	3	3e-05	0.34220606088638306	0.8565459610027855	0.85	0.7959866220735786	0.8221070811744386	0.8478739792945459	0.70319937401074	1.2031	596.777	74.805	2.25e-05	1.0	270
bert-base-uncased	0	3	3e-05	0.5788847804069519	0.841225626740947	0.7520435967302452	0.9230769230769231	0.8288288288288288	0.8529465760969341	0.6961374276995976	1.189	603.867	75.694	1.5e-05	2.0	540
bert-base-uncased	0	3	3e-05	0.7058472037315369	0.8607242339832869	0.819935691318328	0.8528428093645485	0.8360655737704918	0.8595956290259497	0.7154999476484964	1.2236	586.777	73.551	7.5e-06	3.0	810
bert-base-uncased	0	3	3e-05	0.7552337050437927	0.8565459610027855	0.8266666666666667	0.8294314381270903	0.8280467445742905	0.852663213096958	0.7049916823075295	1.2154	590.751	74.05	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	0	3	3e-05	87.6973	98.338	12.315	221588841936000.0	0.2063912084809056	0.0	4.0	1080

2023-08-17 22:16:51,452 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:16:51,452 - INFO - **TRACE** Appending...0.34220606088638306
2023-08-17 22:16:51,452 - INFO - **TRACE** Appending...0.5788847804069519
2023-08-17 22:16:51,452 - INFO - **TRACE** Appending...0.7058472037315369
2023-08-17 22:16:51,452 - INFO - **TRACE** Appending...0.7552337050437927
2023-08-17 22:16:51,452 - INFO - **TRACE** Current innr cross fold(3) has lower loss, saving model...0.34220606088638306 < 0.5424731373786926 LR: 3e-05
2023-08-17 22:16:52,121 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-17 22:16:52,122 - INFO - -----------------------------------
2023-08-17 22:16:52,122 - INFO - -----------------------------------
2023-08-17 22:16:52,122 - INFO - **TRACE** All inner CVs complete for outer CV 0
2023-08-17 22:16:52,122 - INFO - **TRACE** Best model selected from inner cv: 3 with loss: 0.34220606088638306 with learning rate: 3e-05
2023-08-17 22:16:52,122 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-17 22:16:52,122 - INFO - **TRACE** Loading the best model from inner CV
2023-08-17 22:16:53,118 - INFO - **TRACE** Running predictions with test data
2023-08-17 22:16:54,441 - INFO - Metrics from the Predictions...
2023-08-17 22:16:54,441 - INFO - {'test_loss': 0.2271357774734497, 'test_accuracy': 0.9165217391304348, 'test_precision': 0.8866995073891626, 'test_recall': 0.8780487804878049, 'test_f1': 0.8823529411764706, 'test_roc_auc': 0.9079433091628213, 'test_matthews_correlation': 0.8176889216649066, 'test_runtime': 0.9791, 'test_samples_per_second': 587.255, 'test_steps_per_second': 73.535}
2023-08-17 22:16:54,441 - INFO - {'confusion_matrix': array([[347,  23],
       [ 25, 180]])}
2023-08-17 22:16:54,441 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
bert-base-uncased	0	0.2271357774734497	0.9165217391304348	0.8866995073891626	0.8780487804878049	0.8823529411764706	0.9079433091628213	0.8176889216649066	0.9791	587.255	73.535
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
bert-base-uncased	0	[[347  23]
 [ 25 180]]

2023-08-17 22:16:54,442 - INFO - ----------------------------------------------------------------------
2023-08-17 22:16:54,442 - INFO - ----------------------------------------------------------------------
2023-08-17 22:16:54,442 - INFO - **TRACE** Outer Fold:1
2023-08-17 22:16:54,442 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-17 22:16:55,076 - INFO - -----------------------------------
2023-08-17 22:16:55,076 - INFO - -----------------------------------
2023-08-17 22:16:55,076 - INFO - **TRACE** Inner Fold: 0 for outer fold: 1
2023-08-17 22:16:55,076 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-17 22:16:55,076 - INFO - **TRACE** Create dataset...
2023-08-17 22:16:55,076 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:16:55,080 - INFO - **TRACE** Tokenise data...
2023-08-17 22:16:55,685 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:16:55,685 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 1e-05
2023-08-17 22:16:55,686 - INFO - Setting up training args and starting training...
2023-08-17 22:18:28,460 - INFO - Training complete...
2023-08-17 22:18:28,460 - INFO - TrainOutput(global_step=1080, training_loss=0.2831517563925849, metrics={'train_runtime': 86.6889, 'train_samples_per_second': 99.436, 'train_steps_per_second': 12.458, 'total_flos': 221486064180000.0, 'train_loss': 0.2831517563925849, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:18:28,460 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:18:29,050 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:18:29,051 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	1	0	1e-05	0.419645220041275	0.847009735744089	0.84	0.75	0.7924528301886793	0.8294419134396355	0.6746269672160419	1.1874	605.527	75.796	7.500000000000001e-06	1.0	270
bert-base-uncased	1	0	1e-05	0.4812326729297638	0.8456189151599444	0.7903780068728522	0.8214285714285714	0.8056042031523641	0.8412382037097299	0.6780013203271132	1.2177	590.443	73.908	5e-06	2.0	540
bert-base-uncased	1	0	1e-05	0.5594823360443115	0.8553546592489569	0.84375	0.7714285714285715	0.8059701492537314	0.8401561991539213	0.6928020808565695	1.2054	596.48	74.664	2.5e-06	3.0	810
bert-base-uncased	1	0	1e-05	0.5935098528862	0.8484005563282336	0.8086642599277978	0.8	0.8043087971274686	0.8396355353075171	0.6806179137369751	1.2158	591.36	74.023	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	1	0	1e-05	86.6889	99.436	12.458	221486064180000.0	0.2831517563925849	0.0	4.0	1080

2023-08-17 22:18:29,051 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:18:29,051 - INFO - **TRACE** Appending...0.419645220041275
2023-08-17 22:18:29,051 - INFO - **TRACE** Appending...0.4812326729297638
2023-08-17 22:18:29,051 - INFO - **TRACE** Appending...0.5594823360443115
2023-08-17 22:18:29,051 - INFO - **TRACE** Appending...0.5935098528862
2023-08-17 22:18:29,051 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.419645220041275 < 1000 LR: 1e-05
2023-08-17 22:18:29,649 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-17 22:18:29,650 - INFO - -----------------------------------
2023-08-17 22:18:29,650 - INFO - -----------------------------------
2023-08-17 22:18:29,650 - INFO - **TRACE** Inner Fold: 1 for outer fold: 1
2023-08-17 22:18:29,650 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-17 22:18:29,650 - INFO - **TRACE** Create dataset...
2023-08-17 22:18:29,651 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:18:29,656 - INFO - **TRACE** Tokenise data...
2023-08-17 22:18:30,305 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:18:30,305 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-06
2023-08-17 22:18:30,305 - INFO - Setting up training args and starting training...
2023-08-17 22:19:59,072 - INFO - Training complete...
2023-08-17 22:19:59,072 - INFO - TrainOutput(global_step=1080, training_loss=0.35870048028451423, metrics={'train_runtime': 87.7345, 'train_samples_per_second': 98.251, 'train_steps_per_second': 12.31, 'total_flos': 221486064180000.0, 'train_loss': 0.35870048028451423, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:19:59,073 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:19:59,818 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:19:59,819 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	1	1	5e-06	0.4295399487018585	0.8164116828929068	0.7596153846153846	0.8061224489795918	0.7821782178217821	0.8148259303721489	0.6245886956593856	1.201	598.671	74.938	3.7500000000000005e-06	1.0	270
bert-base-uncased	1	1	5e-06	0.34974902868270874	0.8497913769123783	0.8576923076923076	0.7585034013605442	0.8050541516245487	0.8357222889155662	0.6870451600915204	1.1953	601.515	75.294	2.5e-06	2.0	540
bert-base-uncased	1	1	5e-06	0.36516380310058594	0.8595271210013908	0.8385964912280702	0.8129251700680272	0.8255613126079447	0.85234493797519	0.7082700338419254	1.2144	592.045	74.109	1.25e-06	3.0	810
bert-base-uncased	1	1	5e-06	0.38055309653282166	0.8623087621696801	0.8469750889679716	0.8095238095238095	0.8278260869565218	0.8541736694677872	0.7137139439852259	1.2213	588.74	73.695	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	1	1	5e-06	87.7345	98.251	12.31	221486064180000.0	0.35870048028451423	0.0	4.0	1080

2023-08-17 22:19:59,819 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:19:59,819 - INFO - **TRACE** Appending...0.4295399487018585
2023-08-17 22:19:59,819 - INFO - **TRACE** Appending...0.34974902868270874
2023-08-17 22:19:59,819 - INFO - **TRACE** Appending...0.36516380310058594
2023-08-17 22:19:59,819 - INFO - **TRACE** Appending...0.38055309653282166
2023-08-17 22:19:59,819 - INFO - **TRACE** Current innr cross fold(1) has lower loss, saving model...0.34974902868270874 < 0.419645220041275 LR: 5e-06
2023-08-17 22:20:00,415 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-17 22:20:00,415 - INFO - -----------------------------------
2023-08-17 22:20:00,415 - INFO - -----------------------------------
2023-08-17 22:20:00,415 - INFO - **TRACE** Inner Fold: 2 for outer fold: 1
2023-08-17 22:20:00,415 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-17 22:20:00,415 - INFO - **TRACE** Create dataset...
2023-08-17 22:20:00,416 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:20:00,420 - INFO - **TRACE** Tokenise data...
2023-08-17 22:20:01,053 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:20:01,054 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-05
2023-08-17 22:20:01,054 - INFO - Setting up training args and starting training...
2023-08-17 22:21:28,966 - INFO - Training complete...
2023-08-17 22:21:28,967 - INFO - TrainOutput(global_step=1080, training_loss=0.20903371528342918, metrics={'train_runtime': 86.8647, 'train_samples_per_second': 99.281, 'train_steps_per_second': 12.433, 'total_flos': 221588841936000.0, 'train_loss': 0.20903371528342918, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:21:28,967 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:21:29,618 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:21:29,618 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	1	2	5e-05	0.3284877836704254	0.8676880222841226	0.7839721254355401	0.872093023255814	0.8256880733944955	0.8686552072800808	0.7222034417182162	1.2032	596.729	74.799	3.7500000000000003e-05	1.0	270
bert-base-uncased	1	2	5e-05	0.5784628987312317	0.8607242339832869	0.7581699346405228	0.8992248062015504	0.822695035460993	0.8691776204920797	0.7163822381550978	1.202	597.326	74.874	2.5e-05	2.0	540
bert-base-uncased	1	2	5e-05	0.6263344287872314	0.883008356545961	0.859504132231405	0.8062015503875969	0.8320000000000001	0.8661442534546681	0.7432926314877605	1.2028	596.935	74.825	1.25e-05	3.0	810
bert-base-uncased	1	2	5e-05	0.7018172740936279	0.871866295264624	0.782312925170068	0.8914728682170543	0.8333333333333333	0.8761712167172229	0.73408733740781	1.208	594.381	74.505	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	1	2	5e-05	86.8647	99.281	12.433	221588841936000.0	0.20903371528342918	0.0	4.0	1080

2023-08-17 22:21:29,619 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:21:29,619 - INFO - **TRACE** Appending...0.3284877836704254
2023-08-17 22:21:29,619 - INFO - **TRACE** Appending...0.5784628987312317
2023-08-17 22:21:29,619 - INFO - **TRACE** Appending...0.6263344287872314
2023-08-17 22:21:29,619 - INFO - **TRACE** Appending...0.7018172740936279
2023-08-17 22:21:29,619 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.3284877836704254 < 0.34974902868270874 LR: 5e-05
2023-08-17 22:21:30,259 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-17 22:21:30,259 - INFO - -----------------------------------
2023-08-17 22:21:30,259 - INFO - -----------------------------------
2023-08-17 22:21:30,259 - INFO - **TRACE** Inner Fold: 3 for outer fold: 1
2023-08-17 22:21:30,259 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-17 22:21:30,259 - INFO - **TRACE** Create dataset...
2023-08-17 22:21:30,260 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:21:30,264 - INFO - **TRACE** Tokenise data...
2023-08-17 22:21:30,874 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:21:30,874 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 3e-05
2023-08-17 22:21:30,874 - INFO - Setting up training args and starting training...
2023-08-17 22:22:59,300 - INFO - Training complete...
2023-08-17 22:22:59,300 - INFO - TrainOutput(global_step=1080, training_loss=0.21291212726522374, metrics={'train_runtime': 87.3938, 'train_samples_per_second': 98.68, 'train_steps_per_second': 12.358, 'total_flos': 221588841936000.0, 'train_loss': 0.21291212726522374, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:22:59,300 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:22:59,924 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:22:59,925 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	1	3	3e-05	0.3096611499786377	0.8746518105849582	0.8395522388059702	0.8272058823529411	0.8333333333333333	0.8653966631495649	0.732947385717335	1.1971	599.785	75.182	2.25e-05	1.0	270
bert-base-uncased	1	3	3e-05	0.478184312582016	0.871866295264624	0.7903225806451613	0.9007352941176471	0.8419243986254296	0.877497691901873	0.7394098797638684	1.2281	584.638	73.283	1.5e-05	2.0	540
bert-base-uncased	1	3	3e-05	0.6068376898765564	0.8676880222841226	0.8339622641509434	0.8125	0.8230912476722534	0.8569226457399104	0.7176024993624628	1.1996	598.519	75.023	7.5e-06	3.0	810
bert-base-uncased	1	3	3e-05	0.6473758220672607	0.8774373259052924	0.8262411347517731	0.8566176470588235	0.8411552346570397	0.8733760881034027	0.7417551656932617	1.2163	590.302	73.993	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	1	3	3e-05	87.3938	98.68	12.358	221588841936000.0	0.21291212726522374	0.0	4.0	1080

2023-08-17 22:22:59,925 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:22:59,925 - INFO - **TRACE** Appending...0.3096611499786377
2023-08-17 22:22:59,925 - INFO - **TRACE** Appending...0.478184312582016
2023-08-17 22:22:59,925 - INFO - **TRACE** Appending...0.6068376898765564
2023-08-17 22:22:59,925 - INFO - **TRACE** Appending...0.6473758220672607
2023-08-17 22:22:59,925 - INFO - **TRACE** Current innr cross fold(3) has lower loss, saving model...0.3096611499786377 < 0.3284877836704254 LR: 3e-05
2023-08-17 22:23:00,528 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-17 22:23:00,528 - INFO - -----------------------------------
2023-08-17 22:23:00,528 - INFO - -----------------------------------
2023-08-17 22:23:00,528 - INFO - **TRACE** All inner CVs complete for outer CV 1
2023-08-17 22:23:00,528 - INFO - **TRACE** Best model selected from inner cv: 3 with loss: 0.3096611499786377 with learning rate: 3e-05
2023-08-17 22:23:00,528 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-17 22:23:00,528 - INFO - **TRACE** Loading the best model from inner CV
2023-08-17 22:23:01,904 - INFO - **TRACE** Running predictions with test data
2023-08-17 22:23:03,162 - INFO - Metrics from the Predictions...
2023-08-17 22:23:03,162 - INFO - {'test_loss': 0.222670316696167, 'test_accuracy': 0.9113043478260869, 'test_precision': 0.8811881188118812, 'test_recall': 0.8682926829268293, 'test_f1': 0.8746928746928747, 'test_roc_auc': 0.9017139090309821, 'test_matthews_correlation': 0.8061104602805746, 'test_runtime': 0.993, 'test_samples_per_second': 579.043, 'test_steps_per_second': 72.506}
2023-08-17 22:23:03,162 - INFO - {'confusion_matrix': array([[346,  24],
       [ 27, 178]])}
2023-08-17 22:23:03,162 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
bert-base-uncased	1	0.222670316696167	0.9113043478260869	0.8811881188118812	0.8682926829268293	0.8746928746928747	0.9017139090309821	0.8061104602805746	0.993	579.043	72.506
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
bert-base-uncased	1	[[346  24]
 [ 27 178]]

2023-08-17 22:23:03,163 - INFO - ----------------------------------------------------------------------
2023-08-17 22:23:03,163 - INFO - ----------------------------------------------------------------------
2023-08-17 22:23:03,163 - INFO - **TRACE** Outer Fold:2
2023-08-17 22:23:03,163 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-17 22:23:04,092 - INFO - -----------------------------------
2023-08-17 22:23:04,092 - INFO - -----------------------------------
2023-08-17 22:23:04,092 - INFO - **TRACE** Inner Fold: 0 for outer fold: 2
2023-08-17 22:23:04,092 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-17 22:23:04,092 - INFO - **TRACE** Create dataset...
2023-08-17 22:23:04,092 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:23:04,096 - INFO - **TRACE** Tokenise data...
2023-08-17 22:23:04,676 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:23:04,676 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 1e-05
2023-08-17 22:23:04,676 - INFO - Setting up training args and starting training...
2023-08-17 22:24:32,785 - INFO - Training complete...
2023-08-17 22:24:32,787 - INFO - TrainOutput(global_step=1080, training_loss=0.27851699899744103, metrics={'train_runtime': 87.0779, 'train_samples_per_second': 98.992, 'train_steps_per_second': 12.403, 'total_flos': 221486064180000.0, 'train_loss': 0.27851699899744103, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:24:32,787 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:24:33,597 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:24:33,598 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	2	0	1e-05	0.35699522495269775	0.8692628650904033	0.8540145985401459	0.8125	0.8327402135231317	0.8598462877030163	0.7261504560331827	1.2166	590.988	73.976	7.500000000000001e-06	1.0	270
bert-base-uncased	2	0	1e-05	0.45854222774505615	0.8372739916550765	0.9130434782608695	0.65625	0.7636363636363634	0.8072433294663572	0.6650084812239304	1.2339	582.708	72.94	5e-06	2.0	540
bert-base-uncased	2	0	1e-05	0.4821794033050537	0.8511821974965229	0.7928802588996764	0.8506944444444444	0.8207705192629816	0.8511012825470482	0.6950661240026749	1.2148	591.869	74.087	2.5e-06	3.0	810
bert-base-uncased	2	0	1e-05	0.525432825088501	0.8595271210013908	0.8191126279863481	0.8333333333333334	0.8261617900172118	0.8551817478731633	0.7083973126425246	1.3099	548.896	68.707	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	2	0	1e-05	87.0779	98.992	12.403	221486064180000.0	0.27851699899744103	0.0	4.0	1080

2023-08-17 22:24:33,598 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:24:33,598 - INFO - **TRACE** Appending...0.35699522495269775
2023-08-17 22:24:33,598 - INFO - **TRACE** Appending...0.45854222774505615
2023-08-17 22:24:33,598 - INFO - **TRACE** Appending...0.4821794033050537
2023-08-17 22:24:33,598 - INFO - **TRACE** Appending...0.525432825088501
2023-08-17 22:24:33,598 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.35699522495269775 < 1000 LR: 1e-05
2023-08-17 22:24:34,364 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-17 22:24:34,364 - INFO - -----------------------------------
2023-08-17 22:24:34,364 - INFO - -----------------------------------
2023-08-17 22:24:34,364 - INFO - **TRACE** Inner Fold: 1 for outer fold: 2
2023-08-17 22:24:34,364 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-17 22:24:34,364 - INFO - **TRACE** Create dataset...
2023-08-17 22:24:34,365 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:24:34,369 - INFO - **TRACE** Tokenise data...
2023-08-17 22:24:40,041 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:24:40,041 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-06
2023-08-17 22:24:40,041 - INFO - Setting up training args and starting training...
2023-08-17 22:26:07,966 - INFO - Training complete...
2023-08-17 22:26:07,988 - INFO - TrainOutput(global_step=1080, training_loss=0.3557133180123788, metrics={'train_runtime': 86.8633, 'train_samples_per_second': 99.236, 'train_steps_per_second': 12.433, 'total_flos': 221486064180000.0, 'train_loss': 0.3557133180123788, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:26:07,988 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:26:08,661 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:26:08,662 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	2	1	5e-06	0.40122148394584656	0.8358831710709318	0.8286852589641435	0.734982332155477	0.7790262172284644	0.8181792394722339	0.6521965696369882	1.2086	594.908	74.467	3.7500000000000005e-06	1.0	270
bert-base-uncased	2	1	5e-06	0.353017657995224	0.8442280945757997	0.8202247191011236	0.773851590106007	0.7963636363636364	0.8318799234933705	0.6711546311370721	1.2323	583.459	73.034	2.5e-06	2.0	540
bert-base-uncased	2	1	5e-06	0.3920877277851105	0.8525730180806675	0.8265682656826568	0.7915194346289752	0.8086642599277979	0.8418606347456803	0.689274005460443	1.2121	593.188	74.252	1.25e-06	3.0	810
bert-base-uncased	2	1	5e-06	0.40684422850608826	0.8595271210013908	0.8345588235294118	0.8021201413427562	0.8180180180180181	0.8494545660842221	0.7040750650230507	1.2511	574.691	71.936	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	2	1	5e-06	86.8633	99.236	12.433	221486064180000.0	0.3557133180123788	0.0	4.0	1080

2023-08-17 22:26:08,662 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:26:08,662 - INFO - **TRACE** Appending...0.40122148394584656
2023-08-17 22:26:08,662 - INFO - **TRACE** Appending...0.353017657995224
2023-08-17 22:26:08,662 - INFO - **TRACE** Appending...0.3920877277851105
2023-08-17 22:26:08,662 - INFO - **TRACE** Appending...0.40684422850608826
2023-08-17 22:26:08,662 - INFO - **TRACE** Current innr cross fold(1) has lower loss, saving model...0.353017657995224 < 0.35699522495269775 LR: 5e-06
2023-08-17 22:26:09,327 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-17 22:26:09,327 - INFO - -----------------------------------
2023-08-17 22:26:09,327 - INFO - -----------------------------------
2023-08-17 22:26:09,327 - INFO - **TRACE** Inner Fold: 2 for outer fold: 2
2023-08-17 22:26:09,327 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-17 22:26:09,327 - INFO - **TRACE** Create dataset...
2023-08-17 22:26:09,328 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:26:09,332 - INFO - **TRACE** Tokenise data...
2023-08-17 22:26:09,994 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:26:09,994 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-05
2023-08-17 22:26:09,994 - INFO - Setting up training args and starting training...
2023-08-17 22:27:38,282 - INFO - Training complete...
2023-08-17 22:27:38,284 - INFO - TrainOutput(global_step=1080, training_loss=0.21370750003390843, metrics={'train_runtime': 87.2459, 'train_samples_per_second': 98.847, 'train_steps_per_second': 12.379, 'total_flos': 221588841936000.0, 'train_loss': 0.21370750003390843, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:27:38,284 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:27:38,933 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:27:38,934 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	2	2	5e-05	0.36283382773399353	0.8579387186629527	0.7793594306049823	0.8455598455598455	0.8111111111111111	0.8552417964182669	0.699063133933074	1.2092	593.761	74.427	3.7500000000000003e-05	1.0	270
bert-base-uncased	2	2	5e-05	0.5345609188079834	0.8649025069637883	0.7872340425531915	0.8571428571428571	0.8207024029574862	0.8632119514472456	0.7142965494309818	1.2252	586.021	73.457	2.5e-05	2.0	540
bert-base-uncased	2	2	5e-05	0.6880043745040894	0.8649025069637883	0.8375	0.7760617760617761	0.8056112224448899	0.8455472279001691	0.7035161386096318	1.2305	583.507	73.142	1.25e-05	3.0	810
bert-base-uncased	2	2	5e-05	0.7691728472709656	0.8649025069637883	0.7934782608695652	0.8455598455598455	0.8186915887850467	0.8606884195119489	0.7121192791961894	1.2176	589.673	73.915	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	2	2	5e-05	87.2459	98.847	12.379	221588841936000.0	0.21370750003390843	0.0	4.0	1080

2023-08-17 22:27:38,934 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:27:38,934 - INFO - **TRACE** Appending...0.36283382773399353
2023-08-17 22:27:38,934 - INFO - **TRACE** Appending...0.5345609188079834
2023-08-17 22:27:38,934 - INFO - **TRACE** Appending...0.6880043745040894
2023-08-17 22:27:38,934 - INFO - **TRACE** Appending...0.7691728472709656
2023-08-17 22:27:38,934 - INFO - **TRACE** Model not saved since current innr cross fold(2) has higher loss...0.36283382773399353 >= 0.353017657995224 LR: 5e-05
2023-08-17 22:27:38,934 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-17 22:27:38,934 - INFO - -----------------------------------
2023-08-17 22:27:38,934 - INFO - -----------------------------------
2023-08-17 22:27:38,934 - INFO - **TRACE** Inner Fold: 3 for outer fold: 2
2023-08-17 22:27:38,934 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-17 22:27:38,934 - INFO - **TRACE** Create dataset...
2023-08-17 22:27:38,935 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:27:38,939 - INFO - **TRACE** Tokenise data...
2023-08-17 22:27:39,530 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:27:39,531 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 3e-05
2023-08-17 22:27:39,531 - INFO - Setting up training args and starting training...
2023-08-17 22:29:08,208 - INFO - Training complete...
2023-08-17 22:29:08,208 - INFO - TrainOutput(global_step=1080, training_loss=0.221360182762146, metrics={'train_runtime': 87.6463, 'train_samples_per_second': 98.396, 'train_steps_per_second': 12.322, 'total_flos': 221588841936000.0, 'train_loss': 0.221360182762146, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:29:08,208 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:29:08,802 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:29:08,802 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	2	3	3e-05	0.41870713233947754	0.8370473537604457	0.8340425531914893	0.7153284671532847	0.7701375245579568	0.8137453146577234	0.6496306613219025	1.2168	590.088	73.966	2.25e-05	1.0	270
bert-base-uncased	2	3	3e-05	0.521889865398407	0.8760445682451253	0.8388278388278388	0.8357664233576643	0.8372943327239489	0.8683336621292826	0.7371856014752118	1.2125	592.141	74.224	1.5e-05	2.0	540
bert-base-uncased	2	3	3e-05	0.628507673740387	0.8662952646239555	0.8178571428571428	0.8357664233576643	0.8267148014440433	0.8604507792463997	0.7180036631507589	1.2141	591.368	74.127	7.5e-06	3.0	810
bert-base-uncased	2	3	3e-05	0.7291005849838257	0.8662952646239555	0.822463768115942	0.8284671532846716	0.8254545454545454	0.8590533964621556	0.7171171778167755	1.2022	597.238	74.863	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	2	3	3e-05	87.6463	98.396	12.322	221588841936000.0	0.221360182762146	0.0	4.0	1080

2023-08-17 22:29:08,802 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:29:08,802 - INFO - **TRACE** Appending...0.41870713233947754
2023-08-17 22:29:08,802 - INFO - **TRACE** Appending...0.521889865398407
2023-08-17 22:29:08,802 - INFO - **TRACE** Appending...0.628507673740387
2023-08-17 22:29:08,802 - INFO - **TRACE** Appending...0.7291005849838257
2023-08-17 22:29:08,802 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.41870713233947754 >= 0.36283382773399353 LR: 3e-05
2023-08-17 22:29:08,802 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-17 22:29:08,802 - INFO - -----------------------------------
2023-08-17 22:29:08,802 - INFO - -----------------------------------
2023-08-17 22:29:08,802 - INFO - **TRACE** All inner CVs complete for outer CV 2
2023-08-17 22:29:08,802 - INFO - **TRACE** Best model selected from inner cv: 1 with loss: 0.353017657995224 with learning rate: 3e-05
2023-08-17 22:29:08,802 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-17 22:29:08,802 - INFO - **TRACE** Loading the best model from inner CV
2023-08-17 22:29:09,558 - INFO - **TRACE** Running predictions with test data
2023-08-17 22:29:10,879 - INFO - Metrics from the Predictions...
2023-08-17 22:29:10,879 - INFO - {'test_loss': 0.29849788546562195, 'test_accuracy': 0.88, 'test_precision': 0.8820224719101124, 'test_recall': 0.7658536585365854, 'test_f1': 0.8198433420365535, 'test_roc_auc': 0.8545484508899144, 'test_matthews_correlation': 0.7346460128069013, 'test_runtime': 1.0742, 'test_samples_per_second': 535.267, 'test_steps_per_second': 67.025}
2023-08-17 22:29:10,879 - INFO - {'confusion_matrix': array([[349,  21],
       [ 48, 157]])}
2023-08-17 22:29:10,879 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
bert-base-uncased	2	0.29849788546562195	0.88	0.8820224719101124	0.7658536585365854	0.8198433420365535	0.8545484508899144	0.7346460128069013	1.0742	535.267	67.025
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
bert-base-uncased	2	[[349  21]
 [ 48 157]]

2023-08-17 22:29:10,879 - INFO - ----------------------------------------------------------------------
2023-08-17 22:29:10,879 - INFO - ----------------------------------------------------------------------
2023-08-17 22:29:10,879 - INFO - **TRACE** Outer Fold:3
2023-08-17 22:29:10,880 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-17 22:29:11,479 - INFO - -----------------------------------
2023-08-17 22:29:11,479 - INFO - -----------------------------------
2023-08-17 22:29:11,479 - INFO - **TRACE** Inner Fold: 0 for outer fold: 3
2023-08-17 22:29:11,479 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-17 22:29:11,479 - INFO - **TRACE** Create dataset...
2023-08-17 22:29:11,480 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:29:11,483 - INFO - **TRACE** Tokenise data...
2023-08-17 22:29:12,018 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:29:12,018 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 1e-05
2023-08-17 22:29:12,018 - INFO - Setting up training args and starting training...
2023-08-17 22:30:40,580 - INFO - Training complete...
2023-08-17 22:30:40,580 - INFO - TrainOutput(global_step=1080, training_loss=0.2845208733170121, metrics={'train_runtime': 87.5503, 'train_samples_per_second': 98.458, 'train_steps_per_second': 12.336, 'total_flos': 221486064180000.0, 'train_loss': 0.2845208733170121, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:30:40,580 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:30:41,447 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:30:41,450 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	3	0	1e-05	0.4168069660663605	0.8331015299026425	0.8041666666666667	0.7255639097744361	0.7628458498023716	0.8109055751962687	0.6366123322162114	1.2181	590.25	73.884	7.500000000000001e-06	1.0	270
bert-base-uncased	3	0	1e-05	0.50203537940979	0.8400556328233658	0.8106995884773662	0.7406015037593985	0.7740667976424361	0.819528124948132	0.6522624729913323	1.2319	583.633	73.056	5e-06	2.0	540
bert-base-uncased	3	0	1e-05	0.6152589917182922	0.8456189151599444	0.8015564202334631	0.7744360902255639	0.7877629063097515	0.8309266543843052	0.6667516732123628	1.2214	588.654	73.684	2.5e-06	3.0	810
bert-base-uncased	3	0	1e-05	0.6746305227279663	0.8414464534075105	0.7835820895522388	0.7894736842105263	0.7865168539325844	0.8307191820611131	0.6604251936597153	1.2242	587.301	73.515	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	3	0	1e-05	87.5503	98.458	12.336	221486064180000.0	0.2845208733170121	0.0	4.0	1080

2023-08-17 22:30:41,451 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:30:41,451 - INFO - **TRACE** Appending...0.4168069660663605
2023-08-17 22:30:41,451 - INFO - **TRACE** Appending...0.50203537940979
2023-08-17 22:30:41,451 - INFO - **TRACE** Appending...0.6152589917182922
2023-08-17 22:30:41,451 - INFO - **TRACE** Appending...0.6746305227279663
2023-08-17 22:30:41,451 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.4168069660663605 < 1000 LR: 1e-05
2023-08-17 22:30:42,345 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-17 22:30:42,345 - INFO - -----------------------------------
2023-08-17 22:30:42,345 - INFO - -----------------------------------
2023-08-17 22:30:42,346 - INFO - **TRACE** Inner Fold: 1 for outer fold: 3
2023-08-17 22:30:42,346 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-17 22:30:42,346 - INFO - **TRACE** Create dataset...
2023-08-17 22:30:42,346 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:30:42,350 - INFO - **TRACE** Tokenise data...
2023-08-17 22:30:42,981 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:30:42,981 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-06
2023-08-17 22:30:42,981 - INFO - Setting up training args and starting training...
2023-08-17 22:32:12,040 - INFO - Training complete...
2023-08-17 22:32:12,040 - INFO - TrainOutput(global_step=1080, training_loss=0.3745531965185095, metrics={'train_runtime': 87.9961, 'train_samples_per_second': 97.959, 'train_steps_per_second': 12.273, 'total_flos': 221486064180000.0, 'train_loss': 0.3745531965185095, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:32:12,040 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:32:12,694 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:32:12,695 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	3	1	5e-06	0.4588148593902588	0.8122392211404729	0.8817733990147784	0.6172413793103448	0.7261663286004056	0.7806486616831445	0.6117130512161839	1.2315	583.836	73.081	3.7500000000000005e-06	1.0	270
bert-base-uncased	3	1	5e-06	0.3598475754261017	0.8484005563282336	0.8851063829787233	0.7172413793103448	0.7923809523809523	0.827152158186641	0.6843067413136424	1.2306	584.262	73.134	2.5e-06	2.0	540
bert-base-uncased	3	1	5e-06	0.3248887360095978	0.866481223922114	0.87890625	0.7758620689655172	0.824175824175824	0.8518004983522225	0.7208478589735007	1.2211	588.832	73.706	1.25e-06	3.0	810
bert-base-uncased	3	1	5e-06	0.30847084522247314	0.874826147426982	0.852112676056338	0.8344827586206897	0.8432055749128919	0.8682903303592959	0.7391697044156622	1.2458	577.118	72.24	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	3	1	5e-06	87.9961	97.959	12.273	221486064180000.0	0.3745531965185095	0.0	4.0	1080

2023-08-17 22:32:12,695 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:32:12,695 - INFO - **TRACE** Appending...0.4588148593902588
2023-08-17 22:32:12,695 - INFO - **TRACE** Appending...0.3598475754261017
2023-08-17 22:32:12,695 - INFO - **TRACE** Appending...0.3248887360095978
2023-08-17 22:32:12,695 - INFO - **TRACE** Appending...0.30847084522247314
2023-08-17 22:32:12,695 - INFO - **TRACE** Current innr cross fold(1) has lower loss, saving model...0.30847084522247314 < 0.4168069660663605 LR: 5e-06
2023-08-17 22:32:13,320 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-17 22:32:13,320 - INFO - -----------------------------------
2023-08-17 22:32:13,320 - INFO - -----------------------------------
2023-08-17 22:32:13,320 - INFO - **TRACE** Inner Fold: 2 for outer fold: 3
2023-08-17 22:32:13,320 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-17 22:32:13,320 - INFO - **TRACE** Create dataset...
2023-08-17 22:32:13,320 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:32:13,325 - INFO - **TRACE** Tokenise data...
2023-08-17 22:32:19,026 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:32:19,027 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-05
2023-08-17 22:32:19,027 - INFO - Setting up training args and starting training...
2023-08-17 22:33:47,293 - INFO - Training complete...
2023-08-17 22:33:47,293 - INFO - TrainOutput(global_step=1080, training_loss=0.2215006828584053, metrics={'train_runtime': 87.209, 'train_samples_per_second': 98.889, 'train_steps_per_second': 12.384, 'total_flos': 221588841936000.0, 'train_loss': 0.2215006828584053, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:33:47,293 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:33:47,967 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:33:47,968 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	3	2	5e-05	0.3578113317489624	0.8454038997214485	0.7894736842105263	0.7924528301886793	0.7909604519774011	0.8344162605689533	0.6683121923105986	1.207	594.885	74.568	3.7500000000000003e-05	1.0	270
bert-base-uncased	3	2	5e-05	0.47693580389022827	0.8537604456824512	0.7898550724637681	0.8226415094339623	0.8059149722735675	0.847303094672831	0.6890409152443953	1.2071	594.796	74.557	2.5e-05	2.0	540
bert-base-uncased	3	2	5e-05	0.6779947280883789	0.8537604456824512	0.8076923076923077	0.7924528301886793	0.7999999999999999	0.8410387771252447	0.6848356862894704	1.2359	580.962	72.823	1.25e-05	3.0	810
bert-base-uncased	3	2	5e-05	0.8033460974693298	0.8565459610027855	0.8214285714285714	0.7811320754716982	0.8007736943907157	0.8408971635636637	0.689337956838437	1.2542	572.476	71.759	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	3	2	5e-05	87.209	98.889	12.384	221588841936000.0	0.2215006828584053	0.0	4.0	1080

2023-08-17 22:33:47,968 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:33:47,968 - INFO - **TRACE** Appending...0.3578113317489624
2023-08-17 22:33:47,968 - INFO - **TRACE** Appending...0.47693580389022827
2023-08-17 22:33:47,968 - INFO - **TRACE** Appending...0.6779947280883789
2023-08-17 22:33:47,968 - INFO - **TRACE** Appending...0.8033460974693298
2023-08-17 22:33:47,968 - INFO - **TRACE** Model not saved since current innr cross fold(2) has higher loss...0.3578113317489624 >= 0.30847084522247314 LR: 5e-05
2023-08-17 22:33:47,968 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-17 22:33:47,968 - INFO - -----------------------------------
2023-08-17 22:33:47,968 - INFO - -----------------------------------
2023-08-17 22:33:47,968 - INFO - **TRACE** Inner Fold: 3 for outer fold: 3
2023-08-17 22:33:47,968 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-17 22:33:47,968 - INFO - **TRACE** Create dataset...
2023-08-17 22:33:47,969 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:33:47,974 - INFO - **TRACE** Tokenise data...
2023-08-17 22:33:48,912 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:33:48,912 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 3e-05
2023-08-17 22:33:48,912 - INFO - Setting up training args and starting training...
2023-08-17 22:35:17,214 - INFO - Training complete...
2023-08-17 22:35:17,215 - INFO - TrainOutput(global_step=1080, training_loss=0.19944955794899552, metrics={'train_runtime': 87.2783, 'train_samples_per_second': 98.81, 'train_steps_per_second': 12.374, 'total_flos': 221588841936000.0, 'train_loss': 0.19944955794899552, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:35:17,216 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:35:17,844 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:35:17,844 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	3	3	3e-05	0.3517826497554779	0.8523676880222841	0.8702928870292888	0.734982332155477	0.7969348659003832	0.8318589821696926	0.6882634570809371	1.2093	593.718	74.421	2.25e-05	1.0	270
bert-base-uncased	3	3	3e-05	0.49661755561828613	0.8662952646239555	0.8169491525423729	0.8515901060070671	0.833910034602076	0.8637260874862921	0.722538679857383	1.2289	584.272	73.237	1.5e-05	2.0	540
bert-base-uncased	3	3	3e-05	0.7041975259780884	0.8635097493036211	0.8093645484949833	0.8551236749116607	0.831615120274914	0.86204459607652	0.7177733108083952	1.2034	596.64	74.788	7.5e-06	3.0	810
bert-base-uncased	3	3	3e-05	0.7656065821647644	0.8732590529247911	0.8356643356643356	0.8445229681978799	0.8400702987697715	0.8682384955931928	0.7351435303212743	1.2103	593.234	74.361	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	3	3	3e-05	87.2783	98.81	12.374	221588841936000.0	0.19944955794899552	0.0	4.0	1080

2023-08-17 22:35:17,845 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:35:17,845 - INFO - **TRACE** Appending...0.3517826497554779
2023-08-17 22:35:17,845 - INFO - **TRACE** Appending...0.49661755561828613
2023-08-17 22:35:17,845 - INFO - **TRACE** Appending...0.7041975259780884
2023-08-17 22:35:17,845 - INFO - **TRACE** Appending...0.7656065821647644
2023-08-17 22:35:17,845 - INFO - **TRACE** Current innr cross fold(3) has lower loss, saving model...0.3517826497554779 < 0.3578113317489624 LR: 3e-05
2023-08-17 22:35:18,710 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-17 22:35:18,710 - INFO - -----------------------------------
2023-08-17 22:35:18,710 - INFO - -----------------------------------
2023-08-17 22:35:18,710 - INFO - **TRACE** All inner CVs complete for outer CV 3
2023-08-17 22:35:18,710 - INFO - **TRACE** Best model selected from inner cv: 3 with loss: 0.3517826497554779 with learning rate: 3e-05
2023-08-17 22:35:18,710 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-17 22:35:18,710 - INFO - **TRACE** Loading the best model from inner CV
2023-08-17 22:35:19,480 - INFO - **TRACE** Running predictions with test data
2023-08-17 22:35:20,715 - INFO - Metrics from the Predictions...
2023-08-17 22:35:20,715 - INFO - {'test_loss': 0.2349471151828766, 'test_accuracy': 0.9043478260869565, 'test_precision': 0.8952879581151832, 'test_recall': 0.8300970873786407, 'test_f1': 0.8614609571788413, 'test_roc_auc': 0.8879482726866103, 'test_matthews_correlation': 0.7898930918847935, 'test_runtime': 0.9702, 'test_samples_per_second': 592.652, 'test_steps_per_second': 74.21}
2023-08-17 22:35:20,715 - INFO - {'confusion_matrix': array([[349,  20],
       [ 35, 171]])}
2023-08-17 22:35:20,716 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
bert-base-uncased	3	0.2349471151828766	0.9043478260869565	0.8952879581151832	0.8300970873786407	0.8614609571788413	0.8879482726866103	0.7898930918847935	0.9702	592.652	74.21
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
bert-base-uncased	3	[[349  20]
 [ 35 171]]

2023-08-17 22:35:20,716 - INFO - ----------------------------------------------------------------------
2023-08-17 22:35:20,716 - INFO - ----------------------------------------------------------------------
2023-08-17 22:35:20,716 - INFO - **TRACE** Outer Fold:4
2023-08-17 22:35:20,716 - INFO - Dataset sizes: Train - 2874 Test - 575
2023-08-17 22:35:21,362 - INFO - -----------------------------------
2023-08-17 22:35:21,363 - INFO - -----------------------------------
2023-08-17 22:35:21,363 - INFO - **TRACE** Inner Fold: 0 for outer fold: 4
2023-08-17 22:35:21,363 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-17 22:35:21,363 - INFO - **TRACE** Create dataset...
2023-08-17 22:35:21,364 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:35:21,369 - INFO - **TRACE** Tokenise data...
2023-08-17 22:35:21,909 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:35:21,909 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 1e-05
2023-08-17 22:35:21,909 - INFO - Setting up training args and starting training...
2023-08-17 22:36:49,877 - INFO - Training complete...
2023-08-17 22:36:49,877 - INFO - TrainOutput(global_step=1080, training_loss=0.3129547595977783, metrics={'train_runtime': 86.9427, 'train_samples_per_second': 99.146, 'train_steps_per_second': 12.422, 'total_flos': 221486064180000.0, 'train_loss': 0.3129547595977783, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:36:49,877 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:36:50,464 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:36:50,465 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	4	0	1e-05	0.3901924192905426	0.8414464534075105	0.8738738738738738	0.6928571428571428	0.7729083665338645	0.8145379108363162	0.663987017131967	1.2065	595.923	74.594	7.500000000000001e-06	1.0	270
bert-base-uncased	4	0	1e-05	0.371431440114975	0.8581363004172462	0.856	0.7642857142857142	0.8075471698113208	0.8411405792385291	0.6985833464938951	1.2366	581.449	72.782	5e-06	2.0	540
bert-base-uncased	4	0	1e-05	0.45497313141822815	0.8595271210013908	0.8140350877192982	0.8285714285714286	0.8212389380530973	0.8539212495932315	0.7056358146353379	1.2305	584.318	73.141	2.5e-06	3.0	810
bert-base-uncased	4	0	1e-05	0.4935186505317688	0.8706536856745479	0.8555133079847909	0.8035714285714286	0.8287292817679558	0.858505532053368	0.7259000686535274	1.2252	586.822	73.455	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	4	0	1e-05	86.9427	99.146	12.422	221486064180000.0	0.3129547595977783	0.0	4.0	1080

2023-08-17 22:36:50,465 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:36:50,465 - INFO - **TRACE** Appending...0.3901924192905426
2023-08-17 22:36:50,465 - INFO - **TRACE** Appending...0.371431440114975
2023-08-17 22:36:50,465 - INFO - **TRACE** Appending...0.45497313141822815
2023-08-17 22:36:50,465 - INFO - **TRACE** Appending...0.4935186505317688
2023-08-17 22:36:50,465 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.371431440114975 < 1000 LR: 1e-05
2023-08-17 22:36:51,070 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-17 22:36:51,070 - INFO - -----------------------------------
2023-08-17 22:36:51,071 - INFO - -----------------------------------
2023-08-17 22:36:51,071 - INFO - **TRACE** Inner Fold: 1 for outer fold: 4
2023-08-17 22:36:51,071 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-17 22:36:51,071 - INFO - **TRACE** Create dataset...
2023-08-17 22:36:51,071 - INFO - Dataset sizes: Train - 2155 Dev - 719
2023-08-17 22:36:51,075 - INFO - **TRACE** Tokenise data...
2023-08-17 22:36:56,779 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:36:56,779 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-06
2023-08-17 22:36:56,779 - INFO - Setting up training args and starting training...
2023-08-17 22:38:25,193 - INFO - Training complete...
2023-08-17 22:38:25,194 - INFO - TrainOutput(global_step=1080, training_loss=0.3620328249754729, metrics={'train_runtime': 87.3914, 'train_samples_per_second': 98.637, 'train_steps_per_second': 12.358, 'total_flos': 221486064180000.0, 'train_loss': 0.3620328249754729, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:38:25,194 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:38:25,847 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:38:25,848 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	4	1	5e-06	0.3849787712097168	0.8497913769123783	0.8576923076923076	0.7585034013605442	0.8050541516245487	0.8357222889155662	0.6870451600915204	1.2234	587.702	73.565	3.7500000000000005e-06	1.0	270
bert-base-uncased	4	1	5e-06	0.3340020179748535	0.8636995827538247	0.8266666666666667	0.8435374149659864	0.835016835016835	0.860592236894758	0.719029749900525	1.265	568.365	71.144	2.5e-06	2.0	540
bert-base-uncased	4	1	5e-06	0.36847513914108276	0.8595271210013908	0.8669201520912547	0.7755102040816326	0.8186714542190306	0.8465786314525809	0.7075214530073842	1.2131	592.678	74.188	1.25e-06	3.0	810
bert-base-uncased	4	1	5e-06	0.36821117997169495	0.8650904033379694	0.8408304498269896	0.826530612244898	0.8336192109777014	0.8591476590636253	0.7202578772989634	1.2128	592.822	74.206	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	4	1	5e-06	87.3914	98.637	12.358	221486064180000.0	0.3620328249754729	0.0	4.0	1080

2023-08-17 22:38:25,848 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:38:25,848 - INFO - **TRACE** Appending...0.3849787712097168
2023-08-17 22:38:25,848 - INFO - **TRACE** Appending...0.3340020179748535
2023-08-17 22:38:25,848 - INFO - **TRACE** Appending...0.36847513914108276
2023-08-17 22:38:25,848 - INFO - **TRACE** Appending...0.36821117997169495
2023-08-17 22:38:25,848 - INFO - **TRACE** Current innr cross fold(1) has lower loss, saving model...0.3340020179748535 < 0.371431440114975 LR: 5e-06
2023-08-17 22:38:26,531 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-17 22:38:26,531 - INFO - -----------------------------------
2023-08-17 22:38:26,531 - INFO - -----------------------------------
2023-08-17 22:38:26,531 - INFO - **TRACE** Inner Fold: 2 for outer fold: 4
2023-08-17 22:38:26,531 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-17 22:38:26,531 - INFO - **TRACE** Create dataset...
2023-08-17 22:38:26,532 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:38:26,536 - INFO - **TRACE** Tokenise data...
2023-08-17 22:38:27,172 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:38:27,172 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-05
2023-08-17 22:38:27,172 - INFO - Setting up training args and starting training...
2023-08-17 22:39:56,094 - INFO - Training complete...
2023-08-17 22:39:56,094 - INFO - TrainOutput(global_step=1080, training_loss=0.225230645581528, metrics={'train_runtime': 87.8845, 'train_samples_per_second': 98.129, 'train_steps_per_second': 12.289, 'total_flos': 221588841936000.0, 'train_loss': 0.225230645581528, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:39:56,094 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:39:56,726 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:39:56,727 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	4	2	5e-05	0.40737447142601013	0.8467966573816156	0.8076923076923077	0.7777777777777778	0.7924528301886792	0.8330853174603173	0.6714086946258742	1.213	591.915	74.195	3.7500000000000003e-05	1.0	270
bert-base-uncased	4	2	5e-05	0.6107972860336304	0.8440111420612814	0.778169014084507	0.8185185185185185	0.7978339350180506	0.8389467592592592	0.6715499727986047	1.2074	594.69	74.543	2.5e-05	2.0	540
bert-base-uncased	4	2	5e-05	0.6942787170410156	0.8579387186629527	0.7709677419354839	0.8851851851851852	0.8241379310344826	0.8633515211640213	0.7106682921473472	1.2226	587.263	73.612	1.25e-05	3.0	810
bert-base-uncased	4	2	5e-05	0.7779325842857361	0.8579387186629527	0.7857142857142857	0.8555555555555555	0.8191489361702127	0.8574652777777778	0.7042521060943339	1.2197	588.679	73.79	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	4	2	5e-05	87.8845	98.129	12.289	221588841936000.0	0.225230645581528	0.0	4.0	1080

2023-08-17 22:39:56,727 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:39:56,727 - INFO - **TRACE** Appending...0.40737447142601013
2023-08-17 22:39:56,727 - INFO - **TRACE** Appending...0.6107972860336304
2023-08-17 22:39:56,727 - INFO - **TRACE** Appending...0.6942787170410156
2023-08-17 22:39:56,727 - INFO - **TRACE** Appending...0.7779325842857361
2023-08-17 22:39:56,727 - INFO - **TRACE** Model not saved since current innr cross fold(2) has higher loss...0.40737447142601013 >= 0.3340020179748535 LR: 5e-05
2023-08-17 22:39:56,727 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-17 22:39:56,727 - INFO - -----------------------------------
2023-08-17 22:39:56,727 - INFO - -----------------------------------
2023-08-17 22:39:56,727 - INFO - **TRACE** Inner Fold: 3 for outer fold: 4
2023-08-17 22:39:56,727 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-17 22:39:56,727 - INFO - **TRACE** Create dataset...
2023-08-17 22:39:56,728 - INFO - Dataset sizes: Train - 2156 Dev - 718
2023-08-17 22:39:56,733 - INFO - **TRACE** Tokenise data...
2023-08-17 22:40:02,337 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:40:02,337 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 3e-05
2023-08-17 22:40:02,337 - INFO - Setting up training args and starting training...
2023-08-17 22:41:30,429 - INFO - Training complete...
2023-08-17 22:41:30,431 - INFO - TrainOutput(global_step=1080, training_loss=0.20257886350154877, metrics={'train_runtime': 87.072, 'train_samples_per_second': 99.045, 'train_steps_per_second': 12.404, 'total_flos': 221588841936000.0, 'train_loss': 0.20257886350154877, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:41:30,431 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:41:31,025 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:41:31,025 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	4	3	3e-05	0.3755650520324707	0.8579387186629527	0.7743055555555556	0.8576923076923076	0.8138686131386862	0.8578854551561975	0.7018801909178173	1.205	595.831	74.686	2.25e-05	1.0	270
bert-base-uncased	4	3	3e-05	0.516548752784729	0.8662952646239555	0.828	0.7961538461538461	0.8117647058823529	0.8511336916358749	0.7084822600212479	1.2136	591.611	74.157	1.5e-05	2.0	540
bert-base-uncased	4	3	3e-05	0.7104907035827637	0.8635097493036211	0.7852112676056338	0.8576923076923076	0.8198529411764706	0.8622522673832718	0.712125416266888	1.2134	591.73	74.172	7.5e-06	3.0	810
bert-base-uncased	4	3	3e-05	0.752013623714447	0.8676880222841226	0.8	0.8461538461538461	0.8224299065420562	0.8630332549546523	0.717839923042709	1.2154	590.729	74.047	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	4	3	3e-05	87.072	99.045	12.404	221588841936000.0	0.20257886350154877	0.0	4.0	1080

2023-08-17 22:41:31,025 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:41:31,025 - INFO - **TRACE** Appending...0.3755650520324707
2023-08-17 22:41:31,025 - INFO - **TRACE** Appending...0.516548752784729
2023-08-17 22:41:31,025 - INFO - **TRACE** Appending...0.7104907035827637
2023-08-17 22:41:31,025 - INFO - **TRACE** Appending...0.752013623714447
2023-08-17 22:41:31,025 - INFO - **TRACE** Current innr cross fold(3) has lower loss, saving model...0.3755650520324707 < 0.40737447142601013 LR: 3e-05
2023-08-17 22:41:31,639 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-17 22:41:31,639 - INFO - -----------------------------------
2023-08-17 22:41:31,639 - INFO - -----------------------------------
2023-08-17 22:41:31,639 - INFO - **TRACE** All inner CVs complete for outer CV 4
2023-08-17 22:41:31,639 - INFO - **TRACE** Best model selected from inner cv: 3 with loss: 0.3755650520324707 with learning rate: 3e-05
2023-08-17 22:41:31,639 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-17 22:41:31,639 - INFO - **TRACE** Loading the best model from inner CV
2023-08-17 22:41:33,024 - INFO - **TRACE** Running predictions with test data
2023-08-17 22:41:34,290 - INFO - Metrics from the Predictions...
2023-08-17 22:41:34,290 - INFO - {'test_loss': 0.28147947788238525, 'test_accuracy': 0.8973913043478261, 'test_precision': 0.8356164383561644, 'test_recall': 0.8883495145631068, 'test_f1': 0.8611764705882352, 'test_roc_auc': 0.8953942694766754, 'test_matthews_correlation': 0.7808364948169353, 'test_runtime': 0.988, 'test_samples_per_second': 581.956, 'test_steps_per_second': 72.871}
2023-08-17 22:41:34,290 - INFO - {'confusion_matrix': array([[333,  36],
       [ 23, 183]])}
2023-08-17 22:41:34,290 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
bert-base-uncased	4	0.28147947788238525	0.8973913043478261	0.8356164383561644	0.8883495145631068	0.8611764705882352	0.8953942694766754	0.7808364948169353	0.988	581.956	72.871
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
bert-base-uncased	4	[[333  36]
 [ 23 183]]

2023-08-17 22:41:34,291 - INFO - ----------------------------------------------------------------------
2023-08-17 22:41:34,291 - INFO - ----------------------------------------------------------------------
2023-08-17 22:41:34,291 - INFO - **TRACE** Outer Fold:5
2023-08-17 22:41:34,291 - INFO - Dataset sizes: Train - 2875 Test - 574
2023-08-17 22:41:34,962 - INFO - -----------------------------------
2023-08-17 22:41:34,962 - INFO - -----------------------------------
2023-08-17 22:41:34,962 - INFO - **TRACE** Inner Fold: 0 for outer fold: 5
2023-08-17 22:41:34,962 - INFO - **TRACE** Learning rate used: 1e-05
2023-08-17 22:41:34,962 - INFO - **TRACE** Create dataset...
2023-08-17 22:41:34,963 - INFO - Dataset sizes: Train - 2156 Dev - 719
2023-08-17 22:41:34,967 - INFO - **TRACE** Tokenise data...
2023-08-17 22:41:35,503 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:41:35,503 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 1e-05
2023-08-17 22:41:35,503 - INFO - Setting up training args and starting training...
2023-08-17 22:43:05,043 - INFO - Training complete...
2023-08-17 22:43:05,044 - INFO - TrainOutput(global_step=1080, training_loss=0.3089002185397678, metrics={'train_runtime': 88.4188, 'train_samples_per_second': 97.536, 'train_steps_per_second': 12.215, 'total_flos': 221588841936000.0, 'train_loss': 0.3089002185397678, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:43:05,045 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:43:05,678 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:43:05,678 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	5	0	1e-05	0.39639151096343994	0.8400556328233658	0.8037735849056604	0.7717391304347826	0.7874306839186691	0.8271788202963981	0.6596608629322447	1.2108	593.818	74.33	7.500000000000001e-06	1.0	270
bert-base-uncased	5	0	1e-05	0.38680499792099	0.8623087621696801	0.7959866220735786	0.8623188405797102	0.8278260869565217	0.8623106618248438	0.7150020299221267	1.2046	596.855	74.711	5e-06	2.0	540
bert-base-uncased	5	0	1e-05	0.46245861053466797	0.8636995827538247	0.8201438848920863	0.8260869565217391	0.8231046931407943	0.8566100696829915	0.7122595966069561	1.2062	596.078	74.613	2.5e-06	3.0	810
bert-base-uncased	5	0	1e-05	0.4903813898563385	0.866481223922114	0.8214285714285714	0.8333333333333334	0.827338129496403	0.8602332580887886	0.7185532037071324	1.2126	592.962	74.223	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	5	0	1e-05	88.4188	97.536	12.215	221588841936000.0	0.3089002185397678	0.0	4.0	1080

2023-08-17 22:43:05,678 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:43:05,678 - INFO - **TRACE** Appending...0.39639151096343994
2023-08-17 22:43:05,678 - INFO - **TRACE** Appending...0.38680499792099
2023-08-17 22:43:05,678 - INFO - **TRACE** Appending...0.46245861053466797
2023-08-17 22:43:05,678 - INFO - **TRACE** Appending...0.4903813898563385
2023-08-17 22:43:05,678 - INFO - **TRACE** Current innr cross fold(0) has lower loss, saving model...0.38680499792099 < 1000 LR: 1e-05
2023-08-17 22:43:06,292 - INFO - **TRACE** End of inner cv fold 0*----*-----*

2023-08-17 22:43:06,292 - INFO - -----------------------------------
2023-08-17 22:43:06,292 - INFO - -----------------------------------
2023-08-17 22:43:06,292 - INFO - **TRACE** Inner Fold: 1 for outer fold: 5
2023-08-17 22:43:06,292 - INFO - **TRACE** Learning rate used: 5e-06
2023-08-17 22:43:06,292 - INFO - **TRACE** Create dataset...
2023-08-17 22:43:06,293 - INFO - Dataset sizes: Train - 2156 Dev - 719
2023-08-17 22:43:06,297 - INFO - **TRACE** Tokenise data...
2023-08-17 22:43:07,086 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:43:07,087 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-06
2023-08-17 22:43:07,087 - INFO - Setting up training args and starting training...
2023-08-17 22:44:35,351 - INFO - Training complete...
2023-08-17 22:44:35,351 - INFO - TrainOutput(global_step=1080, training_loss=0.36061116147924355, metrics={'train_runtime': 87.236, 'train_samples_per_second': 98.858, 'train_steps_per_second': 12.38, 'total_flos': 221588841936000.0, 'train_loss': 0.36061116147924355, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:44:35,351 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:44:36,054 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:44:36,055 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	5	1	5e-06	0.43209221959114075	0.8219749652294854	0.8053435114503816	0.7326388888888888	0.7672727272727271	0.8071547112657902	0.6254798308185149	1.2433	578.289	72.387	3.7500000000000005e-06	1.0	270
bert-base-uncased	5	1	5e-06	0.3613773584365845	0.8484005563282336	0.8162544169611308	0.8020833333333334	0.809106830122592	0.8407168406805878	0.6834740221019248	1.2255	586.716	73.442	2.5e-06	2.0	540
bert-base-uncased	5	1	5e-06	0.38973578810691833	0.8525730180806675	0.8345588235294118	0.7881944444444444	0.8107142857142856	0.8418930458881154	0.6909027612294629	1.223	587.905	73.59	1.25e-06	3.0	810
bert-base-uncased	5	1	5e-06	0.4127299189567566	0.8553546592489569	0.851145038167939	0.7743055555555556	0.8109090909090909	0.8419091582882187	0.6962526526130953	1.2296	584.731	73.193	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	5	1	5e-06	87.236	98.858	12.38	221588841936000.0	0.36061116147924355	0.0	4.0	1080

2023-08-17 22:44:36,055 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:44:36,055 - INFO - **TRACE** Appending...0.43209221959114075
2023-08-17 22:44:36,055 - INFO - **TRACE** Appending...0.3613773584365845
2023-08-17 22:44:36,055 - INFO - **TRACE** Appending...0.38973578810691833
2023-08-17 22:44:36,055 - INFO - **TRACE** Appending...0.4127299189567566
2023-08-17 22:44:36,055 - INFO - **TRACE** Current innr cross fold(1) has lower loss, saving model...0.3613773584365845 < 0.38680499792099 LR: 5e-06
2023-08-17 22:44:36,704 - INFO - **TRACE** End of inner cv fold 1*----*-----*

2023-08-17 22:44:36,705 - INFO - -----------------------------------
2023-08-17 22:44:36,705 - INFO - -----------------------------------
2023-08-17 22:44:36,705 - INFO - **TRACE** Inner Fold: 2 for outer fold: 5
2023-08-17 22:44:36,705 - INFO - **TRACE** Learning rate used: 5e-05
2023-08-17 22:44:36,705 - INFO - **TRACE** Create dataset...
2023-08-17 22:44:36,705 - INFO - Dataset sizes: Train - 2156 Dev - 719
2023-08-17 22:44:36,710 - INFO - **TRACE** Tokenise data...
2023-08-17 22:44:37,315 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:44:37,315 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 5e-05
2023-08-17 22:44:37,315 - INFO - Setting up training args and starting training...
2023-08-17 22:46:05,812 - INFO - Training complete...
2023-08-17 22:46:05,814 - INFO - TrainOutput(global_step=1080, training_loss=0.2373019946946038, metrics={'train_runtime': 87.46, 'train_samples_per_second': 98.605, 'train_steps_per_second': 12.349, 'total_flos': 221588841936000.0, 'train_loss': 0.2373019946946038, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:46:05,814 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:46:06,434 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:46:06,435 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	5	2	5e-05	0.3209119439125061	0.8636995827538247	0.8278688524590164	0.7829457364341085	0.804780876494024	0.8459197228808286	0.7008481280944728	1.2247	587.065	73.485	3.7500000000000003e-05	1.0	270
bert-base-uncased	5	2	5e-05	0.3973817229270935	0.874826147426982	0.795774647887324	0.875968992248062	0.8339483394833949	0.8750777716121005	0.7360508862957018	1.2202	589.228	73.756	2.5e-05	2.0	540
bert-base-uncased	5	2	5e-05	0.5407053828239441	0.8776077885952712	0.8346456692913385	0.8217054263565892	0.8281249999999999	0.865299567842069	0.7331555643155309	1.3082	549.608	68.797	1.25e-05	3.0	810
bert-base-uncased	5	2	5e-05	0.6565994620323181	0.874826147426982	0.8206106870229007	0.8333333333333334	0.8269230769230769	0.8656905278380334	0.7289458654115757	1.2344	582.456	72.908	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	5	2	5e-05	87.46	98.605	12.349	221588841936000.0	0.2373019946946038	0.0	4.0	1080

2023-08-17 22:46:06,435 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:46:06,435 - INFO - **TRACE** Appending...0.3209119439125061
2023-08-17 22:46:06,435 - INFO - **TRACE** Appending...0.3973817229270935
2023-08-17 22:46:06,435 - INFO - **TRACE** Appending...0.5407053828239441
2023-08-17 22:46:06,435 - INFO - **TRACE** Appending...0.6565994620323181
2023-08-17 22:46:06,435 - INFO - **TRACE** Current innr cross fold(2) has lower loss, saving model...0.3209119439125061 < 0.3613773584365845 LR: 5e-05
2023-08-17 22:46:07,038 - INFO - **TRACE** End of inner cv fold 2*----*-----*

2023-08-17 22:46:07,038 - INFO - -----------------------------------
2023-08-17 22:46:07,038 - INFO - -----------------------------------
2023-08-17 22:46:07,038 - INFO - **TRACE** Inner Fold: 3 for outer fold: 5
2023-08-17 22:46:07,038 - INFO - **TRACE** Learning rate used: 3e-05
2023-08-17 22:46:07,038 - INFO - **TRACE** Create dataset...
2023-08-17 22:46:07,039 - INFO - Dataset sizes: Train - 2157 Dev - 718
2023-08-17 22:46:07,046 - INFO - **TRACE** Tokenise data...
2023-08-17 22:46:07,690 - INFO - **TRACE** Finetune and perform evaluation...
2023-08-17 22:46:07,691 - INFO - Function finetune_and_evaluate() received model: bert-base-uncased, lr: 3e-05
2023-08-17 22:46:07,691 - INFO - Setting up training args and starting training...
2023-08-17 22:47:36,542 - INFO - Training complete...
2023-08-17 22:47:36,544 - INFO - TrainOutput(global_step=1080, training_loss=0.20607360347553536, metrics={'train_runtime': 87.8044, 'train_samples_per_second': 98.264, 'train_steps_per_second': 12.3, 'total_flos': 221691619692000.0, 'train_loss': 0.20607360347553536, 'lr_from_scheduler': 0.0, 'epoch': 4.0})
2023-08-17 22:47:36,544 - INFO - Saving model at /notebooks/complaints/outputs/ft_bert-base-uncased
2023-08-17 22:47:37,237 - INFO - **TRACE** Report evaluation results...
2023-08-17 22:47:37,238 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Eval metrics *****
model	outer_cv	inner_cv	hp_set_lr	eval_loss	eval_accuracy	eval_precision	eval_recall	eval_f1	eval_roc_auc	eval_matthews_correlation	eval_runtime	eval_samples_per_second	eval_steps_per_second	lr_from_scheduler	epoch	step
bert-base-uncased	5	3	3e-05	0.4434391260147095	0.862116991643454	0.8351648351648352	0.8085106382978723	0.8216216216216216	0.8526498145617802	0.7095452960959531	1.2231	587.044	73.585	2.25e-05	1.0	270
bert-base-uncased	5	3	3e-05	0.4723814129829407	0.8704735376044568	0.8411552346570397	0.8262411347517731	0.8336314847942755	0.8626618517795562	0.7276800859250576	1.2288	584.313	73.243	1.5e-05	2.0	540
bert-base-uncased	5	3	3e-05	0.6157775521278381	0.871866295264624	0.8442028985507246	0.8262411347517731	0.8351254480286738	0.863808640770382	0.7304746154548123	1.2089	593.935	74.449	7.5e-06	3.0	810
bert-base-uncased	5	3	3e-05	0.704271674156189	0.8690807799442897	0.8333333333333334	0.8333333333333334	0.8333333333333334	0.8627675840978594	0.7255351681957186	1.2144	591.221	74.109	0.0	4.0	1080
--*--*--
***** Train metrics *****
model	outer_cv	inner_cv	hp_set_lrtrain_runtime	train_samples_per_second	train_steps_per_second	total_flos	train_loss	lr_from_scheduler	epoch	step
bert-base-uncased	5	3	3e-05	87.8044	98.264	12.3	221691619692000.0	0.20607360347553536	0.0	4.0	1080

2023-08-17 22:47:37,238 - INFO - **TRACE** Collecting validation losses from each epoch to check intermediate best model
2023-08-17 22:47:37,238 - INFO - **TRACE** Appending...0.4434391260147095
2023-08-17 22:47:37,238 - INFO - **TRACE** Appending...0.4723814129829407
2023-08-17 22:47:37,238 - INFO - **TRACE** Appending...0.6157775521278381
2023-08-17 22:47:37,238 - INFO - **TRACE** Appending...0.704271674156189
2023-08-17 22:47:37,238 - INFO - **TRACE** Model not saved since current innr cross fold(3) has higher loss...0.4434391260147095 >= 0.3209119439125061 LR: 3e-05
2023-08-17 22:47:37,238 - INFO - **TRACE** End of inner cv fold 3*----*-----*

2023-08-17 22:47:37,238 - INFO - -----------------------------------
2023-08-17 22:47:37,238 - INFO - -----------------------------------
2023-08-17 22:47:37,238 - INFO - **TRACE** All inner CVs complete for outer CV 5
2023-08-17 22:47:37,238 - INFO - **TRACE** Best model selected from inner cv: 2 with loss: 0.3209119439125061 with learning rate: 3e-05
2023-08-17 22:47:37,238 - INFO - **TRACE** Moving on to test predictions with the best model from inner cross fold
2023-08-17 22:47:37,238 - INFO - **TRACE** Loading the best model from inner CV
2023-08-17 22:47:38,041 - INFO - **TRACE** Running predictions with test data
2023-08-17 22:47:39,282 - INFO - Metrics from the Predictions...
2023-08-17 22:47:39,282 - INFO - {'test_loss': 0.2505322992801666, 'test_accuracy': 0.921602787456446, 'test_precision': 0.8883495145631068, 'test_recall': 0.8926829268292683, 'test_f1': 0.8905109489051094, 'test_roc_auc': 0.9151761517615176, 'test_matthews_correlation': 0.8294591243153546, 'test_runtime': 0.985, 'test_samples_per_second': 582.741, 'test_steps_per_second': 73.096}
2023-08-17 22:47:39,282 - INFO - {'confusion_matrix': array([[346,  23],
       [ 22, 183]])}
2023-08-17 22:47:39,283 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Test(predict) metrics *****
model	outer_cv	test_loss	test_accuracy	test_precision	test_recall	test_f1	test_roc_auc	test_matthews_correlation	test_runtime	test_samples_per_second	test_steps_per_second
bert-base-uncased	5	0.2505322992801666	0.921602787456446	0.8883495145631068	0.8926829268292683	0.8905109489051094	0.9151761517615176	0.8294591243153546	0.985	582.741	73.096
***** Confusion Matrix(predict) *****
model	outer_cv	confusion_matrix
bert-base-uncased	5	[[346  23]
 [ 22 183]]

2023-08-17 22:47:39,283 - INFO - ----------------------------------------------------------------------
2023-08-17 22:47:39,283 - INFO - ----------------------------------------------------------------------
2023-08-17 22:47:39,283 - INFO - **TRACE** All CVs complete, calculating mean of test metrics
2023-08-17 22:47:39,283 - INFO - 

Results as of 202308-17_22-1048 for bert-base-uncased
***** Mean Test(predict) metrics *****
model	mean_test_loss	mean_test_accuracy	mean_test_precision	mean_test_recall	mean_test_f1	mean_test_roc_auc	mean_test_matthews_correlation	mean_test_runtime	mean_test_samples_per_second	mean_test_steps_per_second
bert-base-uncased	0.25254381199677783	0.9051946674746251	0.8781940015242684	0.8538874417870392	0.865006255763014	0.8937873938347537	0.793105684294911	0.9982500000000001	576.4856666666667	72.20716666666667
***** Mean Confusion Matrix(predict) *****
model	mean_true_negative	mean_false_positive	mean_false_negative	mean_true_positive
bert-base-uncased	345.0	24.5	30.0	175.33333333333334

2023-08-17 22:47:39,283 - INFO - Attempting to delete checkpoints from /notebooks/train_trainer
2023-08-17 22:47:39,397 - INFO - Completed deleting checkpoints from /notebooks/train_trainer
2023-08-17 22:47:39,397 - INFO - Attempting to delete checkpoints from /notebooks/test_trainer
2023-08-17 22:47:39,397 - INFO - The path /notebooks/test_trainer does not exist.
